/*! verb 2015-11-23 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.verb=a()}}(function(){var a={};if("object"!=typeof c&&"function"==typeof require&&(Worker=require("webworker-threads").Worker),"object"!=typeof c){var b=this,c=b;if("function"==typeof importScripts){var d=function(a,c){var d=b;return a.split(".").forEach(function(a){d&&(d=d[a])}),d?d[c]:null};onmessage=function(a){if(a.data.className&&a.data.methodName){var b=d(a.data.className,a.data.methodName);return b?void postMessage({result:b.apply(null,a.data.args),id:a.data.id}):console.error("could not find "+a.data.className+"."+a.data.methodName)}}}}return function(a,b,c){"use strict";function d(a,b){function c(){}c.prototype=a;var d=new c;for(var e in b)d[e]=b[e];return b.toString!==Object.prototype.toString&&(d.toString=b.toString),d}function e(a){return a instanceof Array?function(){return i.iter(a)}:"function"==typeof a.iterator?f(a,a.iterator):a.iterator}function f(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=mb++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}b.geom=b.geom||{},b.exe=b.exe||{},b.eval=b.eval||{},b.core=b.core||{},b.promhx=b.promhx||{};var g={},h=function(){return E.__string_rec(this,"")},i=function(){};g.HxOverrides=i,i.__name__=["HxOverrides"],i.strDate=function(a){var b=a.length;switch(b){case 8:var c=a.split(":"),d=new Date;return d.setTime(0),d.setUTCHours(c[0]),d.setUTCMinutes(c[1]),d.setUTCSeconds(c[2]),d;case 10:var e=a.split("-");return new Date(e[0],e[1]-1,e[2],0,0,0);case 19:var f=a.split(" "),g=f[0].split("-"),h=f[1].split(":");return new Date(g[0],g[1]-1,g[2],h[0],h[1],h[2]);default:throw new D("Invalid date format : "+a)}},i.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c},i.substr=function(a,b,c){return null!=b&&0!=b&&null!=c&&0>c?"":(null==c&&(c=a.length),0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b),a.substr(b,c))},i.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var j=function(){};g.Lambda=j,j.__name__=["Lambda"],j.fold=function(a,b,c){for(var d=e(a)();d.hasNext();){var f=d.next();c=b(f,c)}return c};var k=function(){this.length=0};g.List=k,k.__name__=["List"],k.prototype={add:function(a){var b=[a];null==this.h?this.h=b:this.q[1]=b,this.q=b,this.length++},pop:function(){if(null==this.h)return null;var a=this.h[0];return this.h=this.h[1],null==this.h&&(this.q=null),this.length--,a},isEmpty:function(){return null==this.h},__class__:k},Math.__name__=["Math"];var l=function(){};g.Reflect=l,l.__name__=["Reflect"],l.field=function(a,b){try{return a[b]}catch(c){return c instanceof D&&(c=c.val),null}},l.callMethod=function(a,b,c){return b.apply(a,c)},l.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty;for(var d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b},l.isFunction=function(a){return"function"==typeof a&&!(a.__name__||a.__ename__)},l.deleteField=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)?(delete a[b],!0):!1};var m=function(){};g.Std=m,m.__name__=["Std"],m.string=function(a){return E.__string_rec(a,"")},m.parseFloat=function(a){return parseFloat(a)};var n=function(){this.b=""};g.StringBuf=n,n.__name__=["StringBuf"],n.prototype={add:function(a){this.b+=m.string(a)},__class__:n};var o=function(){};g.StringTools=o,o.__name__=["StringTools"],o.fastCodeAt=function(a,b){return a.charCodeAt(b)};var p=g.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};p.TNull=["TNull",0],p.TNull.toString=h,p.TNull.__enum__=p,p.TInt=["TInt",1],p.TInt.toString=h,p.TInt.__enum__=p,p.TFloat=["TFloat",2],p.TFloat.toString=h,p.TFloat.__enum__=p,p.TBool=["TBool",3],p.TBool.toString=h,p.TBool.__enum__=p,p.TObject=["TObject",4],p.TObject.toString=h,p.TObject.__enum__=p,p.TFunction=["TFunction",5],p.TFunction.toString=h,p.TFunction.__enum__=p,p.TClass=function(a){var b=["TClass",6,a];return b.__enum__=p,b.toString=h,b},p.TEnum=function(a){var b=["TEnum",7,a];return b.__enum__=p,b.toString=h,b},p.TUnknown=["TUnknown",8],p.TUnknown.toString=h,p.TUnknown.__enum__=p;var q=function(){};g.Type=q,q.__name__=["Type"],q.getClassName=function(a){var b=a.__name__;return null==b?null:b.join(".")},q.getEnumName=function(a){var b=a.__ename__;return b.join(".")},q.resolveClass=function(a){var b=g[a];return null!=b&&b.__name__?b:null},q.resolveEnum=function(a){var b=g[a];return null!=b&&b.__ename__?b:null},q.createEmptyInstance=function(a){function b(){}return b.prototype=a.prototype,new b},q.createEnum=function(a,b,c){var d=l.field(a,b);if(null==d)throw new D("No such constructor "+b);if(l.isFunction(d)){if(null==c)throw new D("Constructor "+b+" need parameters");return l.callMethod(a,d,c)}if(null!=c&&0!=c.length)throw new D("Constructor "+b+" does not need parameters");return d},q.getEnumConstructs=function(a){var b=a.__constructs__;return b.slice()},q["typeof"]=function(a){var b=typeof a;switch(b){case"boolean":return p.TBool;case"string":return p.TClass(String);case"number":return Math.ceil(a)==a%2147483648?p.TInt:p.TFloat;case"object":if(null==a)return p.TNull;var c=a.__enum__;if(null!=c)return p.TEnum(c);var d=E.getClass(a);return null!=d?p.TClass(d):p.TObject;case"function":return a.__name__||a.__ename__?p.TObject:p.TFunction;case"undefined":return p.TNull;default:return p.TUnknown}};var r=function(){};g["haxe.IMap"]=r,r.__name__=["haxe","IMap"];var s=function(a,b){this.high=a,this.low=b};g["haxe._Int64.___Int64"]=s,s.__name__=["haxe","_Int64","___Int64"],s.prototype={__class__:s};var t=function(){};g["haxe.Log"]=t,t.__name__=["haxe","Log"],t.trace=function(a,b){E.__trace(a,b)};var u=function(){this.buf=new n,this.cache=[],this.useCache=u.USE_CACHE,this.useEnumIndex=u.USE_ENUM_INDEX,this.shash=new z,this.scount=0};g["haxe.Serializer"]=u,u.__name__=["haxe","Serializer"],u.prototype={toString:function(){return this.buf.b},serializeString:function(a){var b=this.shash.get(a);return null!=b?(this.buf.b+="R",void(null==b?this.buf.b+="null":this.buf.b+=""+b)):(this.shash.set(a,this.scount++),this.buf.b+="y",a=encodeURIComponent(a),null==a.length?this.buf.b+="null":this.buf.b+=""+a.length,this.buf.b+=":",void(null==a?this.buf.b+="null":this.buf.b+=""+a))},serializeRef:function(a){for(var b=typeof a,c=0,d=this.cache.length;d>c;){var e=c++,f=this.cache[e];if(typeof f==b&&f==a)return this.buf.b+="r",null==e?this.buf.b+="null":this.buf.b+=""+e,!0}return this.cache.push(a),!1},serializeFields:function(a){for(var b=0,c=l.fields(a);b<c.length;){var d=c[b];++b,this.serializeString(d),this.serialize(l.field(a,d))}this.buf.b+="g"},serialize:function(a){var b=q["typeof"](a);switch(b[1]){case 0:this.buf.b+="n";break;case 1:var c=a;if(0==c)return void(this.buf.b+="z");this.buf.b+="i",null==c?this.buf.b+="null":this.buf.b+=""+c;break;case 2:var d=a;isNaN(d)?this.buf.b+="k":isFinite(d)?(this.buf.b+="d",null==d?this.buf.b+="null":this.buf.b+=""+d):0>d?this.buf.b+="m":this.buf.b+="p";break;case 3:a?this.buf.b+="t":this.buf.b+="f";break;case 6:var e=b[2];if(e==String)return void this.serializeString(a);if(this.useCache&&this.serializeRef(a))return;switch(e){case Array:var f=0;this.buf.b+="a";for(var g=a.length,h=0;g>h;){var i=h++;null==a[i]?f++:(f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f),f=0),this.serialize(a[i]))}f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f)),this.buf.b+="h";break;case k:this.buf.b+="l";for(var j=a,o=j.h,p=null;null!=o;){var r;p=o[0],o=o[1],r=p,this.serialize(r)}this.buf.b+="h";break;case Date:var s=a;this.buf.b+="v",this.buf.add(s.getTime());break;case z:this.buf.b+="b";for(var t=a,v=t.keys();v.hasNext();){var y=v.next();this.serializeString(y),this.serialize(null!=tb[y]?t.getReserved(y):t.h[y])}this.buf.b+="h";break;case w:this.buf.b+="q";for(var B=a,C=B.keys();C.hasNext();){var F=C.next();this.buf.b+=":",null==F?this.buf.b+="null":this.buf.b+=""+F,this.serialize(B.h[F])}this.buf.b+="h";break;case x:this.buf.b+="M";for(var G=a,H=G.keys();H.hasNext();){var I=H.next(),J=l.field(I,"__id__");l.deleteField(I,"__id__"),this.serialize(I),I.__id__=J,this.serialize(G.h[I.__id__])}this.buf.b+="h";break;case A:for(var K=a,L=0,M=K.length-2,N=new n,O=u.BASE64;M>L;){var P=K.get(L++),Q=K.get(L++),R=K.get(L++);N.add(O.charAt(P>>2)),N.add(O.charAt(63&(P<<4|Q>>4))),N.add(O.charAt(63&(Q<<2|R>>6))),N.add(O.charAt(63&R))}if(L==M){var S=K.get(L++),T=K.get(L++);N.add(O.charAt(S>>2)),N.add(O.charAt(63&(S<<4|T>>4))),N.add(O.charAt(T<<2&63))}else if(L==M+1){var U=K.get(L++);N.add(O.charAt(U>>2)),N.add(O.charAt(U<<4&63))}var V=N.b;this.buf.b+="s",null==V.length?this.buf.b+="null":this.buf.b+=""+V.length,this.buf.b+=":",null==V?this.buf.b+="null":this.buf.b+=""+V;break;default:this.useCache&&this.cache.pop(),null!=a.hxSerialize?(this.buf.b+="C",this.serializeString(q.getClassName(e)),this.useCache&&this.cache.push(a),a.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(q.getClassName(e)),this.useCache&&this.cache.push(a),this.serializeFields(a))}break;case 4:if(E.__instanceof(a,rb)){var W=q.getClassName(a);this.buf.b+="A",this.serializeString(W)}else if(E.__instanceof(a,sb))this.buf.b+="B",this.serializeString(q.getEnumName(a));else{if(this.useCache&&this.serializeRef(a))return;this.buf.b+="o",this.serializeFields(a)}break;case 7:var X=b[2];if(this.useCache){if(this.serializeRef(a))return;this.cache.pop()}this.useEnumIndex?this.buf.b+="j":this.buf.b+="w",this.serializeString(q.getEnumName(X)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=m.string(a[1])):this.serializeString(a[0]),this.buf.b+=":";var Y=a.length;this.buf.b+=m.string(Y-2);for(var Z=2;Y>Z;){var $=Z++;this.serialize(a[$])}this.useCache&&this.cache.push(a);break;case 5:throw new D("Cannot serialize function");default:throw new D("Cannot serialize "+m.string(a))}},__class__:u};var v=function(a){this.buf=a,this.length=a.length,this.pos=0,this.scache=[],this.cache=[];var b=v.DEFAULT_RESOLVER;null==b&&(b=q,v.DEFAULT_RESOLVER=b),this.setResolver(b)};g["haxe.Unserializer"]=v,v.__name__=["haxe","Unserializer"],v.initCodes=function(){for(var a=[],b=0,c=v.BASE64.length;c>b;){var d=b++;a[v.BASE64.charCodeAt(d)]=d}return a},v.prototype={setResolver:function(a){null==a?this.resolver={resolveClass:function(a){return null},resolveEnum:function(a){return null}}:this.resolver=a},get:function(a){return this.buf.charCodeAt(a)},readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45!=d){if(48>d||d>57)break;a=10*a+(d-48),this.pos++}else{if(this.pos!=c)break;b=!0,this.pos++}}return b&&(a*=-1),a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(!(b>=43&&58>b||101==b||69==b))break;this.pos++}return m.parseFloat(i.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw new D("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw new D("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.get(this.pos++))throw new D("Invalid enum format");var c=this.readDigits();if(0==c)return q.createEnum(a,b);for(var d=[];c-->0;)d.push(this.unserialize());return q.createEnum(a,b,d)},unserialize:function(){var a=this.get(this.pos++);switch(a){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();case 100:return this.readFloat();case 121:var b=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<b)throw new D("Invalid string length");var c=i.substr(this.buf,this.pos,b);return this.pos+=b,c=decodeURIComponent(c.split("+").join(" ")),this.scache.push(c),c;case 107:return NaN;case 109:return-(1/0);case 112:return 1/0;case 97:var d=(this.buf,[]);for(this.cache.push(d);;){var e=this.buf.charCodeAt(this.pos);if(104==e){this.pos++;break}if(117==e){this.pos++;var f=this.readDigits();d[d.length+f-1]=null}else d.push(this.unserialize())}return d;case 111:var g={};return this.cache.push(g),this.unserializeObject(g),g;case 114:var h=this.readDigits();if(0>h||h>=this.cache.length)throw new D("Invalid reference");return this.cache[h];case 82:var j=this.readDigits();if(0>j||j>=this.scache.length)throw new D("Invalid string reference");return this.scache[j];case 120:throw new D(this.unserialize());case 99:var l=this.unserialize(),m=this.resolver.resolveClass(l);if(null==m)throw new D("Class not found "+l);var n=q.createEmptyInstance(m);return this.cache.push(n),this.unserializeObject(n),n;case 119:var p=this.unserialize(),r=this.resolver.resolveEnum(p);if(null==r)throw new D("Enum not found "+p);var s=this.unserializeEnum(r,this.unserialize());return this.cache.push(s),s;case 106:var t=this.unserialize(),u=this.resolver.resolveEnum(t);if(null==u)throw new D("Enum not found "+t);this.pos++;var y=this.readDigits(),B=q.getEnumConstructs(u)[y];if(null==B)throw new D("Unknown enum index "+t+"@"+y);var C=this.unserializeEnum(u,B);return this.cache.push(C),C;case 108:var E=new k;this.cache.push(E);for(this.buf;104!=this.buf.charCodeAt(this.pos);)E.add(this.unserialize());return this.pos++,E;case 98:var F=new z;this.cache.push(F);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var G=this.unserialize();F.set(G,this.unserialize())}return this.pos++,F;case 113:var H=new w;this.cache.push(H);for(var I=(this.buf,this.get(this.pos++));58==I;){var J=this.readDigits();H.set(J,this.unserialize()),I=this.get(this.pos++)}if(104!=I)throw new D("Invalid IntMap format");return H;case 77:var K=new x;this.cache.push(K);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var L=this.unserialize();K.set(L,this.unserialize())}return this.pos++,K;case 118:var M;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)){var N=i.substr(this.buf,this.pos,19);M=i.strDate(N),this.pos+=19}else{var O=this.readFloat(),P=new Date;P.setTime(O),M=P}return this.cache.push(M),M;case 115:var Q=this.readDigits(),R=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<Q)throw new D("Invalid bytes length");var S=v.CODES;null==S&&(S=v.initCodes(),v.CODES=S);var T,U=this.pos,V=3&Q;T=3*(Q>>2)+(V>=2?V-1:0);for(var W=U+(Q-V),X=A.alloc(T),Y=0;W>U;){var Z=S[o.fastCodeAt(R,U++)],$=S[o.fastCodeAt(R,U++)];X.set(Y++,Z<<2|$>>4);var _=S[o.fastCodeAt(R,U++)];X.set(Y++,$<<4|_>>2);var aa=S[o.fastCodeAt(R,U++)];X.set(Y++,_<<6|aa)}if(V>=2){var ba=S[o.fastCodeAt(R,U++)],ca=S[o.fastCodeAt(R,U++)];if(X.set(Y++,ba<<2|ca>>4),3==V){var da=S[o.fastCodeAt(R,U++)];X.set(Y++,ca<<4|da>>2)}}return this.pos+=Q,this.cache.push(X),X;case 67:var ea=this.unserialize(),fa=this.resolver.resolveClass(ea);if(null==fa)throw new D("Class not found "+ea);var ga=q.createEmptyInstance(fa);if(this.cache.push(ga),ga.hxUnserialize(this),103!=this.get(this.pos++))throw new D("Invalid custom data");return ga;case 65:var ha=this.unserialize(),ia=this.resolver.resolveClass(ha);if(null==ia)throw new D("Class not found "+ha);return ia;case 66:var ja=this.unserialize(),ka=this.resolver.resolveEnum(ja);if(null==ka)throw new D("Enum not found "+ja);return ka}throw this.pos--,new D("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:v};var w=function(){this.h={}};g["haxe.ds.IntMap"]=w,w.__name__=["haxe","ds","IntMap"],w.__interfaces__=[r],w.prototype={set:function(a,b){this.h[a]=b},remove:function(a){return this.h.hasOwnProperty(a)?(delete this.h[a],!0):!1},keys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(0|b);return i.iter(a)},__class__:w};var x=function(){this.h={},this.h.__keys__={}};g["haxe.ds.ObjectMap"]=x,x.__name__=["haxe","ds","ObjectMap"],x.__interfaces__=[r],x.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++x.count);this.h[c]=b,this.h.__keys__[c]=a},keys:function(){var a=[];for(var b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return i.iter(a)},__class__:x};var y=g["haxe.ds.Option"]={__ename__:["haxe","ds","Option"],__constructs__:["Some","None"]};y.Some=function(a){var b=["Some",0,a];return b.__enum__=y,b.toString=h,b},y.None=["None",1],y.None.toString=h,y.None.__enum__=y;var z=function(){this.h={}};g["haxe.ds.StringMap"]=z,z.__name__=["haxe","ds","StringMap"],z.__interfaces__=[r],z.prototype={set:function(a,b){null!=tb[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=tb[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={}),this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},keys:function(){var a=this.arrayKeys();return i.iter(a)},arrayKeys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(var b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},__class__:z};var A=function(a){this.length=a.byteLength,this.b=new vb(a),this.b.bufferValue=a,a.hxBytes=this,a.bytes=this.b};g["haxe.io.Bytes"]=A,A.__name__=["haxe","io","Bytes"],A.alloc=function(a){return new A(new ub(a))},A.prototype={get:function(a){return this.b[a]},set:function(a,b){this.b[a]=255&b},__class__:A};var B=g["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};B.Blocked=["Blocked",0],B.Blocked.toString=h,B.Blocked.__enum__=B,B.Overflow=["Overflow",1],B.Overflow.toString=h,B.Overflow.__enum__=B,B.OutsideBounds=["OutsideBounds",2],B.OutsideBounds.toString=h,B.OutsideBounds.__enum__=B,B.Custom=function(a){var b=["Custom",3,a];return b.__enum__=B,b.toString=h,b};var C=function(){};g["haxe.io.FPHelper"]=C,C.__name__=["haxe","io","FPHelper"],C.i32ToFloat=function(a){var b=1-(a>>>31<<1),c=a>>>23&255,d=8388607&a;return 0==d&&0==c?0:b*(1+Math.pow(2,-23)*d)*Math.pow(2,c-127)},C.floatToI32=function(a){if(0==a)return 0;var b;b=0>a?-a:a;var c=Math.floor(Math.log(b)/.6931471805599453);-127>c?c=-127:c>128&&(c=128);var d=8388607&Math.round(8388608*(b/Math.pow(2,c)-1));return(0>a?-2147483648:0)|c+127<<23|d},C.i64ToDouble=function(a,b){var c=1-(b>>>31<<1),d=(b>>20&2047)-1023,e=4294967296*(1048575&b)+2147483648*(a>>>31)+(2147483647&a);return 0==e&&-1023==d?0:c*(1+Math.pow(2,-52)*e)*Math.pow(2,d)},C.doubleToI64=function(a){var b=C.i64tmp;if(0==a)b.low=0,b.high=0;else{var c;c=0>a?-a:a;var d,e=Math.floor(Math.log(c)/.6931471805599453),f=4503599627370496*(c/Math.pow(2,e)-1);d=Math.round(f);var g=0|d,h=d/4294967296|0;b.low=g,b.high=(0>a?-2147483648:0)|e+1023<<20|h}return b};var D=function(a){Error.call(this),this.val=a,this.message=String(a),Error.captureStackTrace&&Error.captureStackTrace(this,D)};g["js._Boot.HaxeError"]=D,D.__name__=["js","_Boot","HaxeError"],D.__super__=Error,D.prototype=d(Error.prototype,{__class__:D});var E=function(){};g["js.Boot"]=E,E.__name__=["js","Boot"],E.__unhtml=function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},E.__trace=function(b,c){var d;if(d=null!=c?c.fileName+":"+c.lineNumber+": ":"",d+=E.__string_rec(b,""),null!=c&&null!=c.customParams)for(var e=0,f=c.customParams;e<f.length;){var g=f[e];++e,d+=","+E.__string_rec(g,"")}var h;"undefined"!=typeof document&&null!=(h=document.getElementById("haxe:trace"))?h.innerHTML+=E.__unhtml(d)+"<br/>":"undefined"!=typeof a&&null!=a.log&&a.log(d)},E.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;var c=E.__nativeClassName(a);return null!=c?E.__resolveNativeClass(c):null},E.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];var d=a[0]+"(";b+="	";for(var e=2,f=a.length;f>e;){var g=e++;d+=2!=g?","+E.__string_rec(a[g],b):E.__string_rec(a[g],b)}return d+")"}var h=a.length,i="[";b+="	";for(var j=0;h>j;){var k=j++;i+=(k>0?",":"")+E.__string_rec(a[k],b)}return i+="]"}var l;try{l=a.toString}catch(m){return m instanceof D&&(m=m.val),"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var n=a.toString();if("[object Object]"!=n)return n}var o=null,p="{\n";b+="	";var q=null!=a.hasOwnProperty;for(var o in a)(!q||a.hasOwnProperty(o))&&"prototype"!=o&&"__class__"!=o&&"__super__"!=o&&"__interfaces__"!=o&&"__properties__"!=o&&(2!=p.length&&(p+=", \n"),p+=b+o+" : "+E.__string_rec(a[o],b));return b=b.substring(1),p+="\n"+b+"}";case"function":return"<function>";case"string":return a;default:return String(a)}},E.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;e>d;){var f=d++,g=c[f];if(g==b||E.__interfLoop(g,b))return!0}return E.__interfLoop(a.__super__,b)},E.__instanceof=function(a,b){if(null==b)return!1;switch(b){case nb:return(0|a)===a;case pb:return"number"==typeof a;case qb:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case ob:return!0;default:if(null==a)return!1;if("function"==typeof b){if(a instanceof b)return!0;if(E.__interfLoop(E.getClass(a),b))return!0}else if("object"==typeof b&&E.__isNativeObj(b)&&a instanceof b)return!0;return b==rb&&null!=a.__name__?!0:b==sb&&null!=a.__ename__?!0:a.__enum__==b}},E.__nativeClassName=function(a){var b=E.__toStr.call(a).slice(8,-1);return"Object"==b||"Function"==b||"Math"==b||"JSON"==b?null:b},E.__isNativeObj=function(a){return null!=E.__nativeClassName(a)},E.__resolveNativeClass=function(a){return c[a]};var F=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{var b=a;this.a=[];for(var c=0;b>c;){var d=c++;this.a[d]=0}this.byteLength=b}};g["js.html.compat.ArrayBuffer"]=F,F.__name__=["js","html","compat","ArrayBuffer"],F.sliceImpl=function(a,b){var c=new vb(this,a,null==b?null:b-a),d=new ub(c.byteLength),e=new vb(d);return e.set(c),d},F.prototype={slice:function(a,b){return new F(this.a.slice(a,b))},__class__:F};var G=function(a,b,c){if(this.buf=a,null==b?this.offset=0:this.offset=b,null==c?this.length=a.byteLength-this.offset:this.length=c,this.offset<0||this.length<0||this.offset+this.length>a.byteLength)throw new D(B.OutsideBounds)};g["js.html.compat.DataView"]=G,G.__name__=["js","html","compat","DataView"],G.prototype={getInt8:function(a){var b=this.buf.a[this.offset+a];return b>=128?b-256:b},getUint8:function(a){return this.buf.a[this.offset+a]},getInt16:function(a,b){var c=this.getUint16(a,b);return c>=32768?c-65536:c},getUint16:function(a,b){return b?this.buf.a[this.offset+a]|this.buf.a[this.offset+a+1]<<8:this.buf.a[this.offset+a]<<8|this.buf.a[this.offset+a+1]},getInt32:function(a,b){var c=this.offset+a,d=this.buf.a[c++],e=this.buf.a[c++],f=this.buf.a[c++],g=this.buf.a[c++];return b?d|e<<8|f<<16|g<<24:g|f<<8|e<<16|d<<24},getUint32:function(a,b){var c=this.getInt32(a,b);return 0>c?c+4294967296:c},getFloat32:function(a,b){return C.i32ToFloat(this.getInt32(a,b))},getFloat64:function(a,b){var c=this.getInt32(a,b),d=this.getInt32(a+4,b);return C.i64ToDouble(b?c:d,b?d:c)},setInt8:function(a,b){0>b?this.buf.a[a+this.offset]=b+128&255:this.buf.a[a+this.offset]=255&b},setUint8:function(a,b){this.buf.a[a+this.offset]=255&b},setInt16:function(a,b,c){this.setUint16(a,0>b?b+65536:b,c)},setUint16:function(a,b,c){var d=a+this.offset;c?(this.buf.a[d]=255&b,this.buf.a[d++]=b>>8&255):(this.buf.a[d++]=b>>8&255,this.buf.a[d]=255&b)},setInt32:function(a,b,c){this.setUint32(a,b,c)},setUint32:function(a,b,c){var d=a+this.offset;c?(this.buf.a[d++]=255&b,this.buf.a[d++]=b>>8&255,this.buf.a[d++]=b>>16&255,this.buf.a[d++]=b>>>24):(this.buf.a[d++]=b>>>24,this.buf.a[d++]=b>>16&255,this.buf.a[d++]=b>>8&255,this.buf.a[d++]=255&b)},setFloat32:function(a,b,c){this.setUint32(a,C.floatToI32(b),c)},setFloat64:function(a,b,c){var d=C.doubleToI64(b);c?(this.setUint32(a,d.low),this.setUint32(a,d.high)):(this.setUint32(a,d.high),this.setUint32(a,d.low))},__class__:G};var H=function(){};g["js.html.compat.Uint8Array"]=H,H.__name__=["js","html","compat","Uint8Array"],H._new=function(a,b,c){var d;if("number"==typeof a){d=[];for(var e=0;a>e;){var f=e++;d[f]=0}d.byteLength=d.length,d.byteOffset=0,d.buffer=new F(d)}else if(E.__instanceof(a,F)){var g=a;null==b&&(b=0),null==c&&(c=g.byteLength-b),d=0==b?g.a:g.a.slice(b,b+c),d.byteLength=d.length,d.byteOffset=b,d.buffer=g}else{if(!(a instanceof Array&&null==a.__enum__))throw new D("TODO "+m.string(a));d=a.slice(),d.byteLength=d.length,d.byteOffset=0,d.buffer=new F(d)}return d.subarray=H._subarray,d.set=H._set,d},H._set=function(a,b){var c=this;if(E.__instanceof(a.buffer,F)){var d=a;if(a.byteLength+b>c.byteLength)throw new D("set() outside of range");for(var e=0,f=a.byteLength;f>e;){var g=e++;c[g+b]=d[g]}}else{if(!(a instanceof Array&&null==a.__enum__))throw new D("TODO");var h=a;if(h.length+b>c.byteLength)throw new D("set() outside of range");for(var i=0,j=h.length;j>i;){var k=i++;c[k+b]=h[k]}}},H._subarray=function(a,b){var c=this,d=H._new(c.slice(a,b));return d.byteOffset=a,d};var I=function(a){this._resolved=!1,this._pending=!1,this._errorPending=!1,this._fulfilled=!1,this._update=[],this._error=[],this._errored=!1,null!=a&&I.link(a,this,function(a){return a})};g["promhx.base.AsyncBase"]=I,I.__name__=["promhx","base","AsyncBase"],I.link=function(a,b,c){a._update.push({async:b,linkf:function(a){b.handleResolve(c(a))}}),I.immediateLinkUpdate(a,b,c)},I.immediateLinkUpdate=function(a,b,c){if(!a._errored||a._errorPending||a._error.length>0||b.handleError(a._errorVal),a._resolved&&!a._pending)try{b.handleResolve(c(a._val))}catch(d){d instanceof D&&(d=d.val),b.handleError(d)}},I.linkAll=function(a,b){for(var c=function(c,d,f){if(0==c.length||I.allFulfilled(c)){for(var g,h=[],i=e(a)();i.hasNext();){var j=i.next();h.push(j==d?f:j._val)}g=h,b.handleResolve(g)}},d=e(a)();d.hasNext();){var f=d.next();f._update.push({async:b,linkf:function(a,b,c){return function(d){a(b,c,d)}}(c,function(b){for(var c,d=[],g=e(a)();g.hasNext();){var h=g.next();h!=f&&d.push(h)}return c=d}(this),f)})}I.allFulfilled(a)&&b.handleResolve(function(b){for(var c,d=[],f=e(a)();f.hasNext();){var g=f.next();d.push(g._val)}return c=d}(this))},I.pipeLink=function(a,b,c){var d=!1,e=function(a){if(!d){d=!0;var e=c(a);e._update.push({async:b,linkf:f(b,b.handleResolve)}),I.immediateLinkUpdate(e,b,function(a){return a})}};if(a._update.push({async:b,linkf:e}),a._resolved&&!a._pending)try{e(a._val)}catch(g){g instanceof D&&(g=g.val),b.handleError(g)}},I.allResolved=function(a){for(var b=e(a)();b.hasNext();){var c=b.next();if(!c._resolved)return!1}return!0},I.allFulfilled=function(a){for(var b=e(a)();b.hasNext();){var c=b.next();if(!c._fulfilled)return!1}return!0},I.prototype={catchError:function(a){return this._error.push(a),this},errorThen:function(a){return this._errorMap=a,this},isResolved:function(){return this._resolved},isErrored:function(){return this._errored},isErrorHandled:function(){return this._error.length>0},isErrorPending:function(){return this._errorPending},isFulfilled:function(){return this._fulfilled},isPending:function(){return this._pending},handleResolve:function(a){this._resolve(a)},_resolve:function(a){var b=this;this._pending?N.enqueue(function(a,b){return function(){a(b)}}(f(this,this._resolve),a)):(this._resolved=!0,this._pending=!0,N.queue.add(function(){b._val=a;for(var c=0,d=b._update;c<d.length;){var e=d[c];++c;try{e.linkf(a)}catch(f){f instanceof D&&(f=f.val),e.async.handleError(f)}}b._fulfilled=!0,b._pending=!1}),N.continueOnNextLoop())},handleError:function(a){this._handleError(a)},_handleError:function(a){var b=this,c=function(a){if(b._error.length>0)for(var c=0,d=b._error;c<d.length;){var e=d[c];++c,e(a)}else{if(!(b._update.length>0))throw new D(a);for(var f=0,g=b._update;f<g.length;){var h=g[f];++f,h.async.handleError(a)}}b._errorPending=!1};this._errorPending||(this._errorPending=!0,this._errored=!0,this._errorVal=a,N.queue.add(function(){if(null!=b._errorMap)try{b._resolve(b._errorMap(a))}catch(d){d instanceof D&&(d=d.val),c(d)}else c(a)}),N.continueOnNextLoop())},then:function(a){var b=new I;return I.link(this,b,a),b},unlink:function(a){var b=this;N.queue.add(function(){b._update=b._update.filter(function(b){return b.async!=a})}),N.continueOnNextLoop()},isLinked:function(a){for(var b=!1,c=0,d=this._update;c<d.length;){var e=d[c];if(++c,e.async==a)return!0}return b},__class__:I};var J=b.promhx.Deferred=function(){I.call(this)};g["promhx.Deferred"]=J,J.__name__=["promhx","Deferred"],J.__super__=I,J.prototype=d(I.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},promise:function(){return new K(this)},stream:function(){return new L(this)},publicStream:function(){return new M(this)},__class__:J});var K=b.promhx.Promise=function(a){I.call(this,a),this._rejected=!1};g["promhx.Promise"]=K,K.__name__=["promhx","Promise"],K.whenAll=function(a){var b=new K;return I.linkAll(a,b),b},K.promise=function(a){var b=new K;return b.handleResolve(a),b},K.__super__=I,K.prototype=d(I.prototype,{isRejected:function(){return this._rejected},reject:function(a){this._rejected=!0,this.handleError(a)},handleResolve:function(a){if(this._resolved){var b="Promise has already been resolved";throw new D(O.AlreadyResolved(b))}this._resolve(a)},then:function(a){var b=new K;return I.link(this,b,a),b},unlink:function(a){var b=this;N.queue.add(function(){if(b._fulfilled)b._update=b._update.filter(function(b){return b.async!=a});else{var c="Downstream Promise is not fullfilled";b.handleError(O.DownstreamNotFullfilled(c))}}),N.continueOnNextLoop()},handleError:function(a){this._rejected=!0,this._handleError(a)},pipe:function(a){var b=new K;return I.pipeLink(this,b,a),b},errorPipe:function(a){var b=new K;return this.catchError(function(c){var d=a(c);d.then(f(b,b._resolve))}),this.then(f(b,b._resolve)),b},__class__:K});var L=b.promhx.Stream=function(a){I.call(this,a),this._end_deferred=new J,this._end_promise=this._end_deferred.promise()};g["promhx.Stream"]=L,L.__name__=["promhx","Stream"],L.foreach=function(a){for(var b=new L,c=e(a)();c.hasNext();){var d=c.next();b.handleResolve(d)}return b.end(),b},L.wheneverAll=function(a){var b=new L;return I.linkAll(a,b),b},L.concatAll=function(a){for(var b=new L,c=e(a)();c.hasNext();){var d=c.next();b.concat(d)}return b},L.mergeAll=function(a){for(var b=new L,c=e(a)();c.hasNext();){var d=c.next();b.merge(d)}return b},L.stream=function(a){var b=new L;return b.handleResolve(a),b},L.__super__=I,L.prototype=d(I.prototype,{then:function(a){var b=new L;return I.link(this,b,a),this._end_promise.then(function(a){b.end()}),b},detachStream:function(a){for(var b=[],c=!1,d=0,e=this._update;d<e.length;){var f=e[d];++d,f.async==a?c=!0:b.push(f)}return this._update=b,c},first:function(){var a=new K;return this.then(function(b){a._resolved||a.handleResolve(b)}),a},handleResolve:function(a){this._end||this._pause||this._resolve(a)},pause:function(a){null==a&&(a=!this._pause),this._pause=a},pipe:function(a){var b=new L;return I.pipeLink(this,b,a),this._end_promise.then(function(a){b.end()}),b},errorPipe:function(a){var b=new L;return this.catchError(function(c){var d=a(c);d.then(f(b,b._resolve)),d._end_promise.then((lb=b._end_promise,f(lb,lb._resolve)))}),this.then(f(b,b._resolve)),this._end_promise.then(function(a){b.end()}),b},handleEnd:function(){if(this._pending)N.queue.add(f(this,this.handleEnd)),N.continueOnNextLoop();else{
if(this._end_promise._resolved)return;this._end=!0;var a;a=this._resolved?y.Some(this._val):y.None,this._end_promise.handleResolve(a),this._update=[],this._error=[]}},end:function(){return N.queue.add(f(this,this.handleEnd)),N.continueOnNextLoop(),this},endThen:function(a){return this._end_promise.then(a)},filter:function(a){var b=new L;return this._update.push({async:b,linkf:function(c){a(c)&&b.handleResolve(c)}}),I.immediateLinkUpdate(this,b,function(a){return a}),b},concat:function(a){var b=new L;return this._update.push({async:b,linkf:f(b,b.handleResolve)}),I.immediateLinkUpdate(this,b,function(a){return a}),this._end_promise.then(function(c){a.pipe(function(a){return b.handleResolve(a),b}),a._end_promise.then(function(a){b.end()})}),b},merge:function(a){var b=new L;return this._update.push({async:b,linkf:f(b,b.handleResolve)}),a._update.push({async:b,linkf:f(b,b.handleResolve)}),I.immediateLinkUpdate(this,b,function(a){return a}),I.immediateLinkUpdate(a,b,function(a){return a}),b},__class__:L});var M=b.promhx.PublicStream=function(a){L.call(this,a)};g["promhx.PublicStream"]=M,M.__name__=["promhx","PublicStream"],M.publicstream=function(a){var b=new M;return b.handleResolve(a),b},M.__super__=L,M.prototype=d(L.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},update:function(a){this.handleResolve(a)},__class__:M});var N=function(){};g["promhx.base.EventLoop"]=N,N.__name__=["promhx","base","EventLoop"],N.enqueue=function(a){N.queue.add(a),N.continueOnNextLoop()},N.set_nextLoop=function(a){if(null!=N.nextLoop)throw new D("nextLoop has already been set");return N.nextLoop=a,N.nextLoop},N.queueEmpty=function(){return N.queue.isEmpty()},N.finish=function(a){null==a&&(a=1e3);for(var b=null;a-->0&&null!=(b=N.queue.pop());)b();return N.queue.isEmpty()},N.clear=function(){N.queue=new k},N.f=function(){var a=N.queue.pop();null!=a&&a(),N.queue.isEmpty()||N.continueOnNextLoop()},N.continueOnNextLoop=function(){null!=N.nextLoop?N.nextLoop(N.f):setImmediate(N.f)};var O=g["promhx.error.PromiseError"]={__ename__:["promhx","error","PromiseError"],__constructs__:["AlreadyResolved","DownstreamNotFullfilled"]};O.AlreadyResolved=function(a){var b=["AlreadyResolved",0,a];return b.__enum__=O,b.toString=h,b},O.DownstreamNotFullfilled=function(a){var b=["DownstreamNotFullfilled",1,a];return b.__enum__=O,b.toString=h,b};var P=function(){};g["verb.Verb"]=P,P.__name__=["verb","Verb"],P.main=function(){t.trace("verb 2.0.0",{fileName:"Verb.hx",lineNumber:45,className:"verb.Verb",methodName:"main"})};var Q=function(){};g["verb.core.ArrayExtensions"]=Q,Q.__name__=["verb","core","ArrayExtensions"],Q.alloc=function(a,b){if(!(0>b))for(;a.length<b;)a.push(null)},Q.reversed=function(a){var b=a.slice();return b.reverse(),b},Q.last=function(a){return a[a.length-1]},Q.first=function(a){return a[0]},Q.spliceAndInsert=function(a,b,c,d){a.splice(b,c),a.splice(b,0,d)},Q.left=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(0,b)},Q.right=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b)},Q.rightWithPivot=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b-1)},Q.unique=function(a,b){if(0==a.length)return[];for(var c=[a.pop()];a.length>0;){for(var d=a.pop(),e=!0,f=0;f<c.length;){var g=c[f];if(++f,b(d,g)){e=!1;break}}e&&c.push(d)}return c};var R=function(){};g["verb.core.Binomial"]=R,R.__name__=["verb","core","Binomial"],R.get=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;if(b>a-b&&(b=a-b),R.memo_exists(a,b))return R.get_memo(a,b);for(var c=1,d=a,e=1,f=b+1;f>e;){var g=e++;R.memo_exists(d,g)?(a--,c=R.get_memo(d,g)):(c*=a--,c/=g,R.memoize(d,g,c))}return c},R.get_no_memo=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;b>a-b&&(b=a-b);for(var c=1,d=1,e=b+1;e>d;){var f=d++;c*=a--,c/=f}return c},R.memo_exists=function(a,b){return R.memo.h.hasOwnProperty(a)&&R.memo.h[a].h.hasOwnProperty(b)},R.get_memo=function(a,b){return R.memo.h[a].h[b]},R.memoize=function(a,b,c){R.memo.h.hasOwnProperty(a)||R.memo.set(a,new w),R.memo.h[a].h[b]=c};var S=b.core.BoundingBox=function(a){this.max=null,this.min=null,this.dim=3,this.initialized=!1,null!=a&&this.addRange(a)};g["verb.core.BoundingBox"]=S,S.__name__=["verb","core","BoundingBox"],S.intervalsOverlap=function(a,b,c,d,e){null==e&&(e=-1);var f;f=-.5>e?T.TOLERANCE:e;var g=Math.min(a,b)-f,h=Math.max(a,b)+f,i=Math.min(c,d)-f,j=Math.max(c,d)+f;return g>=i&&j>=g||h>=i&&j>=h||i>=g&&h>=i||j>=g&&h>=j},S.prototype={fromPoint:function(a){return new S([a])},add:function(a){if(!this.initialized)return this.dim=a.length,this.min=a.slice(0),this.max=a.slice(0),this.initialized=!0,this;for(var b=0,c=this.dim;c>b;){var d=b++;a[d]>this.max[d]&&(this.max[d]=a[d]),a[d]<this.min[d]&&(this.min[d]=a[d])}return this},addRange:function(a){for(var b=a.length,c=0;b>c;){var d=c++;this.add(a[d])}return this},contains:function(a,b){return null==b&&(b=-1),this.initialized?this.intersects(new S([a]),b):!1},intersects:function(a,b){if(null==b&&(b=-1),!this.initialized||!a.initialized)return!1;for(var c=this.min,d=this.max,e=a.min,f=a.max,g=0,h=this.dim;h>g;){var i=g++;if(!S.intervalsOverlap(c[i],d[i],e[i],f[i],b))return!1}return!0},clear:function(){return this.initialized=!1,this},getLongestAxis:function(){for(var a=0,b=0,c=0,d=this.dim;d>c;){var e=c++,f=this.getAxisLength(e);f>a&&(a=f,b=e)}return b},getAxisLength:function(a){return 0>a||a>this.dim-1?0:Math.abs(this.min[a]-this.max[a])},intersect:function(a,b){if(!this.initialized)return null;var c=this.min,d=this.max,e=a.min,f=a.max;if(!this.intersects(a,b))return null;for(var g=[],h=[],i=0,j=this.dim;j>i;){var k=i++;g.push(Math.min(d[k],f[k])),h.push(Math.max(c[k],e[k]))}return new S([h,g])},__class__:S};var T=b.core.Constants=function(){};g["verb.core.Constants"]=T,T.__name__=["verb","core","Constants"];var U=b.core.SerializableBase=function(){};g["verb.core.SerializableBase"]=U,U.__name__=["verb","core","SerializableBase"],U.prototype={serialize:function(){var a=new u;return a.serialize(this),a.toString()},__class__:U};var V=b.core.Plane=function(a,b){this.origin=a,this.normal=b};g["verb.core.Plane"]=V,V.__name__=["verb","core","Plane"],V.__super__=U,V.prototype=d(U.prototype,{__class__:V});var W=b.core.Ray=function(a,b){this.origin=a,this.dir=b};g["verb.core.Ray"]=W,W.__name__=["verb","core","Ray"],W.__super__=U,W.prototype=d(U.prototype,{__class__:W});var X=b.core.NurbsCurveData=function(a,b,c){this.degree=a,this.controlPoints=c,this.knots=b};g["verb.core.NurbsCurveData"]=X,X.__name__=["verb","core","NurbsCurveData"],X.__super__=U,X.prototype=d(U.prototype,{__class__:X});var Y=b.core.NurbsSurfaceData=function(a,b,c,d,e){this.degreeU=a,this.degreeV=b,this.knotsU=c,this.knotsV=d,this.controlPoints=e};g["verb.core.NurbsSurfaceData"]=Y,Y.__name__=["verb","core","NurbsSurfaceData"],Y.__super__=U,Y.prototype=d(U.prototype,{__class__:Y});var Z=b.core.MeshData=function(a,b,c,d){this.faces=a,this.points=b,this.normals=c,this.uvs=d};g["verb.core.MeshData"]=Z,Z.__name__=["verb","core","MeshData"],Z.empty=function(){return new Z([],[],[],[])},Z.__super__=U,Z.prototype=d(U.prototype,{__class__:Z});var $=b.core.PolylineData=function(a,b){this.points=a,this.params=b};g["verb.core.PolylineData"]=$,$.__name__=["verb","core","PolylineData"],$.__super__=U,$.prototype=d(U.prototype,{__class__:$});var _=b.core.VolumeData=function(a,b,c,d,e,f,g){this.degreeU=a,this.degreeV=b,this.degreeW=c,this.knotsU=d,this.knotsV=e,this.knotsW=f,this.controlPoints=g};g["verb.core.VolumeData"]=_,_.__name__=["verb","core","VolumeData"],_.__super__=U,_.prototype=d(U.prototype,{__class__:_});var aa=b.core.Pair=function(a,b){this.item0=a,this.item1=b};g["verb.core.Pair"]=aa,aa.__name__=["verb","core","Pair"],aa.prototype={__class__:aa};var ba=b.core.Interval=function(a,b){this.min=a,this.max=b};g["verb.core.Interval"]=ba,ba.__name__=["verb","core","Interval"],ba.prototype={__class__:ba};var ca=b.core.CurveCurveIntersection=function(a,b,c,d){this.point0=a,this.point1=b,this.u0=c,this.u1=d};g["verb.core.CurveCurveIntersection"]=ca,ca.__name__=["verb","core","CurveCurveIntersection"],ca.prototype={__class__:ca};var da=b.core.CurveSurfaceIntersection=function(a,b,c,d){this.u=a,this.uv=b,this.curvePoint=c,this.surfacePoint=d};g["verb.core.CurveSurfaceIntersection"]=da,da.__name__=["verb","core","CurveSurfaceIntersection"],da.prototype={__class__:da};var ea=b.core.MeshIntersectionPoint=function(a,b,c,d,e){this.visited=!1,this.adj=null,this.opp=null,this.uv0=a,this.uv1=b,this.point=c,this.faceIndex0,this.faceIndex1};g["verb.core.MeshIntersectionPoint"]=ea,ea.__name__=["verb","core","MeshIntersectionPoint"],ea.prototype={__class__:ea};var fa=b.core.PolylineMeshIntersection=function(a,b,c,d,e){this.point=a,this.u=b,this.uv=c,this.polylineIndex=d,this.faceIndex=e};g["verb.core.PolylineMeshIntersection"]=fa,fa.__name__=["verb","core","PolylineMeshIntersection"],fa.prototype={__class__:fa};var ga=b.core.SurfaceSurfaceIntersectionPoint=function(a,b,c,d){this.uv0=a,this.uv1=b,this.point=c,this.dist=d};g["verb.core.SurfaceSurfaceIntersectionPoint"]=ga,ga.__name__=["verb","core","SurfaceSurfaceIntersectionPoint"],ga.prototype={__class__:ga};var ha=b.core.TriSegmentIntersection=function(a,b,c,d){this.point=a,this.s=b,this.t=c,this.p=d};g["verb.core.TriSegmentIntersection"]=ha,ha.__name__=["verb","core","TriSegmentIntersection"],ha.prototype={__class__:ha};var ia=b.core.CurveTriPoint=function(a,b,c){this.u=a,this.point=b,this.uv=c};g["verb.core.CurveTriPoint"]=ia,ia.__name__=["verb","core","CurveTriPoint"],ia.prototype={__class__:ia};var ja=function(a,b,c,d,e){null==e&&(e=!1),null==d&&(d=-1),this.uv=c,this.point=a,this.normal=b,this.id=d,this.degen=e};g["verb.core.SurfacePoint"]=ja,ja.__name__=["verb","core","SurfacePoint"],ja.fromUv=function(a,b){return new ja(null,null,[a,b])},ja.prototype={__class__:ja};var ka=b.core.CurvePoint=function(a,b){this.u=a,this.pt=b};g["verb.core.CurvePoint"]=ka,ka.__name__=["verb","core","CurvePoint"],ka.prototype={__class__:ka};var la=b.core.KdTree=function(a,b){this.dim=3,this.points=a,this.distanceFunction=b,this.dim=a[0].point.length,this.root=this.buildTree(a,0,null)};g["verb.core.KdTree"]=la,la.__name__=["verb","core","KdTree"],la.prototype={buildTree:function(a,b,c){var d,e,f=b%this.dim;return 0==a.length?null:1==a.length?new oa(a[0],f,c):(a.sort(function(a,b){var c=a.point[f]-b.point[f];return 0==c?0:c>0?1:-1}),d=Math.floor(a.length/2),e=new oa(a[d],f,c),e.left=this.buildTree(a.slice(0,d),b+1,e),e.right=this.buildTree(a.slice(d+1),b+1,e),e)},nearest:function(a,b,c){var d,e=this,f=new ma(function(a){return-a.item1}),g=null;g=function(c){for(var d,h,i=c.dimension,j=e.distanceFunction(a,c.kdPoint.point),k=[],l=0,m=e.dim;m>l;){l++;k.push(0)}h=k;for(var n,o,p=function(a,c){f.push(new aa(a,c)),f.size()>b&&f.pop()},q=0,r=e.dim;r>q;){var s=q++;s==c.dimension?h[s]=a[s]:h[s]=c.kdPoint.point[s]}return n=e.distanceFunction(h,c.kdPoint.point),null==c.right&&null==c.left?void((f.size()<b||j<f.peek().item1)&&p(c,j)):(d=null==c.right?c.left:null==c.left?c.right:a[i]<c.kdPoint.point[i]?c.left:c.right,g(d),(f.size()<b||j<f.peek().item1)&&p(c,j),void((f.size()<b||Math.abs(n)<f.peek().item1)&&(o=d==c.left?c.right:c.left,null!=o&&g(o))))},d=g;for(var h=0;b>h;){h++;f.push(new aa(null,c))}d(this.root);for(var i=[],j=0;b>j;){var k=j++;null!=f.content[k].item0&&i.push(new aa(f.content[k].item0.kdPoint,f.content[k].item1))}return i},__class__:la};var ma=function(a){this.content=[],this.scoreFunction=a};g["verb.core.BinaryHeap"]=ma,ma.__name__=["verb","core","BinaryHeap"],ma.prototype={push:function(a){this.content.push(a),this.bubbleUp(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();return this.content.length>0&&(this.content[0]=b,this.sinkDown(0)),a},peek:function(){return this.content[0]},remove:function(a){for(var b=this.content.length,c=0;b>c;){var d=c++;if(this.content[d]==a){var e=this.content.pop();return void(d!=b-1&&(this.content[d]=e,this.scoreFunction(e)<this.scoreFunction(a)?this.bubbleUp(d):this.sinkDown(d)))}}throw new D("Node not found.")},size:function(){return this.content.length},bubbleUp:function(a){for(var b=this.content[a];a>0;){var c=Math.floor((a+1)/2)-1,d=this.content[c];if(!(this.scoreFunction(b)<this.scoreFunction(d)))break;this.content[c]=b,this.content[a]=d,a=c}},sinkDown:function(a){for(var b=this.content.length,c=this.content[a],d=this.scoreFunction(c);;){var e=2*(a+1),f=e-1,g=-1,h=0;if(b>f){var i=this.content[f];h=this.scoreFunction(i),d>h&&(g=f)}if(b>e){var j=this.content[e],k=this.scoreFunction(j);(-1==g?d:h)>k&&(g=e)}if(-1==g)break;this.content[a]=this.content[g],this.content[g]=c,a=g}},__class__:ma};var na=b.core.KdPoint=function(a,b){this.point=a,this.obj=b};g["verb.core.KdPoint"]=na,na.__name__=["verb","core","KdPoint"],na.prototype={__class__:na};var oa=b.core.KdNode=function(a,b,c){this.kdPoint=a,this.left=null,this.right=null,this.parent=c,this.dimension=b};g["verb.core.KdNode"]=oa,oa.__name__=["verb","core","KdNode"],oa.prototype={__class__:oa};var pa=function(){};g["verb.eval.IBoundingBoxTree"]=pa,pa.__name__=["verb","eval","IBoundingBoxTree"],pa.prototype={__class__:pa};var qa=function(a,b){this._boundingBox=null,this._curve=a,null==b&&(b=Da.domain(this._curve.knots)/64),this._knotTol=b};g["verb.core.LazyCurveBoundingBoxTree"]=qa,qa.__name__=["verb","core","LazyCurveBoundingBoxTree"],qa.__interfaces__=[pa],qa.prototype={split:function(){var a=Q.first(this._curve.knots),b=Q.last(this._curve.knots),c=b-a,d=Ha.curveSplit(this._curve,(b+a)/2+.1*c*Math.random());return new aa(new qa(d[0],this._knotTol),new qa(d[1],this._knotTol))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new S(Ja.dehomogenize1d(this._curve.controlPoints))),this._boundingBox},"yield":function(){return this._curve},indivisible:function(a){return Da.domain(this._curve.knots)<this._knotTol},empty:function(){return!1},__class__:qa};var ra=function(a,b){if(this._boundingBox=null,this._mesh=a,null==b){for(var c=[],d=0,e=a.faces.length;e>d;){var f=d++;c.push(f)}b=c}this._faceIndices=b};g["verb.core.LazyMeshBoundingBoxTree"]=ra,ra.__name__=["verb","core","LazyMeshBoundingBoxTree"],ra.__interfaces__=[pa],ra.prototype={split:function(){var a=wa.sortTrianglesOnLongestAxis(this.boundingBox(),this._mesh,this._faceIndices),b=Q.left(a),c=Q.right(a);return new aa(new ra(this._mesh,b),new ra(this._mesh,c))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=wa.makeMeshAabb(this._mesh,this._faceIndices)),this._boundingBox},"yield":function(){return this._faceIndices[0]},indivisible:function(a){return 1==this._faceIndices.length},empty:function(){return 0==this._faceIndices.length},__class__:ra};var sa=function(a,b){this._boundingBox=null,this._polyline=a,null==b&&(b=new ba(0,0!=a.points.length?a.points.length-1:0)),this._interval=b};g["verb.core.LazyPolylineBoundingBoxTree"]=sa,sa.__name__=["verb","core","LazyPolylineBoundingBoxTree"],sa.__interfaces__=[pa],sa.prototype={split:function(){var a=this._interval.min,b=this._interval.max,c=a+Math.ceil((b-a)/2),d=new ba(a,c),e=new ba(c,b);return new aa(new sa(this._polyline,d),new sa(this._polyline,e))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new S(this._polyline.points)),this._boundingBox},"yield":function(){return this._interval.min},indivisible:function(a){return this._interval.max-this._interval.min==1},empty:function(){return this._interval.max-this._interval.min==0},__class__:sa};var ta=function(a,b,c,d){null==b&&(b=!1),this._boundingBox=null,this._surface=a,this._splitV=b,null==c&&(c=Da.domain(a.knotsU)/16),null==d&&(d=Da.domain(a.knotsV)/16),this._knotTolU=c,this._knotTolV=d};g["verb.core.LazySurfaceBoundingBoxTree"]=ta,ta.__name__=["verb","core","LazySurfaceBoundingBoxTree"],ta.__interfaces__=[pa],ta.prototype={split:function(){var a,b;this._splitV?(a=Q.first(this._surface.knotsV),b=Q.last(this._surface.knotsV)):(a=Q.first(this._surface.knotsU),b=Q.last(this._surface.knotsU));var c=(a+b)/2,d=Ha.surfaceSplit(this._surface,c,this._splitV);return new aa(new ta(d[0],!this._splitV,this._knotTolU,this._knotTolV),new ta(d[1],!this._splitV,this._knotTolU,this._knotTolV))},boundingBox:function(){if(null==this._boundingBox){this._boundingBox=new S;for(var a=0,b=this._surface.controlPoints;a<b.length;){var c=b[a];++a,this._boundingBox.addRange(Ja.dehomogenize1d(c))}}return this._boundingBox},"yield":function(){return this._surface},indivisible:function(a){return Da.domain(this._surface.knotsV)<this._knotTolV&&Da.domain(this._surface.knotsU)<this._knotTolU},empty:function(){return!1},__class__:ta};var ua=b.core.Mat=function(){};g["verb.core.Mat"]=ua,ua.__name__=["verb","core","Mat"],ua.mul=function(a,b){for(var c=[],d=0,e=b.length;e>d;){var f=d++;c.push(Da.mul(a,b[f]))}return c},ua.mult=function(a,b){var c,d,e,f,g,h,i,j;c=a.length,d=b.length,e=b[0].length,f=[];for(var k=c-1,l=0,m=0;k>=0;){for(g=[],h=a[k],m=e-1;m>=0;){for(i=h[d-1]*b[d-1][m],l=d-2;l>=1;)j=l-1,i+=h[l]*b[l][m]+h[j]*b[j][m],l-=2;0==l&&(i+=h[0]*b[0][m]),g[m]=i,m--}f[k]=g,k--}return f},ua.add=function(a,b){for(var c=[],d=0,e=a.length;e>d;){var f=d++;c.push(Da.add(a[f],b[f]))}return c},ua.div=function(a,b){for(var c=[],d=0,e=a.length;e>d;){var f=d++;c.push(Da.div(a[f],b))}return c},ua.sub=function(a,b){for(var c=[],d=0,e=a.length;e>d;){var f=d++;c.push(Da.sub(a[f],b[f]))}return c},ua.dot=function(a,b){for(var c=[],d=0,e=a.length;e>d;){var f=d++;c.push(Da.dot(a[f],b))}return c},ua.identity=function(a){for(var b=Da.zeros2d(a,a),c=0;a>c;){var d=c++;b[d][d]=1}return b},ua.transpose=function(a){if(0==a.length)return[];for(var b=[],c=0,d=a[0].length;d>c;){var e=c++;b.push(function(b){for(var c,d=[],f=0,g=a.length;g>f;){var h=f++;d.push(a[h][e])}return c=d}(this))}return b},ua.solve=function(a,b){return ua.LUsolve(ua.LU(a),b)},ua.LUsolve=function(a,b){var c,d,e,f,g,h=a.LU,i=h.length,j=b.slice(),k=a.P;for(c=i-1;-1!=c;)j[c]=b[c],--c;for(c=0;i>c;){for(e=k[c],k[c]!=c&&(g=j[c],j[c]=j[e],j[e]=g),f=h[c],d=0;c>d;)j[c]-=j[d]*f[d],++d;++c}for(c=i-1;c>=0;){for(f=h[c],d=c+1;i>d;)j[c]-=j[d]*f[d],++d;j[c]/=f[c],--c}return j},ua.LU=function(a){for(var b,c,d,e,f,g,h,i,j,k=(Math.abs,[]),l=0,m=a.length;m>l;){var n=l++;k.push(a[n].slice())}a=k;var o=a.length,p=o-1,q=[];for(d=0;o>d;){for(h=d,g=a[d],j=Math.abs(g[d]),c=d+1;o>c;)e=Math.abs(a[c][d]),e>j&&(j=e,h=c),++c;for(q[d]=h,h!=d&&(a[d]=a[h],a[h]=g,g=a[d]),f=g[d],b=d+1;o>b;)a[b][d]/=f,++b;for(b=d+1;o>b;){for(i=a[b],c=d+1;p>c;)i[c]-=i[d]*g[c],++c,i[c]-=i[d]*g[c],++c;c==p&&(i[c]-=i[d]*g[c]),++b}++d}return new va(a,q)};var va=function(a,b){this.LU=a,this.P=b};g["verb.core._Mat.LUDecomp"]=va,va.__name__=["verb","core","_Mat","LUDecomp"],va.prototype={__class__:va};var wa=b.core.Mesh=function(){};g["verb.core.Mesh"]=wa,wa.__name__=["verb","core","Mesh"],wa.getTriangleNorm=function(a,b){var c=a[b[0]],d=a[b[1]],e=a[b[2]],f=Da.sub(d,c),g=Da.sub(e,c),h=Da.cross(f,g);return Da.mul(1/Da.norm(h),h)},wa.makeMeshAabb=function(a,b){for(var c=new S,d=0;d<b.length;){var e=b[d];++d,c.add(a.points[a.faces[e][0]]),c.add(a.points[a.faces[e][1]]),c.add(a.points[a.faces[e][2]])}return c},wa.sortTrianglesOnLongestAxis=function(a,b,c){for(var d=a.getLongestAxis(),e=[],f=0;f<c.length;){var g=c[f];++f;var h=wa.getMinCoordOnAxis(b.points,b.faces[g],d);e.push(new aa(h,g))}e.sort(function(a,b){var c=a.item0,d=b.item0;return c==d?0:c>d?1:-1});for(var i=[],j=0,k=e.length;k>j;){var l=j++;i.push(e[l].item1)}return i},wa.getMinCoordOnAxis=function(a,b,c){for(var d=1/0,e=0;3>e;){var f=e++,g=a[b[f]][c];d>g&&(d=g)}return d},wa.getTriangleCentroid=function(a,b){for(var c=[0,0,0],d=0;3>d;)for(var e=d++,f=0;3>f;){var g=f++;c[g]+=a[b[e]][g]}for(var h=0;3>h;){var i=h++;c[i]/=3}return c},wa.triangleUVFromPoint=function(a,b,c){var d=a.faces[b],e=a.points[d[0]],f=a.points[d[1]],g=a.points[d[2]],h=a.uvs[d[0]],i=a.uvs[d[1]],j=a.uvs[d[2]],k=Da.sub(e,c),l=Da.sub(f,c),m=Da.sub(g,c),n=Da.norm(Da.cross(Da.sub(e,f),Da.sub(e,g))),o=Da.norm(Da.cross(l,m))/n,p=Da.norm(Da.cross(m,k))/n,q=Da.norm(Da.cross(k,l))/n;return Da.add(Da.mul(o,h),Da.add(Da.mul(p,i),Da.mul(q,j)))};var xa=function(a,b){if(this._empty=!1,this._face=-1,null==b){for(var c=[],d=0,e=a.faces.length;e>d;){var f=d++;c.push(f)}b=c}if(this._boundingBox=wa.makeMeshAabb(a,b),b.length<1)return void(this._empty=!0);if(b.length<2)return void(this._face=b[0]);var g=wa.sortTrianglesOnLongestAxis(this._boundingBox,a,b),h=Q.left(g),i=Q.right(g);this._children=new aa(new xa(a,h),new xa(a,i))};g["verb.core.MeshBoundingBoxTree"]=xa,xa.__name__=["verb","core","MeshBoundingBoxTree"],xa.__interfaces__=[pa],xa.prototype={split:function(){return this._children},boundingBox:function(){return this._boundingBox},"yield":function(){return this._face},indivisible:function(a){return null==this._children},empty:function(){return this._empty},__class__:xa};var ya=b.core.Minimizer=function(){};g["verb.core.Minimizer"]=ya,ya.__name__=["verb","core","Minimizer"],ya.uncmin=function(a,b,c,d,e){null==c&&(c=1e-8),null==d&&(d=function(b){return ya.numericalGradient(a,b)}),null==e&&(e=1e3),b=b.slice(0);var f,g=b.length,h=a(b),i=h;if(isNaN(h))throw new D("uncmin: f(x0) is a NaN!");c=Math.max(c,T.EPSILON);var j,k,l,m,n,o,p,q,r,s=ua.identity(g),t=0,u=[],v="";for(k=d(b);e>t;){if(!Da.all(Da.finite(k))){v="Gradient has Infinity or NaN";break}if(j=Da.neg(ua.dot(s,k)),!Da.all(Da.finite(j))){v="Search direction has Infinity or NaN";break}if(r=Da.norm(j),c>r){v="Newton step smaller than tol";break}for(q=1,f=Da.dot(k,j),m=b;e>t&&!(c>q*r)&&(u=Da.mul(q,j),m=Da.add(b,u),i=a(m),i-h>=.1*q*f||isNaN(i));)q*=.5,++t;if(c>q*r){v="Line search step size smaller than tol";break}if(t==e){v="maxit reached during line search";break}l=d(m),n=Da.sub(l,k),p=Da.dot(n,u),o=ua.dot(s,n),s=ua.sub(ua.add(s,ua.mul((p+Da.dot(n,o))/(p*p),ya.tensor(u,u))),ua.div(ua.add(ya.tensor(o,u),ya.tensor(u,o)),p)),b=m,h=i,k=l,++t}return new za(b,h,k,s,t,v)},ya.numericalGradient=function(a,b){var c=b.length,d=a(b);if(NaN==d)throw new D("gradient: f(x) is a NaN!");for(var e,f,g,h,i,j,k,l,m,n=b.slice(0),o=[],p=.001,q=0,r=0;c>r;)for(var s=r++,t=Math.max(1e-6*d,1e-8);;){if(++q,q>20)throw new D("Numerical gradient fails");if(n[s]=b[s]+t,e=a(n),n[s]=b[s]-t,f=a(n),n[s]=b[s],isNaN(e)||isNaN(f))t/=16;else{if(o[s]=(e-f)/(2*t),h=b[s]-t,i=b[s],j=b[s]+t,k=(e-d)/t,l=(d-f)/t,m=Da.max([Math.abs(o[s]),Math.abs(d),Math.abs(e),Math.abs(f),Math.abs(h),Math.abs(i),Math.abs(j),1e-8]),g=Math.min(Da.max([Math.abs(k-o[s]),Math.abs(l-o[s]),Math.abs(k-l)])/m,t/m),!(g>p))break;t/=16}}return o},ya.tensor=function(a,b){for(var c,d,e=a.length,f=b.length,g=[],h=e-1;h>=0;){c=[],d=a[h];for(var i=f-1;i>=3;)c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i;for(;i>=0;)c[i]=d*b[i],--i;g[h]=c,h--}return g};var za=function(a,b,c,d,e,f){this.solution=a,this.value=b,this.gradient=c,this.invHessian=d,this.iterations=e,this.message=f};g["verb.core.MinimizationResult"]=za,za.__name__=["verb","core","MinimizationResult"],za.prototype={__class__:za};var Aa=function(){};g["verb.core.ISerializable"]=Aa,Aa.__name__=["verb","core","ISerializable"],Aa.prototype={__class__:Aa};var Ba=b.core.Deserializer=function(){};g["verb.core.Deserializer"]=Ba,Ba.__name__=["verb","core","Deserializer"],Ba.deserialize=function(a){var b=new v(a),c=b.unserialize();return c};var Ca=b.core.Trig=function(){};g["verb.core.Trig"]=Ca,Ca.__name__=["verb","core","Trig"],Ca.isPointInPlane=function(a,b,c){return Math.abs(Da.dot(Da.sub(a,b.origin),b.normal))<c},Ca.distToSegment=function(a,b,c){var d=Ca.segmentClosestPoint(b,a,c,0,1);return Da.dist(b,d.pt)},Ca.rayClosestPoint=function(a,b,c){var d=Da.sub(a,b),e=Da.dot(d,c),f=Da.add(b,Da.mul(e,c));return f},Ca.distToRay=function(a,b,c){var d=Ca.rayClosestPoint(a,b,c),e=Da.sub(d,a);return Da.norm(e)},Ca.threePointsAreFlat=function(a,b,c,d){var e=Da.sub(b,a),f=Da.sub(c,a),g=Da.cross(e,f),h=Da.dot(g,g);return d>h},Ca.segmentClosestPoint=function(a,b,c,d,e){var f=Da.sub(c,b),g=Da.norm(f);if(g<T.EPSILON)return{u:d,pt:b};var h=b,i=Da.mul(1/g,f),j=Da.sub(a,h),k=Da.dot(j,i);return 0>k?{u:d,pt:b}:k>g?{u:e,pt:c}:{u:d+(e-d)*k/g,pt:Da.add(h,Da.mul(k,i))}};var Da=b.core.Vec=function(){};g["verb.core.Vec"]=Da,Da.__name__=["verb","core","Vec"],Da.angleBetween=function(a,b){return Math.acos(Da.dot(a,b)/(Da.norm(a)*Da.norm(b)))},Da.positiveAngleBetween=function(a,b,c){var d=Da.cross(a,b),e=Da.norm(a),f=Da.norm(b),g=e*f,h=Da.dot(a,b),i=Da.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Da.dot(c,d);return Math.abs(l)<T.EPSILON?k:l>0?k:-k},Da.signedAngleBetween=function(a,b,c){var d=Da.cross(a,b),e=Da.norm(a),f=Da.norm(b),g=e*f,h=Da.dot(a,b),i=Da.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Da.dot(c,d);return l>0?k:2*Math.PI-k},Da.angleBetweenNormalized2d=function(a,b){var c=a[0]*b[1]-a[1]*b[0];return Math.atan2(c,Da.dot(a,b))},Da.domain=function(a){return Q.last(a)-Q.first(a)},Da.range=function(a){for(var b=[],c=0,d=0;a>d;){d++;b.push(c),c+=1}return b},Da.span=function(a,b,c){if(null==c)return[];if(c<T.EPSILON)return[];if(a>b&&c>0)return[];if(b>a&&0>c)return[];for(var d=[],e=a;b>=e;)d.push(e),e+=c;return d},Da.neg=function(a){return a.map(function(a){return-a})},Da.min=function(a){return j.fold(a,function(a,b){return Math.min(a,b)},1/0)},Da.max=function(a){return j.fold(a,function(a,b){return Math.max(a,b)},-(1/0))},Da.all=function(a){return j.fold(a,function(a,b){return b&&a},!0)},Da.finite=function(a){return a.map(function(a){return isFinite(a)})},Da.onRay=function(a,b,c){return Da.add(a,Da.mul(c,b))},Da.lerp=function(a,b,c){return Da.add(Da.mul(a,b),Da.mul(1-a,c))},Da.normalized=function(a){return Da.div(a,Da.norm(a))},Da.cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},Da.dist=function(a,b){return Da.norm(Da.sub(a,b))},Da.distSquared=function(a,b){return Da.normSquared(Da.sub(a,b))},Da.sum=function(a){return j.fold(a,function(a,b){return b+a},0)},Da.addAll=function(a){var b=e(a)();if(!b.hasNext())return null;var c=b.next().length;return j.fold(a,function(a,b){return Da.add(b,a)},Da.rep(c,0))},Da.addAllMutate=function(a){for(var b=a[0],c=1,d=a.length;d>c;){var e=c++;Da.addMutate(b,a[e])}},Da.addMulMutate=function(a,b,c){for(var d=0,e=a.length;e>d;){var f=d++;a[f]=a[f]+b*c[f]}},Da.subMulMutate=function(a,b,c){for(var d=0,e=a.length;e>d;){var f=d++;a[f]=a[f]-b*c[f]}},Da.addMutate=function(a,b){for(var c=0,d=a.length;d>c;){var e=c++;a[e]=a[e]+b[e]}},Da.subMutate=function(a,b){for(var c=0,d=a.length;d>c;){var e=c++;a[e]=a[e]-b[e]}},Da.mulMutate=function(a,b){for(var c=0,d=b.length;d>c;){var e=c++;b[e]=b[e]*a}},Da.norm=function(a){var b=Da.normSquared(a);return 0!=b?Math.sqrt(b):b},Da.normSquared=function(a){return j.fold(a,function(a,b){return b+a*a},0)},Da.rep=function(a,b){for(var c=[],d=0;a>d;){d++;c.push(b)}return c},Da.zeros1d=function(a){for(var b=[],c=0;a>c;){c++;b.push(0)}return b},Da.zeros2d=function(a,b){for(var c=[],d=0;a>d;){d++;c.push(Da.zeros1d(b))}return c},Da.zeros3d=function(a,b,c){for(var d=[],e=0;a>e;){e++;d.push(Da.zeros2d(b,c))}return d},Da.dot=function(a,b){for(var c=0,d=0,e=a.length;e>d;){var f=d++;c+=a[f]*b[f]}return c},Da.add=function(a,b){for(var c=[],d=0,e=a.length;e>d;){var f=d++;c.push(a[f]+b[f])}return c},Da.mul=function(a,b){for(var c=[],d=0,e=b.length;e>d;){var f=d++;c.push(a*b[f])}return c},Da.div=function(a,b){for(var c=[],d=0,e=a.length;e>d;){var f=d++;c.push(a[f]/b)}return c},Da.sub=function(a,b){for(var c=[],d=0,e=a.length;e>d;){var f=d++;c.push(a[f]-b[f])}return c},Da.isZero=function(a){for(var b=0,c=a.length;c>b;){var d=b++;if(Math.abs(a[d])>T.TOLERANCE)return!1}return!0},Da.sortedSetUnion=function(a,b){for(var c=[],d=0,e=0;d<a.length||e<b.length;)if(d>=a.length)c.push(b[e]),e++;else if(e>=b.length)c.push(a[d]),d++;else{var f=a[d]-b[e];Math.abs(f)<T.EPSILON?(c.push(a[d]),d++,e++):f>0?(c.push(b[e]),e++):(c.push(a[d]),d++)}return c},Da.sortedSetSub=function(a,b){for(var c=[],d=0,e=0;d<a.length;)e>=b.length?(c.push(a[d]),d++):Math.abs(a[d]-b[e])<T.EPSILON?(d++,e++):(c.push(a[d]),d++);return c};var Ea=b.eval.Analyze=function(){};g["verb.eval.Analyze"]=Ea,Ea.__name__=["verb","eval","Analyze"],Ea.knotMultiplicities=function(a){for(var b=[new Fa(a[0],0)],c=b[0],d=0;d<a.length;){var e=a[d];++d,Math.abs(e-c.knot)>T.EPSILON&&(c=new Fa(e,0),b.push(c)),c.inc()}return b},Ea.isRationalSurfaceClosed=function(a,b){null==b&&(b=!0);var c;c=b?a.controlPoints:ua.transpose(a.controlPoints);for(var d=0,e=c[0].length;e>d;){var f=d++,g=Da.dist(Q.first(c)[f],Q.last(c)[f])<T.EPSILON;if(!g)return!1}return!0},Ea.rationalSurfaceClosestPoint=function(a,b){var c=Ea.rationalSurfaceClosestParam(a,b);return Ja.rationalSurfacePoint(a,c[0],c[1])},Ea.rationalSurfaceClosestParam=function(a,b){for(var c,d,e,f=5,g=0,h=1e-4,i=5e-4,j=a.knotsU[0],k=Q.last(a.knotsU),l=a.knotsV[0],m=Q.last(a.knotsV),n=Ea.isRationalSurfaceClosed(a),o=Ea.isRationalSurfaceClosed(a,!1),p=Qa.rationalSurfaceAdaptive(a,new Ra),q=1/0,r=0,s=p.points.length;s>r;){var t=r++,u=p.points[t],v=Da.normSquared(Da.sub(b,u));q>v&&(q=v,e=p.uvs[t])}for(var w=function(b){return Ja.rationalSurfaceDerivatives(a,b[0],b[1],2)},x=function(a,b,c){var d=b[1][0],e=b[0][1],f=b[2][0],g=b[0][2],h=b[1][1],i=b[1][1],j=Da.dot(d,c),k=Da.dot(e,c),l=[-j,-k],m=Da.dot(d,d)+Da.dot(f,c),n=Da.dot(d,e)+Da.dot(h,c),o=Da.dot(d,e)+Da.dot(i,c),p=Da.dot(e,e)+Da.dot(g,c),q=[[m,n],[o,p]],r=ua.solve(q,l);return Da.add(r,a)};f>g;){c=w(e),d=Da.sub(c[0][0],b);var y=Da.norm(d),z=Da.dot(c[1][0],d),A=Da.norm(c[1][0])*y,B=Da.dot(c[0][1],d),C=Da.norm(c[0][1])*y,D=z/A,E=B/C,F=h>y,G=i>D,H=i>E;if(F&&G&&H)return e;var I=x(e,c,d);I[0]<j?I=n?[k-(I[0]-j),I[1]]:[j+T.EPSILON,I[1]]:I[0]>k&&(I=n?[j+(I[0]-k),I[1]]:[k-T.EPSILON,I[1]]),I[1]<l?I=o?[I[0],m-(I[1]-l)]:[I[0],l+T.EPSILON]:I[1]>m&&(I=o?[I[0],l+(I[0]-m)]:[I[0],m-T.EPSILON]);var J=Da.norm(Da.mul(I[0]-e[0],c[1][0])),K=Da.norm(Da.mul(I[1]-e[1],c[0][1]));if(h>J+K)return e;e=I,g++}return e},Ea.rationalCurveClosestPoint=function(a,b){return Ja.rationalCurvePoint(a,Ea.rationalCurveClosestParam(a,b))},Ea.rationalCurveClosestParam=function(a,b){for(var c=1/0,d=0,e=Qa.rationalCurveRegularSample(a,a.controlPoints.length*a.degree,!0),f=0,g=e.length-1;g>f;){var h=f++,i=e[h].pop(),j=e[h+1].pop(),k=(e[h],e[h]),l=e[h+1],m=Ca.segmentClosestPoint(b,k,l,i,j),n=Da.norm(Da.sub(b,m.pt));c>n&&(c=n,d=m.u)}for(var o,p,q=5,r=0,s=1e-4,t=5e-4,u=a.knots[0],v=Q.last(a.knots),w=Da.normSquared(Da.sub(a.controlPoints[0],Q.last(a.controlPoints)))<T.EPSILON,x=d,y=function(b){return Ja.rationalCurveDerivatives(a,b,2)},z=function(a,b,c){var d=Da.dot(b[1],c),e=Da.dot(b[2],c),f=Da.dot(b[1],b[1]),g=e+f;return a-d/g};q>r;){o=y(x),p=Da.sub(o[0],b);var A=Da.norm(p),B=Da.dot(o[1],p),C=Da.norm(o[1])*A,D=B/C,E=s>A,F=Math.abs(D)<t;if(E&&F)return x;var G=z(x,o,p);u>G?G=w?v-(G-u):u:G>v&&(G=w?u+(G-v):v);var H=Da.norm(Da.mul(G-x,o[1]));if(s>H)return x;x=G,r++}return x},Ea.rationalCurveParamAtArcLength=function(a,b,c,d,e){if(null==c&&(c=.001),b<T.EPSILON)return a.knots[0];var f;f=null!=d?d:Ma.decomposeCurveIntoBeziers(a);var g,h=0,i=(f[h],-T.EPSILON);for(g=null!=e?e:[];b>i&&h<f.length;){if(h<g.length?g[h]=g[h]:g[h]=Ea.rationalBezierCurveArcLength(a),i+=g[h],b<i+T.EPSILON)return Ea.rationalBezierCurveParamAtArcLength(a,b,c,g[h]);h++}return-1},Ea.rationalBezierCurveParamAtArcLength=function(a,b,c,d){if(0>b)return a.knots[0];var e;if(e=null!=d?d:Ea.rationalBezierCurveArcLength(a),b>e)return Q.last(a.knots);var f,g=a.knots[0],h=0,i=Q.last(a.knots),j=e,k=0,l=0;for(f=null!=c?c:2*T.TOLERANCE;j-h>f;)k=(g+i)/2,l=Ea.rationalBezierCurveArcLength(a,k),l>b?(i=k,j=l):(g=k,h=l);return(g+i)/2},Ea.rationalCurveArcLength=function(a,b,c){null==c&&(c=16),b=null==b?Q.last(a.knots):b;for(var d=Ma.decomposeCurveIntoBeziers(a),e=0,f=d[0],g=0;e<d.length&&f.knots[0]+T.EPSILON<b;){var h=Math.min(Q.last(f.knots),b);g+=Ea.rationalBezierCurveArcLength(f,h,c),f=d[++e]}return g},Ea.rationalBezierCurveArcLength=function(a,b,c){null==c&&(c=16);var d;d=null==b?Q.last(a.knots):b;for(var e,f,g=(d-a.knots[0])/2,h=0,i=a.degree+c,j=0;i>j;){var k=j++;e=g*Ea.Tvalues[i][k]+g+a.knots[0],
f=Ja.rationalCurveDerivatives(a,e,1),h+=Ea.Cvalues[i][k]*Da.norm(f[1])}return g*h};var Fa=b.eval.KnotMultiplicity=function(a,b){this.knot=a,this.mult=b};g["verb.eval.KnotMultiplicity"]=Fa,Fa.__name__=["verb","eval","KnotMultiplicity"],Fa.prototype={inc:function(){this.mult++},__class__:Fa};var Ga=b.eval.Check=function(){};g["verb.eval.Check"]=Ga,Ga.__name__=["verb","eval","Check"],Ga.isValidKnotVector=function(a,b){if(0==a.length)return!1;if(a.length<2*(b+1))return!1;for(var c=Q.first(a),d=0,e=b+1;e>d;){var f=d++;if(Math.abs(a[f]-c)>T.EPSILON)return!1}c=Q.last(a);for(var g=a.length-b-1,h=a.length;h>g;){var i=g++;if(Math.abs(a[i]-c)>T.EPSILON)return!1}return Ga.isNonDecreasing(a)},Ga.isNonDecreasing=function(a){for(var b=Q.first(a),c=0,d=a.length;d>c;){var e=c++;if(a[e]<b-T.EPSILON)return!1;b=a[e]}return!0},Ga.isValidNurbsCurveData=function(a){if(null==a.controlPoints)throw new D("Control points array cannot be null!");if(null==a.degree)throw new D("Degree cannot be null!");if(a.degree<1)throw new D("Degree must be greater than 1!");if(null==a.knots)throw new D("Knots cannot be null!");if(a.knots.length!=a.controlPoints.length+a.degree+1)throw new D("controlPoints.length + degree + 1 must equal knots.length!");if(!Ga.isValidKnotVector(a.knots,a.degree))throw new D("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a},Ga.isValidNurbsSurfaceData=function(a){if(null==a.controlPoints)throw new D("Control points array cannot be null!");if(null==a.degreeU)throw new D("DegreeU cannot be null!");if(null==a.degreeV)throw new D("DegreeV cannot be null!");if(a.degreeU<1)throw new D("DegreeU must be greater than 1!");if(a.degreeV<1)throw new D("DegreeV must be greater than 1!");if(null==a.knotsU)throw new D("KnotsU cannot be null!");if(null==a.knotsV)throw new D("KnotsV cannot be null!");if(a.knotsU.length!=a.controlPoints.length+a.degreeU+1)throw new D("controlPointsU.length + degreeU + 1 must equal knotsU.length!");if(a.knotsV.length!=a.controlPoints[0].length+a.degreeV+1)throw new D("controlPointsV.length + degreeV + 1 must equal knotsV.length!");if(!Ga.isValidKnotVector(a.knotsU,a.degreeU)||!Ga.isValidKnotVector(a.knotsV,a.degreeV))throw new D("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a};var Ha=b.eval.Divide=function(){};g["verb.eval.Divide"]=Ha,Ha.__name__=["verb","eval","Divide"],Ha.surfaceSplit=function(a,b,c){null==c&&(c=!1);var d,e,f;c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ua.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var g,h=[],i=0,j=e+1;j>i;){i++;h.push(b)}g=h;for(var k=[],l=[],m=Ja.knotSpan(e,b,d),n=null,o=0;o<f.length;){var p=f[o];++o,n=Ma.curveKnotRefine(new X(e,d,p),g),k.push(n.controlPoints.slice(0,m+1)),l.push(n.controlPoints.slice(m+1))}var q=n.knots.slice(0,m+e+2),r=n.knots.slice(m+1);return c?[new Y(a.degreeU,e,a.knotsU.slice(),q,k),new Y(a.degreeU,e,a.knotsU.slice(),r,l)]:(k=ua.transpose(k),l=ua.transpose(l),[new Y(e,a.degreeV,q,a.knotsV.slice(),k),new Y(e,a.degreeV,r,a.knotsV.slice(),l)])},Ha.curveSplit=function(a,b){for(var c,d=a.degree,e=(a.controlPoints,a.knots),f=[],g=0,h=d+1;h>g;){g++;f.push(b)}c=f;var i=Ma.curveKnotRefine(a,c),j=Ja.knotSpan(d,b,e),k=i.knots.slice(0,j+d+2),l=i.knots.slice(j+1),m=i.controlPoints.slice(0,j+1),n=i.controlPoints.slice(j+1);return[new X(d,k,m),new X(d,l,n)]},Ha.rationalCurveByEqualArcLength=function(a,b){var c=Ea.rationalCurveArcLength(a),d=c/b;return Ha.rationalCurveByArcLength(a,d)},Ha.rationalCurveByArcLength=function(a,b){var c=Ma.decomposeCurveIntoBeziers(a),d=c.map(function(a){return Ea.rationalBezierCurveArcLength(a)}),e=Da.sum(d),f=[new Ia(a.knots[0],0)];if(b>e)return f;for(var g,h=b,i=0,j=h,k=0,l=0;i<c.length;){for(k+=d[i];j<k+T.EPSILON;)g=Ea.rationalBezierCurveParamAtArcLength(c[i],j-l,T.TOLERANCE,d[i]),f.push(new Ia(g,j)),j+=h;l+=d[i],i++}return f};var Ia=b.eval.CurveLengthSample=function(a,b){this.u=a,this.len=b};g["verb.eval.CurveLengthSample"]=Ia,Ia.__name__=["verb","eval","CurveLengthSample"],Ia.prototype={__class__:Ia};var Ja=b.eval.Eval=function(){};g["verb.eval.Eval"]=Ja,Ja.__name__=["verb","eval","Eval"],Ja.rationalCurveTangent=function(a,b){var c=Ja.rationalCurveDerivatives(a,b,1);return c[1]},Ja.rationalSurfaceNormal=function(a,b,c){var d=Ja.rationalSurfaceDerivatives(a,b,c,1);return Da.cross(d[1][0],d[0][1])},Ja.rationalSurfaceDerivatives=function(a,b,c,d){null==d&&(d=1);for(var e=Ja.surfaceDerivatives(a,b,c,d),f=Ja.rational2d(e),g=Ja.weight2d(e),h=[],i=f[0][0].length,j=0,k=d+1;k>j;){var l=j++;h.push([]);for(var m=0,n=d-l+1;n>m;){for(var o=m++,p=f[l][o],q=1,r=o+1;r>q;){var s=q++;Da.subMulMutate(p,R.get(o,s)*g[0][s],h[l][o-s])}for(var t=1,u=l+1;u>t;){var v=t++;Da.subMulMutate(p,R.get(l,v)*g[v][0],h[l-v][o]);for(var w=Da.zeros1d(i),x=1,y=o+1;y>x;){var z=x++;Da.addMulMutate(w,R.get(o,z)*g[v][z],h[l-v][o-z])}Da.subMulMutate(p,R.get(l,v),w)}Da.mulMutate(1/g[0][0],p),h[l].push(p)}}return h},Ja.rationalSurfacePoint=function(a,b,c){return Ja.dehomogenize(Ja.surfacePoint(a,b,c))},Ja.rationalCurveDerivatives=function(a,b,c){null==c&&(c=1);for(var d=Ja.curveDerivatives(a,b,c),e=Ja.rational1d(d),f=Ja.weight1d(d),g=[],h=0,i=c+1;i>h;){for(var j=h++,k=e[j],l=1,m=j+1;m>l;){var n=l++;Da.subMulMutate(k,R.get(j,n)*f[n],g[j-n])}Da.mulMutate(1/f[0],k),g.push(k)}return g},Ja.rationalCurvePoint=function(a,b){return Ja.dehomogenize(Ja.curvePoint(a,b))},Ja.surfaceDerivatives=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2;return Ja.surfaceDerivativesGivenNM(e,f,a,b,c,d)},Ja.surfaceDerivativesGivenNM=function(a,b,c,d,e,f){var g=c.degreeU,h=c.degreeV,i=c.controlPoints,j=c.knotsU,k=c.knotsV;if(!Ja.areValidRelations(g,i.length,j.length)||!Ja.areValidRelations(h,i[0].length,k.length))throw new D("Invalid relations between control points, knot vector, and n");var l,m=i[0][0].length;l=g>f?f:g;var n;n=h>f?f:h;for(var o=Da.zeros3d(l+1,n+1,m),p=Ja.knotSpanGivenN(a,g,d,j),q=Ja.knotSpanGivenN(b,h,e,k),r=Ja.derivativeBasisFunctionsGivenNI(p,d,g,a,j),s=Ja.derivativeBasisFunctionsGivenNI(q,e,h,b,k),t=Da.zeros2d(h+1,m),u=0,v=0,w=l+1;w>v;){for(var x=v++,y=0,z=h+1;z>y;){var A=y++;t[A]=Da.zeros1d(m);for(var B=0,C=g+1;C>B;){var E=B++;Da.addMulMutate(t[A],r[x][E],i[p-g+E][q-h+A])}}var F=f-x;u=n>F?F:n;for(var G=0,H=u+1;H>G;){var I=G++;o[x][I]=Da.zeros1d(m);for(var J=0,K=h+1;K>J;){var L=J++;Da.addMulMutate(o[x][I],s[I][L],t[L])}}}return o},Ja.surfacePoint=function(a,b,c){var d=a.knotsU.length-a.degreeU-2,e=a.knotsV.length-a.degreeV-2;return Ja.surfacePointGivenNM(d,e,a,b,c)},Ja.surfacePointGivenNM=function(a,b,c,d,e){var f=c.degreeU,g=c.degreeV,h=c.controlPoints,i=c.knotsU,j=c.knotsV;if(!Ja.areValidRelations(f,h.length,i.length)||!Ja.areValidRelations(g,h[0].length,j.length))throw new D("Invalid relations between control points, knot vector, and n");for(var k=h[0][0].length,l=Ja.knotSpanGivenN(a,f,d,i),m=Ja.knotSpanGivenN(b,g,e,j),n=Ja.basisFunctionsGivenKnotSpanIndex(l,d,f,i),o=Ja.basisFunctionsGivenKnotSpanIndex(m,e,g,j),p=l-f,q=m,r=Da.zeros1d(k),s=Da.zeros1d(k),t=0,u=g+1;u>t;){var v=t++;s=Da.zeros1d(k),q=m-g+v;for(var w=0,x=f+1;x>w;){var y=w++;Da.addMulMutate(s,n[y],h[p+y][q])}Da.addMulMutate(r,o[v],s)}return r},Ja.rationalSurfaceRegularSampleDerivatives=function(a,b,c,d){for(var e=Ja.surfaceRegularSampleDerivatives(a,b,c,d),f=[],g=b+1,h=c+1,i=d+1,j=0;g>j;){var k=j++,l=[];f.push(l);for(var m=0;h>m;){for(var n=m++,o=e[k][n],p=Ja.rational2d(o),q=Ja.weight2d(o),r=[],s=p[0][0].length,t=0;i>t;){var u=t++;r.push([]);for(var v=0,w=i-u;w>v;){for(var x=v++,y=p[u][x],z=1,A=x+1;A>z;){var B=z++;Da.subMulMutate(y,R.get(x,B)*q[0][B],r[u][x-B])}for(var C=1,D=u+1;D>C;){var E=C++;Da.subMulMutate(y,R.get(u,E)*q[E][0],r[u-E][x]);for(var F=Da.zeros1d(s),G=1,H=x+1;H>G;){var I=G++;Da.addMulMutate(F,R.get(x,I)*q[E][I],r[u-E][x-I])}Da.subMulMutate(y,R.get(u,E),F)}Da.mulMutate(1/q[0][0],y),r[u].push(y)}}l.push(r)}}return f},Ja.surfaceRegularSampleDerivatives=function(a,b,c,d){for(var e=a.degreeU,f=a.degreeV,g=a.controlPoints,h=a.knotsU,i=a.knotsV,j=g[0][0].length,k=((Q.last(h)-h[0])/b,(Q.last(i)-i[0])/c,Ja.regularlySpacedDerivativeBasisFunctions(e,h,b)),l=k.item0,m=k.item1,n=Ja.regularlySpacedDerivativeBasisFunctions(f,i,c),o=n.item0,p=n.item1,q=[],r=b+1,s=c+1,t=0;r>t;){var u=t++,v=[];q.push(v);for(var w=0;s>w;){var x=w++;v.push(Ja.surfaceDerivativesGivenBasesKnotSpans(e,f,g,l[u],o[x],m[u],p[x],j,d))}}return q},Ja.regularlySpacedBasisFunctions=function(a,b,c){for(var d=b.length-a-2,e=(Q.last(b)-b[0])/c,f=[],g=[],h=b[0],i=Ja.knotSpanGivenN(d,a,h,b),j=c+1,k=0;j>k;){for(k++;h>=b[i+1];)i++;g.push(i),f.push(Ja.basisFunctionsGivenKnotSpanIndex(i,h,a,b)),h+=e}return new aa(g,f)},Ja.regularlySpacedDerivativeBasisFunctions=function(a,b,c){for(var d=b.length-a-2,e=(Q.last(b)-b[0])/c,f=[],g=[],h=b[0],i=Ja.knotSpanGivenN(d,a,h,b),j=c+1,k=0;j>k;){for(k++;h>=b[i+1];)i++;g.push(i),f.push(Ja.derivativeBasisFunctionsGivenNI(i,h,a,d,b)),h+=e}return new aa(g,f)},Ja.surfacePointGivenBasesKnotSpans=function(a,b,c,d,e,f,g,h){for(var i,j=Da.zeros1d(h),k=d-a,l=e-b,m=0,n=b+1;n>m;){var o=m++;i=Da.zeros1d(h);for(var p=0,q=a+1;q>p;){var r=p++;Da.addMulMutate(i,f[r],c[k+r][l])}l++,Da.addMulMutate(j,g[o],i)}return j},Ja.surfaceDerivativesGivenBasesKnotSpans=function(a,b,c,d,e,f,g,h,i){var j,k=c[0][0].length;j=a>i?i:a;var l;l=b>i?i:b;for(var m=Da.zeros3d(j+1,l+1,k),n=Da.zeros2d(b+1,k),o=0,p=0,q=j+1;q>p;){for(var r=p++,s=0,t=b+1;t>s;){var u=s++;n[u]=Da.zeros1d(k);for(var v=0,w=a+1;w>v;){var x=v++;Da.addMulMutate(n[u],f[r][x],c[d-a+x][e-b+u])}}var y=i-r;o=l>y?y:l;for(var z=0,A=o+1;A>z;){var B=z++;m[r][B]=Da.zeros1d(k);for(var C=0,D=b+1;D>C;){var E=C++;Da.addMulMutate(m[r][B],g[B][E],n[E])}}}return m},Ja.curveDerivatives=function(a,b,c){var d=a.knots.length-a.degree-2;return Ja.curveDerivativesGivenN(d,a,b,c)},Ja.curveDerivativesGivenN=function(a,b,c,d){var e=b.degree,f=b.controlPoints,g=b.knots;if(!Ja.areValidRelations(e,f.length,g.length))throw new D("Invalid relations between control points, knot vector, and n");var h,i=f[0].length;h=e>d?d:e;for(var j=Da.zeros2d(h+1,i),k=Ja.knotSpanGivenN(a,e,c,g),l=Ja.derivativeBasisFunctionsGivenNI(k,c,e,h,g),m=0,n=h+1;n>m;)for(var o=m++,p=0,q=e+1;q>p;){var r=p++;Da.addMulMutate(j[o],l[o][r],f[k-e+r])}return j},Ja.curvePoint=function(a,b){var c=a.knots.length-a.degree-2;return Ja.curvePointGivenN(c,a,b)},Ja.areValidRelations=function(a,b,c){return b+a+1-c==0},Ja.curvePointGivenN=function(a,b,c){var d=b.degree,e=b.controlPoints,f=b.knots;if(!Ja.areValidRelations(d,e.length,f.length))throw new D("Invalid relations between control points, knot Array, and n");for(var g=Ja.knotSpanGivenN(a,d,c,f),h=Ja.basisFunctionsGivenKnotSpanIndex(g,c,d,f),i=Da.zeros1d(e[0].length),j=0,k=d+1;k>j;){var l=j++;Da.addMulMutate(i,h[l],e[g-d+l])}return i},Ja.volumePoint=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2,g=a.knotsW.length-a.degreeW-2;return Ja.volumePointGivenNML(a,e,f,g,b,c,d)},Ja.volumePointGivenNML=function(a,b,c,d,e,f,g){if(!Ja.areValidRelations(a.degreeU,a.controlPoints.length,a.knotsU.length)||!Ja.areValidRelations(a.degreeV,a.controlPoints[0].length,a.knotsV.length)||!Ja.areValidRelations(a.degreeW,a.controlPoints[0][0].length,a.knotsW.length))throw new D("Invalid relations between control points and knot vector");for(var h=a.controlPoints,i=a.degreeU,j=a.degreeV,k=a.degreeW,l=a.knotsU,m=a.knotsV,n=a.knotsW,o=h[0][0][0].length,p=Ja.knotSpanGivenN(b,i,e,l),q=Ja.knotSpanGivenN(c,j,f,m),r=Ja.knotSpanGivenN(d,k,g,n),s=Ja.basisFunctionsGivenKnotSpanIndex(p,e,i,l),t=Ja.basisFunctionsGivenKnotSpanIndex(q,f,j,m),u=Ja.basisFunctionsGivenKnotSpanIndex(r,g,k,n),v=p-i,w=Da.zeros1d(o),x=Da.zeros1d(o),y=Da.zeros1d(o),z=0,A=k+1;A>z;){var B=z++;y=Da.zeros1d(o);for(var C=r-k+B,E=0,F=j+1;F>E;){var G=E++;x=Da.zeros1d(o);for(var H=q-j+G,I=0,J=i+1;J>I;){var K=I++;Da.addMulMutate(x,s[K],h[v+K][H][C])}Da.addMulMutate(y,t[G],x)}Da.addMulMutate(w,u[B],y)}return w},Ja.derivativeBasisFunctions=function(a,b,c){var d=Ja.knotSpan(b,a,c),e=c.length-1,f=e-b-1;return Ja.derivativeBasisFunctionsGivenNI(d,a,b,f,c)},Ja.derivativeBasisFunctionsGivenNI=function(a,b,c,d,e){var f=Da.zeros2d(c+1,c+1),g=Da.zeros1d(c+1),h=Da.zeros1d(c+1),i=0,j=0;f[0][0]=1;for(var k=1,l=c+1;l>k;){var m=k++;g[m]=b-e[a+1-m],h[m]=e[a+m]-b,i=0;for(var n=0;m>n;){var o=n++;f[m][o]=h[o+1]+g[m-o],j=f[o][m-1]/f[m][o],f[o][m]=i+h[o+1]*j,i=g[m-o]*j}f[m][m]=i}for(var p=Da.zeros2d(d+1,c+1),q=Da.zeros2d(2,c+1),r=0,s=1,t=0,u=0,v=0,w=0,x=0,y=0,z=c+1;z>y;){var A=y++;p[0][A]=f[A][c]}for(var B=0,C=c+1;C>B;){var D=B++;r=0,s=1,q[0][0]=1;for(var E=1,F=d+1;F>E;){var G=E++;t=0,u=D-G,v=c-G,D>=G&&(q[s][0]=q[r][0]/f[v+1][u],t=q[s][0]*f[u][v]),w=u>=-1?1:-u,x=v>=D-1?G-1:c-D;for(var H=w,I=x+1;I>H;){var J=H++;q[s][J]=(q[r][J]-q[r][J-1])/f[v+1][u+J],t+=q[s][J]*f[u+J][v]}v>=D&&(q[s][G]=-q[r][G-1]/f[v+1][D],t+=q[s][G]*f[D][v]),p[G][D]=t;var K=r;r=s,s=K}}for(var L=c,M=1,N=d+1;N>M;){for(var O=M++,P=0,Q=c+1;Q>P;){var R=P++;p[O][R]*=L}L*=c-O}return p},Ja.basisFunctions=function(a,b,c){var d=Ja.knotSpan(b,a,c);return Ja.basisFunctionsGivenKnotSpanIndex(d,a,b,c)},Ja.basisFunctionsGivenKnotSpanIndex=function(a,b,c,d){var e=Da.zeros1d(c+1),f=Da.zeros1d(c+1),g=Da.zeros1d(c+1),h=0,i=0;e[0]=1;for(var j=1,k=c+1;k>j;){var l=j++;f[l]=b-d[a+1-l],g[l]=d[a+l]-b,h=0;for(var m=0;l>m;){var n=m++;i=e[n]/(g[n+1]+f[l-n]),e[n]=h+g[n+1]*i,h=f[l-n]*i}e[l]=h}return e},Ja.knotSpan=function(a,b,c){return Ja.knotSpanGivenN(c.length-a-2,a,b,c)},Ja.knotSpanGivenN=function(a,b,c,d){if(c>d[a+1]-T.EPSILON)return a;if(c<d[b]+T.EPSILON)return b;for(var e=b,f=a+1,g=Math.floor((e+f)/2);c<d[g]||c>=d[g+1];)c<d[g]?f=g:e=g,g=Math.floor((e+f)/2);return g},Ja.dehomogenize=function(a){for(var b=a.length,c=[],d=a[b-1],e=a.length-1,f=0;e>f;){var g=f++;c.push(a[g]/d)}return c},Ja.rational1d=function(a){var b=a[0].length-1;return a.map(function(a){return a.slice(0,b)})},Ja.rational2d=function(a){return a.map(Ja.rational1d)},Ja.weight1d=function(a){var b=a[0].length-1;return a.map(function(a){return a[b]})},Ja.weight2d=function(a){return a.map(Ja.weight1d)},Ja.dehomogenize1d=function(a){return a.map(Ja.dehomogenize)},Ja.dehomogenize2d=function(a){return a.map(Ja.dehomogenize1d)},Ja.homogenize1d=function(a,b){var c,d=a.length,e=a[0].length,f=[],g=0,h=[];c=null!=b?b:Da.rep(a.length,1);for(var i=0;d>i;){var j=i++,k=[];h=a[j],g=c[j];for(var l=0;e>l;){var m=l++;k.push(h[m]*g)}k.push(g),f.push(k)}return f},Ja.homogenize2d=function(a,b){var c,d=a.length,e=[];if(null!=b)c=b;else{for(var f=[],g=0;d>g;){g++;f.push(Da.rep(a[0].length,1))}c=f}for(var h=0;d>h;){var i=h++;e.push(Ja.homogenize1d(a[i],c[i]))}return e};var Ka=b.eval.Intersect=function(){};g["verb.eval.Intersect"]=Ka,Ka.__name__=["verb","eval","Intersect"],Ka.surfaces=function(a,b,c){var d=Qa.rationalSurfaceAdaptive(a),e=Qa.rationalSurfaceAdaptive(b),f=Ka.meshes(d,e),g=f.map(function(d){return d.map(function(d){return Ka.surfacesAtPointWithEstimate(a,b,d.uv0,d.uv1,c)})});return g.map(function(a){return La.rationalInterpCurve(a.map(function(a){return a.point}),3)})},Ka.surfacesAtPointWithEstimate=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=5,t=0;do{if(f=Ja.rationalSurfaceDerivatives(a,c[0],c[1],1),g=f[0][0],i=f[1][0],j=f[0][1],h=Da.normalized(Da.cross(i,j)),k=Da.dot(h,g),l=Ja.rationalSurfaceDerivatives(b,d[0],d[1],1),m=l[0][0],o=l[1][0],p=l[0][1],n=Da.normalized(Da.cross(o,p)),q=Da.dot(n,m),r=Da.distSquared(g,m),e*e>r)break;var u=Da.normalized(Da.cross(h,n)),v=Da.dot(u,g),w=Ka.threePlanes(h,k,n,q,u,v);if(null==w)throw new D("panic!");var x=Da.sub(w,g),y=Da.sub(w,m),z=Da.cross(i,h),A=Da.cross(j,h),B=Da.cross(o,n),C=Da.cross(p,n),E=Da.dot(A,x)/Da.dot(A,i),F=Da.dot(z,x)/Da.dot(z,j),G=Da.dot(C,y)/Da.dot(C,o),H=Da.dot(B,y)/Da.dot(B,p);c=Da.add([E,F],c),d=Da.add([G,H],d),t++}while(s>t);return new ga(c,d,g,r)},Ka.meshes=function(a,b,c,d){null==c&&(c=new ra(a)),null==d&&(d=new ra(b));var e=Ka.boundingBoxTrees(c,d,0),f=Q.unique(e.map(function(c){return Ka.triangles(a,c.item0,b,c.item1)}).filter(function(a){return null!=a}).filter(function(a){return Da.distSquared(a.min.point,a.max.point)>T.EPSILON}),function(a,b){var c=Da.sub(a.min.uv0,b.min.uv0),d=Da.dot(c,c),e=Da.sub(a.max.uv0,b.max.uv0),f=Da.dot(e,e),g=Da.sub(a.min.uv0,b.max.uv0),h=Da.dot(g,g),i=Da.sub(a.max.uv0,b.min.uv0),j=Da.dot(i,i);return d<T.EPSILON&&f<T.EPSILON||h<T.EPSILON&&j<T.EPSILON});return Ka.makeMeshIntersectionPolylines(f)},Ka.meshSlices=function(a,b,c,d){for(var e=new xa(a),f=e.boundingBox(),g=f.min[0],h=f.min[1],i=f.max[0],j=f.max[1],k=Da.span(b,c,d),l=[],m=0;m<k.length;){var n=k[m];++m;var o=[[g,h,n],[i,h,n],[i,j,n],[g,j,n]],p=[[0,0],[1,0],[1,1],[0,1]],q=[[0,1,2],[0,2,3]],r=new Z(q,o,null,p);l.push(Ka.meshes(a,r,e))}return l},Ka.makeMeshIntersectionPolylines=function(a){if(0==a.length)return[];for(var b=0;b<a.length;){var c=a[b];++b,c.max.opp=c.min,c.min.opp=c.max}for(var d=Ka.kdTreeFromSegments(a),e=[],f=0;f<a.length;){var g=a[f];++f,e.push(g.min),e.push(g.max)}for(var h=0;h<e.length;){var i=e[h];if(++h,null==i.adj){var j=Ka.lookupAdjacentSegment(i,d,a.length);null!=j&&null==j.adj&&(i.adj=j,j.adj=i)}}var k=e.filter(function(a){return null==a.adj});0==k.length&&(k=e);for(var l=[],m=0,n=!1;0!=k.length;){var o=k.pop();if(!o.visited){for(var p=[],q=o;null!=q&&!q.visited&&(q.visited=!0,q.opp.visited=!0,p.push(q),m+=2,q=q.opp.adj,q!=o););p.length>0&&(p.push(p[p.length-1].opp),l.push(p))}if(0==k.length&&e.length>0&&(n||m<e.length)){n=!0;var r=e.pop();k.push(r)}}return l},Ka.kdTreeFromSegments=function(a){for(var b=[],c=0;c<a.length;){var d=a[c];++c,b.push(new na(d.min.point,d.min)),b.push(new na(d.max.point,d.max))}return new la(b,Da.distSquared)},Ka.lookupAdjacentSegment=function(a,b,c){var d=b.nearest(a.point,c,T.EPSILON).filter(function(b){return a!=b.item0.obj}).map(function(a){return a.item0.obj});return 1==d.length?d[0]:null},Ka.curveAndSurface=function(a,b,c,d,e){null==c&&(c=.001),d=null!=d?d:new qa(a),e=null!=e?e:new ta(b);var f=Ka.boundingBoxTrees(d,e,c);return Q.unique(f.map(function(a){var b=a.item0,d=a.item1,e=Q.first(b.knots),f=Q.last(b.knots),g=(e+f)/2,h=Q.first(d.knotsU),i=Q.last(d.knotsU),j=Q.first(d.knotsV),k=Q.last(d.knotsV),l=[(h+i)/2,(j+k)/2];return Ka.curveAndSurfaceWithEstimate(b,d,[g].concat(l),c)}).filter(function(a){return Da.distSquared(a.curvePoint,a.surfacePoint)<c*c}),function(a,b){return Math.abs(a.u-b.u)<.5*c})},Ka.curveAndSurfaceWithEstimate=function(a,b,c,d){null==d&&(d=.001);var e=function(c){var d=Ja.rationalCurvePoint(a,c[0]),e=Ja.rationalSurfacePoint(b,c[1],c[2]),f=Da.sub(d,e);return Da.dot(f,f)},f=function(c){var d=Ja.rationalCurveDerivatives(a,c[0],1),e=Ja.rationalSurfaceDerivatives(b,c[1],c[2],1),f=Da.sub(e[0][0],d[0]),g=Da.mul(-1,d[1]),h=e[1][0],i=e[0][1];return[2*Da.dot(g,f),2*Da.dot(h,f),2*Da.dot(i,f)]},g=ya.uncmin(e,c,d*d,f),h=g.solution;return new da(h[0],[h[1],h[2]],Ja.rationalCurvePoint(a,h[0]),Ja.rationalSurfacePoint(b,h[1],h[2]))},Ka.polylineAndMesh=function(a,b,c){for(var d=Ka.boundingBoxTrees(new sa(a),new ra(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ka.segmentWithTriangle(a.points[h],a.points[h+1],b.points,b.faces[i]);if(null!=j){var k=j.point,l=Da.lerp(j.p,[a.params[h]],[a.params[h+1]])[0],m=wa.triangleUVFromPoint(b,i,k);e.push(new fa(k,l,m,h,i))}}return e},Ka.boundingBoxTrees=function(a,b,c){null==c&&(c=1e-9);var d=[],e=[];d.push(a),e.push(b);for(var f=[];d.length>0;){var g=d.pop(),h=e.pop();if(!g.empty()&&!h.empty()&&g.boundingBox().intersects(h.boundingBox(),c)){var i=g.indivisible(c),j=h.indivisible(c);if(i&&j)f.push(new aa(g["yield"](),h["yield"]()));else if(!i||j)if(i||!j){var k=g.split(),l=h.split();d.push(k.item1),e.push(l.item1),d.push(k.item1),e.push(l.item0),d.push(k.item0),e.push(l.item1),d.push(k.item0),e.push(l.item0)}else{var m=g.split();d.push(m.item1),e.push(h),d.push(m.item0),e.push(h)}else{var n=h.split();d.push(g),e.push(n.item1),d.push(g),e.push(n.item0)}}}return f},Ka.curves=function(a,b,c){var d=Ka.boundingBoxTrees(new qa(a),new qa(b),0);return Q.unique(d.map(function(d){return Ka.curvesWithEstimate(a,b,Q.first(d.item0.knots),Q.first(d.item1.knots),c)}).filter(function(a){return Da.distSquared(a.point0,a.point1)<c}),function(a,b){return Math.abs(a.u0-b.u0)<5*c})},Ka.curvesWithEstimate=function(a,b,c,d,e){var f=function(c){var d=Ja.rationalCurvePoint(a,c[0]),e=Ja.rationalCurvePoint(b,c[1]),f=Da.sub(d,e);return Da.dot(f,f)},g=function(c){var d=Ja.rationalCurveDerivatives(a,c[0],1),e=Ja.rationalCurveDerivatives(b,c[1],1),f=Da.sub(d[0],e[0]),g=d[1],h=Da.mul(-1,e[1]);return[2*Da.dot(g,f),2*Da.dot(h,f)]},h=ya.uncmin(f,[c,d],e*e,g),i=h.solution[0],j=h.solution[1],k=Ja.rationalCurvePoint(a,i),l=Ja.rationalCurvePoint(b,j);return new ca(k,l,i,j)},Ka.triangles=function(a,b,c,d){var e=a.faces[b],f=c.faces[d],g=wa.getTriangleNorm(a.points,e),h=wa.getTriangleNorm(c.points,f),i=a.points[e[0]],j=c.points[f[0]],k=Ka.planes(i,g,j,h);if(null==k)return null;var l=Ka.clipRayInCoplanarTriangle(k,a,b);if(null==l)return null;var m=Ka.clipRayInCoplanarTriangle(k,c,d);if(null==m)return null;var n=Ka.mergeTriangleClipIntervals(l,m,a,b,c,d);return null==n?null:new ba(new ea(n.min.uv0,n.min.uv1,n.min.point,b,d),new ea(n.max.uv0,n.max.uv1,n.max.point,b,d))},Ka.clipRayInCoplanarTriangle=function(a,b,c){for(var d=b.faces[c],e=[b.points[d[0]],b.points[d[1]],b.points[d[2]]],f=[b.uvs[d[0]],b.uvs[d[1]],b.uvs[d[2]]],g=[Da.sub(f[1],f[0]),Da.sub(f[2],f[1]),Da.sub(f[0],f[2])],h=[Da.sub(e[1],e[0]),Da.sub(e[2],e[1]),Da.sub(e[0],e[2])],i=h.map(Da.normalized),j=h.map(Da.norm),k=null,l=null,m=0;3>m;){var n=m++,o=e[n],p=i[n],q=Ka.rays(o,p,a.origin,a.dir);if(null!=q){var r=q.u0,s=q.u1;r<-T.EPSILON||r>j[n]+T.EPSILON||((null==k||s<k.u)&&(k=new ia(s,Da.onRay(a.origin,a.dir,s),Da.onRay(f[n],g[n],r/j[n]))),(null==l||s>l.u)&&(l=new ia(s,Da.onRay(a.origin,a.dir,s),Da.onRay(f[n],g[n],r/j[n]))))}}return null==l||null==k?null:new ba(k,l)},Ka.mergeTriangleClipIntervals=function(a,b,c,d,e,f){if(b.min.u>a.max.u+T.EPSILON||a.min.u>b.max.u+T.EPSILON)return null;var g;g=a.min.u>b.min.u?new aa(a.min,0):new aa(b.min,1);var h;h=a.max.u<b.max.u?new aa(a.max,0):new aa(b.max,1);var i=new ba(new ea(null,null,g.item0.point,d,f),new ea(null,null,h.item0.point,d,f));return 0==g.item1?(i.min.uv0=g.item0.uv,i.min.uv1=wa.triangleUVFromPoint(e,f,g.item0.point)):(i.min.uv0=wa.triangleUVFromPoint(c,d,g.item0.point),i.min.uv1=g.item0.uv),0==h.item1?(i.max.uv0=h.item0.uv,i.max.uv1=wa.triangleUVFromPoint(e,f,h.item0.point)):(i.max.uv0=wa.triangleUVFromPoint(c,d,h.item0.point),i.max.uv1=h.item0.uv),i},Ka.planes=function(a,b,c,d){var e=Da.cross(b,d);if(Da.dot(e,e)<T.EPSILON)return null;var f=0,g=Math.abs(e[0]),h=Math.abs(e[1]),i=Math.abs(e[2]);h>g&&(f=1,g=h),i>g&&(f=2,g=i);var j,k,l,m;0==f?(j=b[1],k=b[2],l=d[1],m=d[2]):1==f?(j=b[0],k=b[2],l=d[0],m=d[2]):(j=b[0],k=b[1],l=d[0],m=d[1]);var n,o=-Da.dot(a,b),p=-Da.dot(c,d),q=j*m-k*l,r=(k*p-o*m)/q,s=(o*l-j*p)/q;return n=0==f?[0,r,s]:1==f?[r,0,s]:[r,s,0],new W(n,Da.normalized(e))},Ka.threePlanes=function(a,b,c,d,e,f){var g=Da.cross(c,e),h=Da.dot(a,g);if(Math.abs(h)<T.EPSILON)return null;var i=Da.sub(Da.mul(f,c),Da.mul(d,e)),j=Da.add(Da.mul(b,g),Da.cross(a,i));return Da.mul(1/h,j)},Ka.polylines=function(a,b,c){for(var d=Ka.boundingBoxTrees(new sa(a),new sa(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ka.segments(a.points[h],a.points[h+1],b.points[i],b.points[i+1],c);null!=j&&(j.u0=Da.lerp(j.u0,[a.params[h]],[a.params[h+1]])[0],j.u1=Da.lerp(j.u1,[b.params[i]],[b.params[i+1]])[0],e.push(j))}return e},Ka.segments=function(a,b,c,d,e){var f=Da.sub(b,a),g=Math.sqrt(Da.dot(f,f)),h=Da.mul(1/g,f),i=Da.sub(d,c),j=Math.sqrt(Da.dot(i,i)),k=Da.mul(1/j,i),l=Ka.rays(a,h,c,k);if(null!=l){var m=Math.min(Math.max(0,l.u0/g),1),n=Math.min(Math.max(0,l.u1/j),1),o=Da.onRay(a,f,m),p=Da.onRay(c,i,n),q=Da.distSquared(o,p);if(e*e>q)return new ca(o,p,m,n)}return null},Ka.rays=function(a,b,c,d){var e=Da.dot(b,d),f=Da.dot(b,c),g=Da.dot(b,a),h=Da.dot(d,c),i=Da.dot(d,a),j=Da.dot(b,b),k=Da.dot(d,d),l=j*k-e*e;if(Math.abs(l)<T.EPSILON)return null;var m=e*(f-g)-j*(h-i),n=m/l,o=(f-g+n*e)/j,p=Da.onRay(a,b,o),q=Da.onRay(c,d,n);return new ca(p,q,o,n)},Ka.segmentWithTriangle=function(a,b,c,d){var e=c[d[0]],f=c[d[1]],g=c[d[2]],h=Da.sub(f,e),i=Da.sub(g,e),j=Da.cross(h,i),k=Da.sub(b,a),l=Da.sub(a,e),m=-Da.dot(j,l),n=Da.dot(j,k);if(Math.abs(n)<T.EPSILON)return null;var o=m/n;if(0>o||o>1)return null;var p=Da.add(a,Da.mul(o,k)),q=Da.dot(h,i),r=Da.dot(h,h),s=Da.dot(i,i),t=Da.sub(p,e),u=Da.dot(t,h),v=Da.dot(t,i),w=q*q-r*s;if(Math.abs(w)<T.EPSILON)return null;var x=(q*v-s*u)/w,y=(q*u-r*v)/w;return x>1+T.EPSILON||y>1+T.EPSILON||y<-T.EPSILON||x<-T.EPSILON||x+y>1+T.EPSILON?null:new ha(p,x,y,o)},Ka.segmentAndPlane=function(a,b,c,d){var e=Da.dot(d,Da.sub(b,a));if(Math.abs(e)<T.EPSILON)return null;var f=Da.dot(d,Da.sub(c,a)),g=f/e;return g>1+T.EPSILON||g<-T.EPSILON?null:{p:g}};var La=b.eval.Make=function(){};g["verb.eval.Make"]=La,La.__name__=["verb","eval","Make"],La.rationalTranslationalSurface=function(a,b){for(var c=Ja.rationalCurvePoint(b,Q.first(b.knots)),d=Q.first(b.knots),e=Q.last(b.knots),f=2*b.controlPoints.length,g=(e-d)/(f-1),h=[],i=0;f>i;){var j=i++,k=Da.sub(Ja.rationalCurvePoint(b,d+j*g),c),l=Ma.rationalCurveTransform(a,[[1,0,0,k[0]],[0,1,0,k[1]],[0,0,1,k[2]],[0,0,0,1]]);h.push(l)}return La.loftedSurface(h)},La.surfaceBoundaryCurves=function(a){var b=La.surfaceIsocurve(a,Q.first(a.knotsU),!1),c=La.surfaceIsocurve(a,Q.last(a.knotsU),!1),d=La.surfaceIsocurve(a,Q.first(a.knotsV),!0),e=La.surfaceIsocurve(a,Q.last(a.knotsV),!0);return[b,c,d,e]},La.surfaceIsocurve=function(a,b,c){null==c&&(c=!1);var d;d=c?a.knotsV:a.knotsU;var e;e=c?a.degreeV:a.degreeU;for(var f=Ea.knotMultiplicities(d),g=-1,h=0,i=f.length;i>h;){var j=h++;if(Math.abs(b-f[j].knot)<T.EPSILON){g=j;break}}var k=e+1;g>=0&&(k-=f[g].mult);var l;l=k>0?Ma.surfaceKnotRefine(a,Da.rep(k,b),c):a;var m=Ja.knotSpan(e,b,d);return Math.abs(b-Q.first(d))<T.EPSILON?m=0:Math.abs(b-Q.last(d))<T.EPSILON&&(m=(c?l.controlPoints[0].length:l.controlPoints.length)-1),c?new X(l.degreeU,l.knotsU,function(a){for(var b,c=[],d=0,e=l.controlPoints;d<e.length;){var f=e[d];++d,c.push(f[m])}return b=c}(this)):new X(l.degreeV,l.knotsV,l.controlPoints[m])},La.loftedSurface=function(a,b){a=Ma.unifyCurveKnotVectors(a);var c=a[0].degree;null==b&&(b=3),b>a.length-1&&(b=a.length-1);for(var d=a[0].knots,e=[],f=[],g=0,h=a[0].controlPoints.length;h>g;){var i=[g++],j=a.map(function(a){return function(b){return b.controlPoints[a[0]]}}(i)),k=La.rationalInterpCurve(j,b,!0);f.push(k.controlPoints),e=k.knots}return new Y(c,b,d,e,f)},La.clonedCurve=function(a){return new X(a.degree,a.knots.slice(),a.controlPoints.map(function(a){return a.slice()}))},La.clonedSurface=function(a){for(var b,c=[],d=0,e=a.controlPoints;d<e.length;){var f=e[d];++d,b=[],c.push(b);for(var g=0;g<f.length;){var h=f[g];++g,b.push(h.slice())}}return new Y(a.degreeU,a.degreeV,a.knotsU.slice(),a.knotsV.slice(),c)},La.rationalBezierCurve=function(a,b){for(var c=a.length-1,d=[],e=0,f=c+1;f>e;){e++;d.push(0)}for(var g=0,h=c+1;h>g;){g++;d.push(1)}return null==b&&(b=Da.rep(a.length,1)),new X(c,d,Ja.homogenize1d(a,b))},La.fourPointSurface=function(a,b,c,d,e){null==e&&(e=3);for(var f=e,g=[],h=0,i=e+1;i>h;){for(var j=h++,k=[],l=0,m=e+1;m>l;){var n=l++,o=1-j/f,p=Da.lerp(o,a,b),q=Da.lerp(o,d,c),r=Da.lerp(1-n/f,p,q);r.push(1),k.push(r)}g.push(k)}var s=Da.rep(e+1,0),t=Da.rep(e+1,1);return new Y(e,e,s.concat(t),s.concat(t),g)},La.ellipseArc=function(a,b,c,d,e){var f=Da.norm(b),g=Da.norm(c);b=Da.normalized(b),c=Da.normalized(c),d>e&&(e=2*Math.PI+d);var h=e-d,i=0;i=h<=Math.PI/2?1:h<=Math.PI?2:h<=3*Math.PI/2?3:4;var j=h/i,k=Math.cos(j/2),l=Da.add(a,Da.add(Da.mul(f*Math.cos(d),b),Da.mul(g*Math.sin(d),c))),m=Da.sub(Da.mul(Math.cos(d),c),Da.mul(Math.sin(d),b)),n=[],o=Da.zeros1d(2*i+3),p=0,q=d,r=Da.zeros1d(2*i);n[0]=l,r[0]=1;for(var s=1,t=i+1;t>s;){var u=s++;q+=j;var v=Da.add(a,Da.add(Da.mul(f*Math.cos(q),b),Da.mul(g*Math.sin(q),c)));r[p+2]=1,n[p+2]=v;var w=Da.sub(Da.mul(Math.cos(q),c),Da.mul(Math.sin(q),b)),x=Ka.rays(l,Da.mul(1/Da.norm(m),m),v,Da.mul(1/Da.norm(w),w)),y=Da.add(l,Da.mul(x.u0,m));r[p+1]=k,n[p+1]=y,p+=2,i>u&&(l=v,m=w)}for(var z=2*i+1,A=0;3>A;){var B=A++;o[B]=0,o[B+z]=1}switch(i){case 2:o[3]=o[4]=.5;break;case 3:o[3]=o[4]=.3333333333333333,o[5]=o[6]=.6666666666666666;break;case 4:o[3]=o[4]=.25,o[5]=o[6]=.5,o[7]=o[8]=.75}return new X(2,o,Ja.homogenize1d(n,r))},La.arc=function(a,b,c,d,e,f){return La.ellipseArc(a,Da.mul(d,Da.normalized(b)),Da.mul(d,Da.normalized(c)),e,f)},La.polyline=function(a){for(var b=[0,0],c=0,d=0,e=a.length-1;e>d;){var f=d++;c+=Da.dist(a[f],a[f+1]),b.push(c)}b.push(c),b=Da.mul(1/c,b);for(var g,h=[],i=0,j=a.length;j>i;){i++;h.push(1)}return g=h,new X(1,b,Ja.homogenize1d(a.slice(0),g))},La.extrudedSurface=function(a,b,c){for(var d=[[],[],[]],e=[[],[],[]],f=Ja.dehomogenize1d(c.controlPoints),g=Ja.weight1d(c.controlPoints),h=Da.mul(b,a),i=Da.mul(.5*b,a),j=0,k=f.length;k>j;){var l=j++;d[2][l]=f[l],d[1][l]=Da.add(i,f[l]),d[0][l]=Da.add(h,f[l]),e[0][l]=g[l],e[1][l]=g[l],e[2][l]=g[l]}return new Y(2,c.degree,[0,0,0,1,1,1],c.knots,Ja.homogenize2d(d,e))},La.cylindricalSurface=function(a,b,c,d,e){var f=Da.cross(a,b),g=(2*Math.PI,La.arc(c,b,f,e,0,2*Math.PI));return La.extrudedSurface(a,d,g)},La.revolvedSurface=function(a,b,c,d){var e,f,g=Ja.dehomogenize1d(a.controlPoints),h=Ja.weight1d(a.controlPoints);d<=Math.PI/2?(e=1,f=Da.zeros1d(6+2*(e-1))):d<=Math.PI?(e=2,f=Da.zeros1d(6+2*(e-1)),f[3]=f[4]=.5):d<=3*Math.PI/2?(e=3,f=Da.zeros1d(6+2*(e-1)),f[3]=f[4]=.3333333333333333,f[5]=f[6]=.6666666666666666):(e=4,f=Da.zeros1d(6+2*(e-1)),f[3]=f[4]=.25,f[5]=f[6]=.5,f[7]=f[8]=.75);for(var i=d/e,j=3+2*(e-1),k=0;3>k;){var l=k++;f[l]=0,f[j+l]=1}for(var m=Math.cos(i/2),n=0,o=Da.zeros1d(e+1),p=Da.zeros1d(e+1),q=Da.zeros3d(2*e+1,g.length,3),r=Da.zeros2d(2*e+1,g.length),s=1,t=e+1;t>s;){var u=s++;n+=i,p[u]=Math.cos(n),o[u]=Math.sin(n)}for(var v=0,w=g.length;w>v;){var x=v++,y=Ca.rayClosestPoint(g[x],b,c),z=Da.sub(g[x],y),A=Da.norm(z),B=Da.cross(c,z);A>T.EPSILON&&(z=Da.mul(1/A,z),B=Da.mul(1/A,B)),q[0][x]=g[x];var C=g[x];r[0][x]=h[x];for(var D=B,E=0,F=1,G=e+1;G>F;){var H,I=F++;H=0==A?y:Da.add(y,Da.add(Da.mul(A*p[I],z),Da.mul(A*o[I],B))),q[E+2][x]=H,r[E+2][x]=h[x];var J=Da.sub(Da.mul(p[I],B),Da.mul(o[I],z));if(0==A)q[E+1][x]=y;else{var K=Ka.rays(C,Da.mul(1/Da.norm(D),D),H,Da.mul(1/Da.norm(J),J)),L=Da.add(C,Da.mul(K.u0,D));q[E+1][x]=L}r[E+1][x]=m*h[x],E+=2,e>I&&(C=H,D=J)}}return new Y(2,a.degree,f,a.knots,Ja.homogenize2d(q,r))},La.sphericalSurface=function(a,b,c,d){var e=La.arc(a,Da.mul(-1,b),c,d,0,Math.PI);return La.revolvedSurface(e,a,b,2*Math.PI)},La.conicalSurface=function(a,b,c,d,e){var f=2*Math.PI,g=1,h=[Da.add(c,Da.mul(d,a)),Da.add(c,Da.mul(e,b))],i=[0,0,1,1],j=[1,1],k=new X(g,i,Ja.homogenize1d(h,j));return La.revolvedSurface(k,c,a,f)},La.rationalInterpCurve=function(a,b,c,d,e){if(null==c&&(c=!1),null==b&&(b=3),a.length<b+1)throw new D("You need to supply at least degree + 1 points! You only supplied "+a.length+" points.");for(var f=[0],g=1,h=a.length;h>g;){var i=g++,j=Da.norm(Da.sub(a[i],a[i-1])),k=f[f.length-1];f.push(k+j)}for(var l=f[f.length-1],m=0,n=f.length;n>m;){var o=m++;f[o]=f[o]/l}var p,q=Da.rep(b+1,0),r=null!=d&&null!=e;p=r?0:1;var s;s=r?f.length-b+1:f.length-b;for(var t=p;s>t;){for(var u=t++,v=0,w=0;b>w;){var x=w++;v+=f[u+x]}q.push(1/b*v)}var y,z=q.concat(Da.rep(b+1,1)),A=[];y=r?a.length+1:a.length-1;var B;B=r?1:0;var C;C=r?a.length-(b-1):a.length-(b+1);for(var E=0;E<f.length;){var F=f[E];++E;var G=Ja.knotSpanGivenN(y,b,F,z),H=Ja.basisFunctionsGivenKnotSpanIndex(G,F,b,z),I=G-b,J=Da.zeros1d(I),K=Da.zeros1d(C-I);A.push(J.concat(H).concat(K))}if(r){var L=A[0].length-2,M=[-1,1].concat(Da.zeros1d(L)),N=Da.zeros1d(L).concat([-1,1]);Q.spliceAndInsert(A,1,0,M),Q.spliceAndInsert(A,A.length-1,0,N)}for(var O=a[0].length,P=[],R=(1-z[z.length-b-2])/b,S=z[b+1]/b,T=0;O>T;){var U,V=[T++];if(r){U=[a[0][V[0]]],U.push(S*d[V[0]]);for(var W=1,Y=a.length-1;Y>W;){var Z=W++;U.push(a[Z][V[0]])}U.push(R*e[V[0]]),U.push(Q.last(a)[V[0]]);
}else U=a.map(function(a){return function(b){return b[a[0]]}}(V));var $=ua.solve(A,U);P.push($)}var _=ua.transpose(P);if(!c){var aa=Da.rep(_.length,1);_=Ja.homogenize1d(_,aa)}return new X(b,z,_)};var Ma=b.eval.Modify=function(){};g["verb.eval.Modify"]=Ma,Ma.__name__=["verb","eval","Modify"],Ma.curveReverse=function(a){return new X(a.degree,Ma.knotsReverse(a.knots),Q.reversed(a.controlPoints))},Ma.surfaceReverse=function(a,b){return null==b&&(b=!1),b?new Y(a.degreeU,a.degreeV,a.knotsU,Ma.knotsReverse(a.knotsV),function(b){for(var c,d=[],e=0,f=a.controlPoints;e<f.length;){var g=f[e];++e,d.push(Q.reversed(g))}return c=d}(this)):new Y(a.degreeU,a.degreeV,Ma.knotsReverse(a.knotsU),a.knotsV,Q.reversed(a.controlPoints))},Ma.knotsReverse=function(a){for(var b=Q.first(a),c=(Q.last(a),[b]),d=a.length,e=1;d>e;){var f=e++;c.push(c[f-1]+(a[d-f]-a[d-f-1]))}return c},Ma.unifyCurveKnotVectors=function(a){a=a.map(La.clonedCurve);for(var b=j.fold(a,function(a,b){return Ma.imax(a.degree,b)},0),c=0,d=a.length;d>c;){var e=c++;a[e].degree<b&&(a[e]=Ma.curveElevateDegree(a[e],b))}for(var f,g=[],h=0;h<a.length;){var i=a[h];++h,g.push(new ba(Q.first(i.knots),Q.last(i.knots)))}f=g;for(var k=0,l=a.length;l>k;){var m=k++,n=[f[m].min];a[m].knots=a[m].knots.map(function(a){return function(b){return b-a[0]}}(n))}for(var o=f.map(function(a){return a.max-a.min}),p=j.fold(o,function(a,b){return Math.max(a,b)},0),q=0,r=a.length;r>q;){var s=q++,t=[p/o[s]];a[s].knots=a[s].knots.map(function(a){return function(b){return b*a[0]}}(t))}for(var u=j.fold(a,function(a,b){return Da.sortedSetUnion(a.knots,b)},[]),v=0,w=a.length;w>v;){var x=v++,y=Da.sortedSetSub(u,a[x].knots);0==y.length&&(a[x]=a[x]),a[x]=Ma.curveKnotRefine(a[x],y)}return a},Ma.imin=function(a,b){return b>a?a:b},Ma.imax=function(a,b){return a>b?a:b},Ma.curveElevateDegree=function(a,b){if(b<=a.degree)return a;var c,d=a.knots.length-a.degree-2,e=a.degree,f=a.knots,g=a.controlPoints,h=b-a.degree,i=a.controlPoints[0].length,j=Da.zeros2d(e+h+1,e+1),k=[],l=[],m=[],n=d+e+1,o=b,p=Math.floor(o/2),q=[],r=[];j[0][0]=1,j[o][e]=1;for(var s=1,t=p+1;t>s;)for(var u=s++,v=1/R.get(o,u),w=Ma.imin(e,u),x=Ma.imax(0,u-h),y=w+1;y>x;){var z=x++;j[u][z]=v*R.get(e,z)*R.get(h,u-z)}for(var A=p+1;o>A;)for(var B=A++,C=Ma.imin(e,B),D=Ma.imax(0,B-h),E=C+1;E>D;){var F=D++;j[B][F]=j[o-B][e-F]}var G=o,H=o+1,I=-1,J=e,K=e+1,L=1,M=f[0];q[0]=g[0];for(var N=0,O=o+1;O>N;){var P=N++;r[P]=M}for(var Q=0,S=e+1;S>Q;){var T=Q++;k[T]=g[T]}for(;n>K;){for(var U=K;n>K&&f[K]==f[K+1];)K+=1;var V=K-U+1,W=f[K],Y=I;I=e-V;var Z;Z=Y>0?Math.floor((Y+2)/2):1;var $;if($=I>0?Math.floor(o-(I+1)/2):o,I>0){for(var _=W-M,aa=[],ba=e;ba>V;)aa[ba-V-1]=_/(f[J+ba]-M),ba--;for(var ca=1,da=I+1;da>ca;){for(var ea=ca++,fa=I-ea,ga=V+ea,ha=e;ha>=ga;)k[ha]=Da.add(Da.mul(aa[ha-ga],k[ha]),Da.mul(1-aa[ha-ga],k[ha-1])),ha--;m[fa]=k[e]}}for(var ia=Z,ja=o+1;ja>ia;){var ka=ia++;l[ka]=Da.zeros1d(i);for(var la=Ma.imin(e,ka),ma=Ma.imax(0,ka-h),na=la+1;na>ma;){var oa=ma++;l[ka]=Da.add(l[ka],Da.mul(j[ka][oa],k[oa]))}}if(Y>1)for(var pa=H-2,qa=H,ra=W-M,sa=(W-r[H-1])/ra,ta=1;Y>ta;){for(var ua=ta++,va=pa,wa=qa,xa=wa-H+1;wa-va>ua;){if(L>va){var ya=(W-r[va])/(M-r[va]);q[va]=Da.lerp(ya,q[va],q[va-1])}if(wa>=Z){if(H-o+Y>=wa-ua){var za=(W-r[wa-ua])/ra;l[xa]=Da.lerp(za,l[xa],l[xa+1])}}else l[xa]=Da.lerp(sa,l[xa],l[xa+1]);va+=1,wa-=1,xa-=1}pa-=1,qa+=1}if(J!=e)for(var Aa=0,Ba=o-Y;Ba>Aa;){Aa++;r[H]=M,H+=1}for(var Ca=Z,Ea=$+1;Ea>Ca;){var Fa=Ca++;q[L]=l[Fa],L+=1}if(n>K){for(var Ga=0;I>Ga;){var Ha=Ga++;k[Ha]=m[Ha]}for(var Ia=I,Ja=e+1;Ja>Ia;){var Ka=Ia++;k[Ka]=g[K-e+Ka]}J=K,K+=1,M=W}else for(var La=0,Na=o+1;Na>La;){var Oa=La++;r[H+Oa]=W}}return c=G-o-1,new X(b,r,q)},Ma.rationalSurfaceTransform=function(a,b){for(var c=Ja.dehomogenize2d(a.controlPoints),d=0,e=c.length;e>d;)for(var f=d++,g=0,h=c[f].length;h>g;){var i=g++,j=c[f][i];j.push(1),c[f][i]=ua.dot(b,j).slice(0,j.length-1)}return new Y(a.degreeU,a.degreeV,a.knotsU.slice(),a.knotsV.slice(),Ja.homogenize2d(c,Ja.weight2d(a.controlPoints)))},Ma.rationalCurveTransform=function(a,b){for(var c=Ja.dehomogenize1d(a.controlPoints),d=0,e=c.length;e>d;){var f=d++,g=c[f];g.push(1),c[f]=ua.dot(b,g).slice(0,g.length-1)}return new X(a.degree,a.knots.slice(),Ja.homogenize1d(c,Ja.weight1d(a.controlPoints)))},Ma.surfaceKnotRefine=function(a,b,c){if(0==b.length)return La.clonedSurface(a);var d,e,f=a.controlPoints;c?(d=a.degreeV,e=a.knotsV):(d=a.degreeU,e=a.knotsU);var g;g=c?f[0].length-1:f.length-1;var h=g+d+1,i=b.length-1,j=Ja.knotSpan(d,b[0],e),k=Ja.knotSpan(d,b[i],e),l=[],m=[];if(c){for(var n=Ea.knotMultiplicities(b),o=0,p=f.length+n.length-1;p>o;){o++;l.push([])}for(var q=0,r=j-d+1;r>q;)for(var s=q++,t=0,u=f.length;u>t;){var v=t++;l[v][s]=f[v][s]}for(var w=k-1,x=g+1;x>w;)for(var y=w++,z=y+i+1,A=0,B=f.length;B>A;){var C=A++;l[C][z]=f[C][y]}}else{for(var D=0,E=j-d+1;E>D;){var F=D++;l[F]=f[F].slice(0)}for(var G=k-1,H=g+1;H>G;){var I=G++;l[I+i+1]=f[I].slice(0)}}for(var J=0,K=j+1;K>J;){var L=J++;m[L]=e[L]}for(var M=k+d,N=h+1;N>M;){var O=M++;m[O+i+1]=e[O]}for(var P=k+d-1,Q=k+d+i,R=i;R>=0;){for(;b[R]<=e[P]&&P>j;){var S=Q-d-1,U=P-d-1;if(c)for(var V=0,W=l.length;W>V;){var X=V++;l[X][S]=f[X][U].slice(0)}else l[S]=f[U].slice(0);m[Q]=e[P],Q-=1,P-=1}if(c)for(var Z=0,$=l.length;$>Z;){var _=Z++;l[_][Q-d-1]=l[_][Q-d].slice(0)}else l[Q-d-1]=l[Q-d].slice(0);for(var aa=1,ba=d+1;ba>aa;){var ca=aa++,da=Q-d+ca,ea=m[Q+ca]-b[R];if(Math.abs(ea)<T.EPSILON)if(c)for(var fa=0,ga=l.length;ga>fa;){var ha=fa++;l[ha][da-1]=l[ha][da]}else l[da-1]=l[da].slice(0);else if(ea/=m[Q+ca]-e[P-d+ca],c)for(var ia=0,ja=l.length;ja>ia;){var ka=ia++;l[ka][da-1]=Da.lerp(ea,l[ka][da-1],l[ka][da])}else for(var la=0,ma=l[da].length;ma>la;){var na=la++;l[da-1][na]=Da.lerp(ea,l[da-1][na],l[da][na])}}m[Q]=b[R],Q-=1,R--}return c?new Y(a.degreeU,a.degreeV,a.knotsU.slice(),m,l):new Y(a.degreeU,a.degreeV,m,a.knotsV.slice(),l)},Ma.decomposeSurfaceIntoBeziers=function(a){for(var b=Ea.knotMultiplicities(a.knotsU),c=a.degreeU+1,d=0;d<b.length;){var e=b[d];if(++d,e.mult<c){var f=Da.rep(c-e.mult,e.knot);if(0==f.length)continue;a=Ma.surfaceKnotRefine(a,f,!1)}}for(var g=Ea.knotMultiplicities(a.knotsV),h=a.degreeV+1,i=0;i<g.length;){var j=g[i];if(++i,j.mult<h){var k=Da.rep(h-j.mult,j.knot);if(0==k.length)continue;a=Ma.surfaceKnotRefine(a,k,!0)}}for(var l=(a.knotsU.length/c-1,a.knotsV.length/h-1,2*c),m=2*h,n=[],o=0;o<a.controlPoints.length;){var p=[];n.push(p);for(var q=a.knotsU.slice(o,o+l),r=0;r<a.controlPoints[o].length;){var s=a.knotsV.slice(r,r+m),t=Ma.submatrix(a.controlPoints,o,r,h,c);p.push(new Y(a.degreeU,a.degreeV,q,s,t)),r+=h}o+=c}return n},Ma.submatrix=function(a,b,c,d,e){for(var f=[],g=b,h=b+d;h>g;){var i=g++;f.push(a[i].slice(c,c+e))}return f},Ma.decomposeCurveIntoBeziers=function(a){for(var b=a.degree,c=a.controlPoints,d=a.knots,e=Ea.knotMultiplicities(d),f=b+1,g=0;g<e.length;){var h=e[g];if(++g,h.mult<f){var i=Da.rep(f-h.mult,h.knot);if(0==i.length)continue;var j=Ma.curveKnotRefine(new X(b,d,c),i);d=j.knots,c=j.controlPoints}}for(var k=(d.length/f-1,2*f),l=[],m=0;m<c.length;){var n=d.slice(m,m+k),o=c.slice(m,m+f);l.push(new X(b,n,o)),m+=f}return l},Ma.curveKnotRefine=function(a,b){if(0==b.length)return La.clonedCurve(a);for(var c=a.degree,d=a.controlPoints,e=a.knots,f=d.length-1,g=f+c+1,h=b.length-1,i=Ja.knotSpan(c,b[0],e),j=Ja.knotSpan(c,b[h],e),k=[],l=[],m=0,n=i-c+1;n>m;){var o=m++;k[o]=d[o]}for(var p=j-1,q=f+1;q>p;){var r=p++;k[r+h+1]=d[r]}for(var s=0,t=i+1;t>s;){var u=s++;l[u]=e[u]}for(var v=j+c,w=g+1;w>v;){var x=v++;l[x+h+1]=e[x]}for(var y=j+c-1,z=j+c+h,A=h;A>=0;){for(;b[A]<=e[y]&&y>i;)k[z-c-1]=d[y-c-1],l[z]=e[y],z-=1,y-=1;k[z-c-1]=k[z-c];for(var B=1,C=c+1;C>B;){var D=B++,E=z-c+D,F=l[z+D]-b[A];Math.abs(F)<T.EPSILON?k[E-1]=k[E]:(F/=l[z+D]-e[y-c+D],k[E-1]=Da.lerp(F,k[E-1],k[E]))}l[z]=b[A],z-=1,A--}return new X(c,l,k)},Ma.curveKnotInsert=function(a,b,c){for(var d=a.degree,e=a.controlPoints,f=a.knots,g=0,h=e.length,i=Ja.knotSpan(d,b,f),j=[],k=[],l=[],m=1,n=i+1;n>m;){var o=m++;k[o]=f[o]}for(var p=1,q=c+1;q>p;){var r=p++;k[i+r]=b}for(var s=i+1,t=f.length;t>s;){var u=s++;k[u+c]=f[u]}for(var v=0,w=i-d+1;w>v;){var x=v++;l[x]=e[x]}for(var y=i-g;h>y;){var z=y++;l[z+c]=e[z]}for(var A=0,B=d-g+1;B>A;){var C=A++;j[C]=e[i-d+C]}for(var D=0,E=0,F=1,G=c+1;G>F;){var H=F++;D=i-d+H;for(var I=0,J=d-H-g+1;J>I;){var K=I++;E=(b-f[D+K])/(f[K+i+1]-f[D+K]),j[K]=Da.add(Da.mul(1-E,j[K]),Da.mul(E,j[K+1]))}l[D]=j[0],l[i+c-H-g]=j[d-H-g]}for(var L=D+1,M=i-g;M>L;){var N=L++;l[N]=j[N-D]}return new X(d,k,l)};var Na=function(){};g["verb.eval.NewMeshData"]=Na,Na.__name__=["verb","eval","NewMeshData"],Na.prototype={__class__:Na};var Oa=function(){};g["verb.eval.BezierEdgeIndices"]=Oa,Oa.__name__=["verb","eval","BezierEdgeIndices"],Oa.prototype={__class__:Oa};var Pa=g["verb.eval.EdgeSide"]={__ename__:["verb","eval","EdgeSide"],__constructs__:["North","South","East","West"]};Pa.North=["North",0],Pa.North.toString=h,Pa.North.__enum__=Pa,Pa.South=["South",1],Pa.South.toString=h,Pa.South.__enum__=Pa,Pa.East=["East",2],Pa.East.toString=h,Pa.East.__enum__=Pa,Pa.West=["West",3],Pa.West.toString=h,Pa.West.__enum__=Pa;var Qa=b.eval.Tess=function(){};g["verb.eval.Tess"]=Qa,Qa.__name__=["verb","eval","Tess"],Qa.rationalBezierSurfaceRegularSample=function(a,b,c){for(var d=[],e=a.knotsU[0],f=(Q.last(a.knotsU)-a.knotsU[0])/b,g=0;b>g;){var h=(g++,La.surfaceIsocurve(a,e,!0));(Q.last(h.knots)-h.knots[0])/c;Qa.rationalBezierCurveRegularSamplePointsMutate(h,d,h.knots[0],f,c,!1),e+=f}return d},Qa.northIndex=function(a,b,c){return 0>=a?null:c[a-1][b]},Qa.southIndex=function(a,b,c){return a>=c.length-1?null:c[a+1][b]},Qa.eastIndex=function(a,b,c){return b>=c[a].length-1?null:c[a][b+1]},Qa.westIndex=function(a,b,c){return 0>=b?null:c[a][b-1]},Qa.rationalSurfaceAdaptiveSample=function(a,b){var c=Ma.decomposeSurfaceIntoBeziers(a);t.trace(c.length,{fileName:"Tess.hx",lineNumber:91,className:"verb.eval.Tess",methodName:"rationalSurfaceAdaptiveSample",customParams:[c[0].length]});for(var d,e=[],f=0;f<c.length;){var g=c[f];++f,d=[],e.push(d);for(var h=0;h<g.length;){var i=g[h];++h,d.push(Qa.rationalBezierSurfaceStepLength(i,b))}}for(var j,k,l,m,n,o,p,q=[],r=new aa(1/0,1/0),s=[],u=0,v=c.length;v>u;){var w=u++;l=[],s.push(l);for(var x=0,y=c[w].length;y>x;){var z=x++;if(p=c[w][z],m=new Oa,l.push(m),j=Qa.southIndex(w,z,e),null==j&&(j=r),k=Qa.eastIndex(w,z,e),null==k&&(k=r),0==w){var A=La.surfaceIsocurve(p,Q.first(p.knotsU),!1);n=q.length,Qa.rationalBezierCurveRegularSamplePointsMutate2(A,q,e[w][z].item1),o=q.length,m.n=new aa(n,o)}else m.n=s[w-1][z].s;if(0==z){n=q.length;var B=La.surfaceIsocurve(p,Q.first(p.knotsV),!0);Qa.rationalBezierCurveRegularSamplePointsMutate2(B,q,e[w][z].item0),o=q.length,m.w=new aa(n,o)}else m.w=s[w][z-1].e;n=q.length;var C=La.surfaceIsocurve(p,Q.last(p.knotsU),!1);Qa.rationalBezierCurveRegularSamplePointsMutate2(C,q,Math.min(j.item1,e[w][z].item1)),o=q.length,m.s=new aa(n,o),n=q.length;var D=La.surfaceIsocurve(p,Q.last(p.knotsV),!0);Qa.rationalBezierCurveRegularSamplePointsMutate2(D,q,Math.min(k.item0,e[w][z].item0)),o=q.length,m.e=new aa(n,o)}}for(var E,F=[],G=0,H=c.length;H>G;)for(var I=G++,J=0,K=c[I].length;K>J;){var L=J++;E=q.length;for(var M=c[I][L],N=Math.ceil(1/e[I][L].item0),O=Q.last(M.knotsV)-M.knotsV[0],P=Q.last(M.knotsU)-M.knotsU[0],R=Math.ceil(1/e[I][L].item1),S=O/R,T=P/N,U=M.knotsU[0]+T,V=0,W=N-1;W>V;){var X=(V++,La.surfaceIsocurve(M,U,!1));Qa.rationalBezierCurveRegularSamplePointsMutate(X,q,X.knots[0]+S,S,R-1,!1),U+=T}N-=2,R-=2;for(var Y=0;N>Y;)for(var $=Y++,_=0;R>_;){var ba=_++,ca=E+$*(R+1)+ba,da=E+($+1)*(R+1)+ba,ea=da+1,fa=ca+1,ga=[ca,da,ea],ha=[ca,ea,fa];F.push(ga),F.push(ha)}m=s[I][L],Qa.stitchMesh(M,F,m,N,R,O,E,S,Pa.North),Qa.stitchMesh(M,F,m,N,R,O,E,S,Pa.South),Qa.stitchMesh(M,F,m,N,R,P,E,T,Pa.East),Qa.stitchMesh(M,F,m,N,R,P,E,T,Pa.West)}return new Z(F,q,null,null)},Qa.stitchMesh=function(a,b,c,d,e,f,g,h,i){var j,k,l=!1,m=1;switch(i[1]){case 0:j=c.n,k=a.knotsV;break;case 1:j=c.s,k=a.knotsV,g+=d*(e+1),l=!0;break;case 2:j=c.e,k=a.knotsU,m=e+1,g+=e;break;case 3:j=c.w,k=a.knotsU,m=e+1,l=!0}for(var n=j.item1-j.item0-1,o=f/n,p=Q.first(k),q=Q.first(k)+1.5*h,r=0,s=0;n>r;){for(;p<q-T.EPSILON&&n>r;){var t=j.item0+r,u=t+1;l?b.push([t,u,g+s]):b.push([t,g+s,u]),r++,p+=o}if(n>r){var v=j.item0+r;l?b.push([g+s,v,g+s+m]):b.push([g+s,g+s+m,v])}s+=m,q+=h}},Qa.rationalBezierCurveRegularSamplePointsMutate2=function(a,b,c,d){null==d&&(d=!1);var e=Q.last(a.knots)-a.knots[0],f=Math.ceil(1/c),g=e/f;Qa.rationalBezierCurveRegularSamplePointsMutate(a,b,a.knots[0],g,f+1,!1)},Qa.rationalBezierSurfaceStepLength=function(a,b){for(var c=Ja.dehomogenize2d(a.controlPoints),d=new S,e=0;e<c.length;){var f=c[e];++e,d.addRange(f)}var g=Da.mul(.5,Da.add(d.min,d.max)),h=ua.identity(4);h[0][3]=-g[0],h[1][3]=-g[1],h[2][3]=-g[2];var i=Ma.rationalSurfaceTransform(a,h);c=Ja.dehomogenize2d(i.controlPoints);for(var j,k=0,l=0,m=c.length;m>l;)for(var n=l++,o=0,p=c[n].length;p>o;){var q=o++;j=Da.norm(c[n][q]),j>k&&(k=j)}for(var r,s=-(1/0),t=0,u=a.controlPoints.length-2;u>t;)for(var v=t++,w=0,x=a.controlPoints[v].length;x>w;){var y=w++;r=Da.norm(Da.add(c[v+2][y],Da.add(Da.mul(-2,c[v+1][y]),c[v][y])))-(k-b)*(Q.last(i.controlPoints[v+2][y])-2*Q.last(i.controlPoints[v+1][y])+Q.last(i.controlPoints[v][y])),r>s&&(s=r)}for(var z,A=-(1/0),B=0,C=a.controlPoints.length;C>B;)for(var D=B++,E=0,F=a.controlPoints[D].length-2;F>E;){var G=E++;z=Da.norm(Da.add(c[D][G+2],Da.add(Da.mul(-2,c[D][G+1]),c[D][G])))-(k-b)*(Q.last(i.controlPoints[D][G+2])-2*Q.last(i.controlPoints[D][G+1])+Q.last(i.controlPoints[D][G])),z>A&&(A=z)}for(var H,I=-(1/0),J=0,K=a.controlPoints.length-1;K>J;)for(var L=J++,M=0,N=a.controlPoints[L].length-1;N>M;){var O=M++;H=Da.norm(Da.addAll([c[L+1][O+1],Da.mul(-1,c[L][O+1]),Da.mul(-1,c[L+1][O]),c[L][O]]))-(k-b)*(Q.last(i.controlPoints[L+1][O+1])-Q.last(i.controlPoints[L][O+1])-Q.last(i.controlPoints[L+1][O])+Q.last(i.controlPoints[L][O])),H>I&&(I=H)}s*=a.degreeU*(a.degreeU-1),A*=a.degreeV*(a.degreeV-1),I*=a.degreeU*a.degreeV;for(var P,R=1/0,U=0,V=a.controlPoints.length;V>U;)for(var W=U++,X=0,Y=a.controlPoints[W].length;Y>X;){var Z=X++;P=Q.last(a.controlPoints[W][Z]),R>P&&(R=P)}var $,_;if(Math.abs(s)<T.TOLERANCE){if($=1,Math.abs(A)<T.TOLERANCE)return _=1,new aa($,_);_=(Math.sqrt(I*I+8*A*b*R)-I)/A}if(Math.abs(A)<T.TOLERANCE)return _=1,$=(Math.sqrt(I*I+8*s*b*R)-I)/s,new aa($,_);var ba,ca,da;return ba=4*A*b*R,da=s*A+I*Math.sqrt(s*A),$=Math.sqrt(ba/da),ca=4*s*b*R,_=Math.sqrt(ca/da),new aa($,_)},Qa.rationalCurveRegularSample=function(a,b,c){if(null==c&&(c=!1),1==a.degree){for(var d=[],e=0,f=a.controlPoints.length;f>e;){var g=e++;d.push(Ja.dehomogenize(a.controlPoints[g]))}if(c)for(var h=0,i=a.controlPoints.length;i>h;){var j=h++;d[j].push(a.knots[j+1])}return d}var k,l=Q.last(a.knots)-a.knots[0];k=a.knots.length==2*(a.degree+1)?[a]:Ma.decomposeCurveIntoBeziers(a);for(var m,n,o,p=[],q=a.knots[0],r=l/b,s=0,t=k.length;t>s;){var u=s++;m=Q.last(k[u].knots)-q,n=Math.ceil(m/r),o=q+n*r,o>Q.last(k[u].knots)+T.TOLERANCE&&(o-=r,n--),Qa.rationalBezierCurveRegularSamplePointsMutate(k[u],p,q,r,n+1,c),q=o+r}return p},Qa.rationalCurveAdaptiveSample=function(a,b,c){if(null==c&&(c=!1),1==a.degree){for(var d=[],e=0,f=a.controlPoints.length;f>e;){var g=e++;d.push(Ja.dehomogenize(a.controlPoints[g]))}if(c)for(var h=0,i=a.controlPoints.length;i>h;){var j=h++;d[j].push(a.knots[j+1])}return d}var k;k=a.knots.length==2*(a.degree+1)?[a]:Ma.decomposeCurveIntoBeziers(a);for(var l,m,n,o=[],p=0,q=k.length;q>p;){var r=p++;if(m=Q.last(k[r].knots)-k[r].knots[0],n=Qa.rationalBezierCurveStepLength(k[r],b),l=Math.ceil(m/n),n=m/l,Qa.rationalBezierCurveRegularSamplePointsMutate(k[r],o,k[r].knots[0],n,l+1,c),r==k.length-1)break;o.pop()}return o},Qa.rationalBezierCurveRegularSamplePointsMutate=function(a,b,c,d,e,f){null==f&&(f=!1);var g=[],h=[g],i=c,j=a.degree+1;if(e<=a.degree+1)for(var k=0;e>k;){k++;b.push(Ja.rationalCurvePoint(a,i)),i+=d}else{for(var l=0;j>l;){l++;g.push(Ja.curvePoint(a,i)),i+=d}for(var m,n=1;j>n;){var o=n++;g=[],h.push(g),m=h[o-1];for(var p=1,q=m.length;q>p;){var r=p++;g.push(Da.sub(m[r],m[r-1]))}}for(var s=0,t=h[0];s<t.length;){var u=t[s];++s,b.push(Ja.dehomogenize(u))}for(var v,w=[],x=0;x<h.length;){var y=h[x];++x,w.push(Q.last(y))}v=w;for(var z,A=v.length-2,B=0,C=e-j;C>B;){for(var D=(B++,0),E=v.length-1;E>D;){var F=D++;z=A-F,Da.addMutate(v[z],v[z+1])}b.push(Ja.dehomogenize(v[0]))}if(i=c,f)for(var G=0;G<b.length;){var H=b[G];++G,H.push(i),i+=d}}},Qa.rationalBezierCurveStepLength=function(a,b){var c=Ja.dehomogenize1d(a.controlPoints),d=new S(c),e=Da.mul(.5,Da.add(d.min,d.max)),f=ua.identity(4);f[0][3]=-e[0],f[1][3]=-e[1],f[2][3]=-e[2];var g=Ma.rationalCurveTransform(a,f);c=Ja.dehomogenize1d(g.controlPoints);for(var h,i=0,j=0,k=c.length;k>j;){var l=j++;h=Da.norm(c[l]),h>i&&(i=h)}var m=Ja.weight1d(a.controlPoints),n=Da.min(m),o=Q.last(a.knots)-a.knots[0];if(i>b){for(var p,q=8*n*b,r=Qa.secondForwardDiff(m),s=Qa.secondForwardDiff2(c),t=[],u=0,v=s.length;v>u;){var w=u++;t.push(Da.norm(s[w])+(i-b)*r[w])}p=t;var x=Da.max(p),y=a.degree*(a.degree-1)*x;return o*Math.sqrt(q/y)}if(i>=b&&2*i>b){for(var z,A=8*n*b,B=Qa.secondForwardDiff2(c),C=[],D=0,E=B.length;E>D;){var F=D++;C.push(Da.norm(B[F]))}z=C;var G=Da.max(z),H=a.degree*(a.degree-1)*G;return o*Math.sqrt(A/H)}return o},Qa.secondForwardDiff=function(a){for(var b=0,c=[];b<a.length-2;)c.push(a[b+2]-2*a[b+1]+a[b]),b++;return c},Qa.secondForwardDiff2=function(a){for(var b=0,c=[];b<a.length-2;)c.push(Da.add(a[b+2],Da.add(Da.mul(-2,a[b+1]),a[b]))),b++;return c},Qa.rationalSurfaceNaive=function(a,b,c){1>b&&(b=1),1>c&&(c=1);for(var d=(a.degreeU,a.degreeV,a.controlPoints,a.knotsU),e=a.knotsV,f=Q.last(d)-d[0],g=Q.last(e)-e[0],h=f/b,i=g/c,j=[],k=[],l=[],m=0,n=b+1;n>m;)for(var o=m++,p=0,q=c+1;q>p;){var r=p++,s=d[0]+o*h,t=e[0]+r*i;k.push([s,t]);var u=Ja.rationalSurfaceDerivatives(a,s,t,1),v=u[0][0];j.push(v);var w=Da.normalized(Da.cross(u[1][0],u[0][1]));l.push(w)}for(var x=[],y=0;b>y;)for(var z=y++,A=0;c>A;){var B=A++,C=z*(c+1)+B,D=(z+1)*(c+1)+B,E=D+1,F=C+1,G=[C,D,E],H=[C,E,F];x.push(G),x.push(H)}return new Z(x,j,l,k)},Qa.divideRationalSurfaceAdaptive=function(a,b){null==b&&(b=new Ra),null!=b.minDivsU?b.minDivsU=b.minDivsU:b.minDivsU=1,null!=b.minDivsV?b.minDivsU=b.minDivsV:b.minDivsU=1,null!=b.refine?b.refine=b.refine:b.refine=!0;var c,d=2*(a.controlPoints.length-1),e=2*(a.controlPoints[0].length-1);c=b.minDivsU>d?b.minDivsU=b.minDivsU:b.minDivsU=d;var f;f=b.minDivsV>e?b.minDivsV=b.minDivsV:b.minDivsV=e;for(var g=Q.last(a.knotsU),h=a.knotsU[0],i=Q.last(a.knotsV),j=a.knotsV[0],k=(g-h)/c,l=(i-j)/f,m=[],n=[],o=0,p=f+1;p>o;){for(var q=o++,r=[],s=0,t=c+1;t>s;){var u=s++,v=h+k*u,w=j+l*q,x=Ja.rationalSurfaceDerivatives(a,v,w,1),y=Da.normalized(Da.cross(x[0][1],x[1][0]));r.push(new ja(x[0][0],y,[v,w],-1,Da.isZero(y)))}n.push(r)}for(var z=0;f>z;)for(var A=z++,B=0;c>B;){var C=B++,D=[n[f-A-1][C],n[f-A-1][C+1],n[f-A][C+1],n[f-A][C]];m.push(new Sa(a,D))}if(!b.refine)return m;for(var E=0;f>E;)for(var F=E++,G=0;c>G;){var H=G++,I=F*c+H,J=Qa.north(I,F,H,c,f,m),K=Qa.east(I,F,H,c,f,m),L=Qa.south(I,F,H,c,f,m),M=Qa.west(I,F,H,c,f,m);m[I].neighbors=[L,K,J,M],m[I].divide(b)}return m},Qa.north=function(a,b,c,d,e,f){return 0==b?null:f[a-d]},Qa.south=function(a,b,c,d,e,f){return b==e-1?null:f[a+d]},Qa.east=function(a,b,c,d,e,f){return c==d-1?null:f[a+1]},Qa.west=function(a,b,c,d,e,f){return 0==c?null:f[a-1]},Qa.triangulateAdaptiveRefinementNodeTree=function(a){for(var b=Z.empty(),c=0;c<a.length;){var d=a[c];++c,d.triangulate(b)}return b},Qa.rationalSurfaceAdaptive=function(a,b){b=null!=b?b:new Ra;var c=Qa.divideRationalSurfaceAdaptive(a,b);return Qa.triangulateAdaptiveRefinementNodeTree(c)},Qa.rationalSurfaceRegularSample=function(a,b,c){return Ja.dehomogenize2d(Qa.surfaceRegularSample(a,b,c))},Qa.surfaceRegularSample=function(a,b,c){for(var d=a.degreeU,e=a.degreeV,f=a.controlPoints,g=a.knotsU,h=a.knotsV,i=f[0][0].length,j=((Q.last(g)-g[0])/b,(Q.last(h)-h[0])/c,Ja.regularlySpacedBasisFunctions(d,g,b)),k=j.item0,l=j.item1,m=Ja.regularlySpacedBasisFunctions(e,h,c),n=m.item0,o=m.item1,p=[],q=b+1,r=c+1,s=0;q>s;){var t=s++,u=[];p.push(u);for(var v=0;r>v;){var w=v++;u.push(Ja.surfacePointGivenBasesKnotSpans(d,e,f,k[t],n[w],l[t],o[w],i))}}return p},Qa.surfaceRegularSample2=function(a,b,c){for(var d=[],e=a.knotsU[0],f=(Q.last(a.knotsU)-a.knotsU[0])/b,g=0;b>g;){var h=(g++,La.surfaceIsocurve(a,e,!0));d.push(Qa.rationalCurveRegularSample(h,c)),e+=f}return d};var Ra=b.core.AdaptiveRefinementOptions=function(){this.minDivsV=1,this.minDivsU=1,this.refine=!0,this.maxDepth=10,this.minDepth=0,this.normTol=.025};g["verb.eval.AdaptiveRefinementOptions"]=Ra,Ra.__name__=["verb","eval","AdaptiveRefinementOptions"],Ra.prototype={__class__:Ra};var Sa=b.core.AdaptiveRefinementNode=function(a,b,c){if(this.srf=a,null==c?this.neighbors=[null,null,null,null]:this.neighbors=c,this.corners=b,null==this.corners){var d=a.knotsU[0],e=Q.last(a.knotsU),f=a.knotsV[0],g=Q.last(a.knotsV);this.corners=[ja.fromUv(d,f),ja.fromUv(e,f),ja.fromUv(e,g),ja.fromUv(d,g)]}};g["verb.eval.AdaptiveRefinementNode"]=Sa,Sa.__name__=["verb","eval","AdaptiveRefinementNode"],Sa.prototype={isLeaf:function(){return null==this.children},center:function(){return null!=this.centerPoint?this.centerPoint:this.evalSrf(this.u05,this.v05)},evalCorners:function(){this.u05=(this.corners[0].uv[0]+this.corners[2].uv[0])/2,this.v05=(this.corners[0].uv[1]+this.corners[2].uv[1])/2;for(var a=0;4>a;){var b=a++;if(null==this.corners[b].point){var c=this.corners[b];this.evalSrf(c.uv[0],c.uv[1],c)}}},evalSrf:function(a,b,c){var d=Ja.rationalSurfaceDerivatives(this.srf,a,b,1),e=d[0][0],f=Da.cross(d[0][1],d[1][0]),g=Da.isZero(f);return g||(f=Da.normalized(f)),null!=c?(c.degen=g,c.point=e,c.normal=f,c):new ja(e,f,[a,b],-1,g)},getEdgeCorners:function(a){if(this.isLeaf())return[this.corners[a]];if(this.horizontal)switch(a){case 0:return this.children[0].getEdgeCorners(0);case 1:return this.children[0].getEdgeCorners(1).concat(this.children[1].getEdgeCorners(1));case 2:return this.children[1].getEdgeCorners(2);case 3:return this.children[1].getEdgeCorners(3).concat(this.children[0].getEdgeCorners(3))}switch(a){case 0:return this.children[0].getEdgeCorners(0).concat(this.children[1].getEdgeCorners(0));case 1:return this.children[1].getEdgeCorners(1);case 2:return this.children[1].getEdgeCorners(2).concat(this.children[0].getEdgeCorners(2));case 3:return this.children[0].getEdgeCorners(3)}return null},getAllCorners:function(a){var b=[this.corners[a]];if(null==this.neighbors[a])return b;var c=this.neighbors[a].getEdgeCorners((a+2)%4),d=a%2,e=T.EPSILON,f=this,g=[function(a){return a.uv[0]>f.corners[0].uv[0]+e&&a.uv[0]<f.corners[2].uv[0]-e},function(a){return a.uv[1]>f.corners[0].uv[1]+e&&a.uv[1]<f.corners[2].uv[1]-e}],h=c.filter(g[d]);return h.reverse(),b.concat(h)},midpoint:function(a){if(null==this.midPoints&&(this.midPoints=[null,null,null,null]),null!=this.midPoints[a])return this.midPoints[a];switch(a){case 0:this.midPoints[0]=this.evalSrf(this.u05,this.corners[0].uv[1]);break;case 1:this.midPoints[1]=this.evalSrf(this.corners[1].uv[0],this.v05);break;case 2:this.midPoints[2]=this.evalSrf(this.u05,this.corners[2].uv[1]);break;case 3:this.midPoints[3]=this.evalSrf(this.corners[0].uv[0],this.v05)}return this.midPoints[a]},hasBadNormals:function(){return this.corners[0].degen||this.corners[1].degen||this.corners[2].degen||this.corners[3].degen},fixNormals:function(){for(var a=this.corners.length,b=0;a>b;){var c=b++;this.corners[c];if(this.corners[c].degen){var d=this.corners[(c+1)%a],e=this.corners[(c+3)%a];d.degen?this.corners[c].normal=e.normal:this.corners[c].normal=d.normal}}},shouldDivide:function(a,b){if(b<a.minDepth)return!0;if(b>=a.maxDepth)return!1;if(this.hasBadNormals())return this.fixNormals(),!1;if(this.splitVert=Da.normSquared(Da.sub(this.corners[0].normal,this.corners[1].normal))>a.normTol||Da.normSquared(Da.sub(this.corners[2].normal,this.corners[3].normal))>a.normTol,this.splitHoriz=Da.normSquared(Da.sub(this.corners[1].normal,this.corners[2].normal))>a.normTol||Da.normSquared(Da.sub(this.corners[3].normal,this.corners[0].normal))>a.normTol,this.splitVert||this.splitHoriz)return!0;var c=this.center();return Da.normSquared(Da.sub(c.normal,this.corners[0].normal))>a.normTol||Da.normSquared(Da.sub(c.normal,this.corners[1].normal))>a.normTol||Da.normSquared(Da.sub(c.normal,this.corners[2].normal))>a.normTol||Da.normSquared(Da.sub(c.normal,this.corners[3].normal))>a.normTol},divide:function(a){null==a&&(a=new Ra),null==a.normTol&&(a.normTol=.085),null==a.minDepth&&(a.minDepth=0),null==a.maxDepth&&(a.maxDepth=10),this._divide(a,0,!0)},_divide:function(a,b,c){if(this.evalCorners(),this.shouldDivide(a,b)){if(b++,this.splitVert&&!this.splitHoriz?c=!1:!this.splitVert&&this.splitHoriz&&(c=!0),this.horizontal=c,this.horizontal){var d=[this.corners[0],this.corners[1],this.midpoint(1),this.midpoint(3)],e=[this.midpoint(3),this.midpoint(1),this.corners[2],this.corners[3]];this.children=[new Sa(this.srf,d),new Sa(this.srf,e)],this.children[0].neighbors=[this.neighbors[0],this.neighbors[1],this.children[1],this.neighbors[3]],this.children[1].neighbors=[this.children[0],this.neighbors[1],this.neighbors[2],this.neighbors[3]]}else{var f=[this.corners[0],this.midpoint(0),this.midpoint(2),this.corners[3]],g=[this.midpoint(0),this.corners[1],this.corners[2],this.midpoint(2)];this.children=[new Sa(this.srf,f),new Sa(this.srf,g)],this.children[0].neighbors=[this.neighbors[0],this.children[1],this.neighbors[2],this.neighbors[3]],this.children[1].neighbors=[this.neighbors[0],this.neighbors[1],this.neighbors[2],this.children[0]]}for(var h=0,i=this.children;h<i.length;){var j=i[h];++h,j._divide(a,b,!c)}}},triangulate:function(a){if(null==a&&(a=Z.empty()),this.isLeaf())return this.triangulateLeaf(a);for(var b=0,c=this.children;b<c.length;){var d=c[b];if(++b,null==d)break;d.triangulate(a)}return a},triangulateLeaf:function(a){for(var b=a.points.length,c=[],d=[],e=0,f=0;4>f;){var g=f++,h=this.getAllCorners(g);2==h.length&&(e=g+1);for(var i=0,j=h.length;j>i;){var k=i++;c.push(h[k])}}for(var l=0;l<c.length;){var m=c[l];++l,-1==m.id?(a.uvs.push(m.uv),a.points.push(m.point),a.normals.push(m.normal),m.id=b,d.push(b),b++):d.push(m.id)}if(4==c.length)return a.faces.push([d[0],d[3],d[1]]),a.faces.push([d[3],d[2],d[1]]),a;if(5==c.length){var n=d.length;return a.faces.push([d[e],d[(e+2)%n],d[(e+1)%n]]),a.faces.push([d[(e+4)%n],d[(e+3)%n],d[e]]),a.faces.push([d[e],d[(e+3)%n],d[(e+2)%n]]),a}var o=this.center();a.uvs.push(o.uv),a.points.push(o.point),a.normals.push(o.normal);for(var p=a.points.length-1,q=0,r=c.length-1;q<c.length;)a.faces.push([p,d[q],d[r]]),r=q++;return a},__class__:Sa};var Ta=b.exe.Dispatcher=function(){};g["verb.exe.Dispatcher"]=Ta,Ta.__name__=["verb","exe","Dispatcher"],Ta.init=function(){Ta._init||(Ta._workerPool=new Ua(Ta.THREADS),Ta._init=!0)},Ta.dispatchMethod=function(a,b,c){Ta.init();var d=new J,e=function(a){d.resolve(a)};return Ta._workerPool.addWork(q.getClassName(a),b,c,e),new K(d)};var Ua=b.exe.WorkerPool=function(a,b){null==b&&(b="verb.js"),null==a&&(a=1),this._callbacks=new w,this._working=new w,this._pool=[],this._queue=[];for(var c=0;a>c;){var d;c++;try{d=new Worker(Ua.basePath+b)}catch(e){e instanceof D&&(e=e.val),d=new Worker(Ua.basePath+b.substring(0,-3)+".min.js")}this._pool.push(d)}};g["verb.exe.WorkerPool"]=Ua,Ua.__name__=["verb","exe","WorkerPool"],Ua.prototype={addWork:function(a,b,c,d){var e=new Va(a,b,c);this._callbacks.set(e.id,d),this._queue.push(e),this.processQueue()},processQueue:function(){for(var a=this;this._queue.length>0&&this._pool.length>0;){var b=this._queue.shift(),c=[b.id],d=[this._pool.shift()];this._working.h[c[0]]=d[0],d[0].onmessage=function(b,c){return function(d){a._working.remove(c[0]),a._pool.push(b[0]);try{a._callbacks.h.hasOwnProperty(c[0])&&(a._callbacks.h[c[0]](d.data.result),a._callbacks.remove(c[0]))}catch(e){e instanceof D&&(e=e.val),t.trace(e,{fileName:"WorkerPool.hx",lineNumber:81,className:"verb.exe.WorkerPool",methodName:"processQueue"})}a.processQueue()}}(d,c),d[0].postMessage(b)}},__class__:Ua};var Va=function(a,b,c){this.className=a,this.methodName=b,this.args=c,this.id=Va.uuid++};g["verb.exe._WorkerPool.Work"]=Va,Va.__name__=["verb","exe","_WorkerPool","Work"],Va.prototype={__class__:Va};var Wa=function(){};g["verb.geom.ICurve"]=Wa,Wa.__name__=["verb","geom","ICurve"],Wa.__interfaces__=[Aa],Wa.prototype={__class__:Wa};var Xa=b.geom.NurbsCurve=function(a){this._data=Ga.isValidNurbsCurveData(a)};g["verb.geom.NurbsCurve"]=Xa,Xa.__name__=["verb","geom","NurbsCurve"],Xa.__interfaces__=[Wa],Xa.byKnotsControlPointsWeights=function(a,b,c,d){return new Xa(new X(a,b.slice(),Ja.homogenize1d(c,d)))},Xa.byPoints=function(a,b){return null==b&&(b=3),new Xa(La.rationalInterpCurve(a,b))},Xa.__super__=U,Xa.prototype=d(U.prototype,{degree:function(){return this._data.degree},knots:function(){return this._data.knots.slice(0)},controlPoints:function(){return Ja.dehomogenize1d(this._data.controlPoints)},weights:function(){return Ja.weight1d(this._data.controlPoints)},asNurbs:function(){return new X(this.degree(),this.knots(),Ja.homogenize1d(this.controlPoints(),this.weights()))},clone:function(){return new Xa(this._data)},domain:function(){return new ba(Q.first(this._data.knots),Q.last(this._data.knots))},transform:function(a){return new Xa(Ma.rationalCurveTransform(this._data,a))},transformAsync:function(a){return Ta.dispatchMethod(Ma,"rationalCurveTransform",[this._data,a]).then(function(a){return new Xa(a)})},point:function(a){return Ja.rationalCurvePoint(this._data,a)},pointAsync:function(a){return Ta.dispatchMethod(Ja,"rationalCurvePoint",[this._data,a])},tangent:function(a){return Ja.rationalCurveTangent(this._data,a)},tangentAsync:function(a){return Ta.dispatchMethod(Ja,"rationalCurveTangent",[this._data,a])},derivatives:function(a,b){return null==b&&(b=1),Ja.rationalCurveDerivatives(this._data,a,b)},derivativesAsync:function(a,b){return null==b&&(b=1),Ta.dispatchMethod(Ja,"rationalCurveDerivatives",[this._data,a,b])},closestPoint:function(a){return Ea.rationalCurveClosestPoint(this._data,a)},closestPointAsync:function(a){return Ta.dispatchMethod(Ea,"rationalCurveClosestPoint",[this._data,a])},closestParam:function(a){return Ea.rationalCurveClosestParam(this._data,a)},closestParamAsync:function(a){return Ta.dispatchMethod(Ea,"rationalCurveClosestParam",[this._data,a])},length:function(){return Ea.rationalCurveArcLength(this._data)},lengthAsync:function(){return Ta.dispatchMethod(Ea,"rationalCurveArcLength",[this._data])},lengthAtParam:function(a){return Ea.rationalCurveArcLength(this._data,a)},lengthAtParamAsync:function(){return Ta.dispatchMethod(Ea,"rationalCurveArcLength",[this._data])},paramAtLength:function(a,b){return Ea.rationalCurveParamAtArcLength(this._data,a,b)},paramAtLengthAsync:function(a,b){return Ta.dispatchMethod(Ea,"rationalCurveParamAtArcLength",[this._data,a,b])},divideByEqualArcLength:function(a){return Ha.rationalCurveByEqualArcLength(this._data,a)},divideByEqualArcLengthAsync:function(a){return Ta.dispatchMethod(Ha,"rationalCurveByEqualArcLength",[this._data,a])},divideByArcLength:function(a){return Ha.rationalCurveByArcLength(this._data,a)},divideByArcLengthAsync:function(a){return Ta.dispatchMethod(Ha,"rationalCurveByArcLength",[this._data,a])},split:function(a){return Ha.curveSplit(this._data,a).map(function(a){return new Xa(a)})},splitAsync:function(a){return Ta.dispatchMethod(Ha,"curveSplit",[this._data,a]).then(function(a){return a.map(function(a){return new Xa(a)})})},reverse:function(){return new Xa(Ma.curveReverse(this._data))},reverseAsync:function(){return Ta.dispatchMethod(Ma,"curveReverse",[this._data]).then(function(a){return new Xa(a)})},tessellate:function(a){return null==a&&(a=.001),Qa.rationalCurveAdaptiveSample(this._data,a,!1)},tessellateAsync:function(a){return null==a&&(a=.001),Ta.dispatchMethod(Qa,"rationalCurveAdaptiveSample",[this._data,a,!1])},__class__:Xa});var Ya=b.geom.Arc=function(a,b,c,d,e,f){Xa.call(this,La.arc(a,b,c,d,e,f)),this._center=a,this._xaxis=b,this._yaxis=c,
this._radius=d,this._minAngle=e,this._maxAngle=f};g["verb.geom.Arc"]=Ya,Ya.__name__=["verb","geom","Arc"],Ya.__super__=Xa,Ya.prototype=d(Xa.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},radius:function(){return this._radius},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:Ya});var Za=b.geom.BezierCurve=function(a,b){Xa.call(this,La.rationalBezierCurve(a,b))};g["verb.geom.BezierCurve"]=Za,Za.__name__=["verb","geom","BezierCurve"],Za.__super__=Xa,Za.prototype=d(Xa.prototype,{__class__:Za});var $a=b.geom.Circle=function(a,b,c,d){Ya.call(this,a,b,c,d,0,2*Math.PI)};g["verb.geom.Circle"]=$a,$a.__name__=["verb","geom","Circle"],$a.__super__=Ya,$a.prototype=d(Ya.prototype,{__class__:$a});var _a=function(){};g["verb.geom.ISurface"]=_a,_a.__name__=["verb","geom","ISurface"],_a.__interfaces__=[Aa],_a.prototype={__class__:_a};var ab=b.geom.NurbsSurface=function(a){this._data=Ga.isValidNurbsSurfaceData(a)};g["verb.geom.NurbsSurface"]=ab,ab.__name__=["verb","geom","NurbsSurface"],ab.__interfaces__=[_a],ab.byKnotsControlPointsWeights=function(a,b,c,d,e,f){return new ab(new Y(a,b,c,d,Ja.homogenize2d(e,f)))},ab.byCorners=function(a,b,c,d){return new ab(La.fourPointSurface(a,b,c,d))},ab.byLoftingCurves=function(a,b){return new ab(La.loftedSurface(function(b){for(var c,d=[],e=0;e<a.length;){var f=a[e];++e,d.push(f.asNurbs())}return c=d}(this),b))},ab.__super__=U,ab.prototype=d(U.prototype,{degreeU:function(){return this._data.degreeU},degreeV:function(){return this._data.degreeV},knotsU:function(){return this._data.knotsU.slice(0)},knotsV:function(){return this._data.knotsV.slice(0)},controlPoints:function(){return Ja.dehomogenize2d(this._data.controlPoints)},weights:function(){return Ja.weight2d(this._data.controlPoints)},asNurbs:function(){return new Y(this.degreeU(),this.degreeV(),this.knotsU(),this.knotsV(),Ja.homogenize2d(this.controlPoints(),this.weights()))},clone:function(){return new ab(this.asNurbs())},domainU:function(){return new ba(Q.first(this._data.knotsU),Q.last(this._data.knotsU))},domainV:function(){return new ba(Q.first(this._data.knotsV),Q.last(this._data.knotsV))},point:function(a,b){return Ja.rationalSurfacePoint(this._data,a,b)},pointAsync:function(a,b){return Ta.dispatchMethod(Ja,"rationalSurfacePoint",[this._data,a,b])},normal:function(a,b){return Ja.rationalSurfaceNormal(this._data,a,b)},normalAsync:function(a,b){return Ta.dispatchMethod(Ja,"rationalSurfaceNormal",[this._data,a,b])},derivatives:function(a,b,c){return null==c&&(c=1),Ja.rationalSurfaceDerivatives(this._data,a,b,c)},derivativesAsync:function(a,b,c){return null==c&&(c=1),Ta.dispatchMethod(Ja,"rationalSurfaceDerivatives",[this._data,a,b,c])},closestParam:function(a){return Ea.rationalSurfaceClosestParam(this._data,a)},closestParamAsync:function(a){return Ta.dispatchMethod(Ea,"rationalSurfaceClosestParam",[this._data,a])},closestPoint:function(a){return Ea.rationalSurfaceClosestPoint(this._data,a)},closestPointAsync:function(a){return Ta.dispatchMethod(Ea,"rationalSurfaceClosestPoint",[this._data,a])},split:function(a,b){return null==b&&(b=!1),Ha.surfaceSplit(this._data,a,b).map(function(a){return new ab(a)})},splitAsync:function(a,b){return null==b&&(b=!1),Ta.dispatchMethod(Ha,"surfaceSplit",[this._data,a,b]).then(function(a){return a.map(function(a){return new ab(a)})})},reverse:function(a){return null==a&&(a=!1),new ab(Ma.surfaceReverse(this._data,a))},reverseAsync:function(a){return null==a&&(a=!1),Ta.dispatchMethod(Ma,"surfaceReverse",[this._data,a]).then(function(a){return new ab(a)})},isocurve:function(a,b){return null==b&&(b=!1),new Xa(La.surfaceIsocurve(this._data,a,b))},isocurveAsync:function(a,b){return null==b&&(b=!1),Ta.dispatchMethod(La,"surfaceIsocurve",[this._data,a,b]).then(function(a){return new Xa(a)})},boundaries:function(a){return La.surfaceBoundaryCurves(this._data).map(function(a){return new Xa(a)})},boundariesAsync:function(a){return Ta.dispatchMethod(La,"surfaceBoundaryCurves",[this._data]).then(function(a){return a.map(function(a){return new Xa(a)})})},tessellate:function(a){return Qa.rationalSurfaceAdaptive(this._data,a)},tessellateAsync:function(a){return Ta.dispatchMethod(Qa,"rationalSurfaceAdaptive",[this._data,a])},transform:function(a){return new ab(Ma.rationalSurfaceTransform(this._data,a))},transformAsync:function(a){return Ta.dispatchMethod(Ma,"rationalSurfaceTransform",[this._data,a]).then(function(a){return new ab(a)})},__class__:ab});var bb=b.geom.ConicalSurface=function(a,b,c,d,e){ab.call(this,La.conicalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.ConicalSurface"]=bb,bb.__name__=["verb","geom","ConicalSurface"],bb.__super__=ab,bb.prototype=d(ab.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:bb});var cb=b.geom.CylindricalSurface=function(a,b,c,d,e){ab.call(this,La.cylindricalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.CylindricalSurface"]=cb,cb.__name__=["verb","geom","CylindricalSurface"],cb.__super__=ab,cb.prototype=d(ab.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:cb});var db=b.geom.EllipseArc=function(a,b,c,d,e){Xa.call(this,La.ellipseArc(a,b,c,d,e)),this._center=a,this._xaxis=b,this._yaxis=c,this._minAngle=d,this._maxAngle=e};g["verb.geom.EllipseArc"]=db,db.__name__=["verb","geom","EllipseArc"],db.__super__=Xa,db.prototype=d(Xa.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:db});var eb=b.geom.Ellipse=function(a,b,c){db.call(this,a,b,c,0,2*Math.PI)};g["verb.geom.Ellipse"]=eb,eb.__name__=["verb","geom","Ellipse"],eb.__super__=db,eb.prototype=d(db.prototype,{__class__:eb});var fb=b.geom.ExtrudedSurface=function(a,b){ab.call(this,La.extrudedSurface(Da.normalized(b),Da.norm(b),a.asNurbs())),this._profile=a,this._direction=b};g["verb.geom.ExtrudedSurface"]=fb,fb.__name__=["verb","geom","ExtrudedSurface"],fb.__super__=ab,fb.prototype=d(ab.prototype,{profile:function(){return this._profile},direction:function(){return this._direction},__class__:fb});var gb=b.geom.Intersect=function(){};g["verb.geom.Intersect"]=gb,gb.__name__=["verb","geom","Intersect"],gb.curves=function(a,b,c){return null==c&&(c=.001),Ka.curves(a.asNurbs(),b.asNurbs(),c)},gb.curvesAsync=function(a,b,c){return null==c&&(c=.001),Ta.dispatchMethod(Ka,"curves",[a.asNurbs(),b.asNurbs(),c])},gb.curveAndSurface=function(a,b,c){return null==c&&(c=.001),Ka.curveAndSurface(a.asNurbs(),b.asNurbs(),c)},gb.curveAndSurfaceAsync=function(a,b,c){return null==c&&(c=.001),Ta.dispatchMethod(Ka,"curveAndSurface",[a.asNurbs(),b.asNurbs(),c])},gb.surfaces=function(a,b,c){return null==c&&(c=.001),Ka.surfaces(a.asNurbs(),b.asNurbs(),c).map(function(a){return new Xa(a)})},gb.surfacesAsync=function(a,b,c){return null==c&&(c=.001),Ta.dispatchMethod(Ka,"surfaces",[a.asNurbs(),b.asNurbs(),c]).then(function(a){return a.map(function(a){return new Xa(a)})})};var hb=b.geom.Line=function(a,b){Xa.call(this,La.polyline([a,b])),this._start=a,this._end=b};g["verb.geom.Line"]=hb,hb.__name__=["verb","geom","Line"],hb.__super__=Xa,hb.prototype=d(Xa.prototype,{start:function(){return this._start},end:function(){return this._end},__class__:hb});var ib=b.geom.RevolvedSurface=function(a,b,c,d){ab.call(this,La.revolvedSurface(a.asNurbs(),b,c,d)),this._profile=a,this._center=b,this._axis=c,this._angle=d};g["verb.geom.RevolvedSurface"]=ib,ib.__name__=["verb","geom","RevolvedSurface"],ib.__super__=ab,ib.prototype=d(ab.prototype,{profile:function(){return this._profile},center:function(){return this._center},axis:function(){return this._center},angle:function(){return this._angle},__class__:ib});var jb=b.geom.SphericalSurface=function(a,b){ab.call(this,La.sphericalSurface(a,[0,0,1],[1,0,0],b)),this._center=a,this._radius=b};g["verb.geom.SphericalSurface"]=jb,jb.__name__=["verb","geom","SphericalSurface"],jb.__super__=ab,jb.prototype=d(ab.prototype,{center:function(){return this._center},radius:function(){return this._radius},__class__:jb});var kb=b.geom.SweptSurface=function(a,b){ab.call(this,La.rationalTranslationalSurface(a.asNurbs(),b.asNurbs())),this._profile=a,this._rail=b};g["verb.geom.SweptSurface"]=kb,kb.__name__=["verb","geom","SweptSurface"],kb.__super__=ab,kb.prototype=d(ab.prototype,{profile:function(){return this._profile},rail:function(){return this._rail},__class__:kb});var lb,mb=0;g.Math=Math,String.prototype.__class__=g.String=String,String.__name__=["String"],g.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=g.Date=Date,Date.__name__=["Date"];var nb=g.Int={__name__:["Int"]},ob=g.Dynamic={__name__:["Dynamic"]},pb=g.Float=Number;pb.__name__=["Float"];var qb=g.Bool=Boolean;qb.__ename__=["Bool"];var rb=g.Class={__name__:["Class"]},sb={};null==Array.prototype.map&&(Array.prototype.map=function(a){for(var b=[],c=0,d=this.length;d>c;){var e=c++;b[e]=a(this[e])}return b}),null==Array.prototype.filter&&(Array.prototype.filter=function(a){for(var b=[],c=0,d=this.length;d>c;){var e=c++,f=this[e];a(f)&&b.push(f)}return b});var tb={},ub=c.ArrayBuffer||F;null==ub.prototype.slice&&(ub.prototype.slice=F.sliceImpl);var vb=(c.DataView||G,c.Uint8Array||H._new);!function(a,b){function c(a){return o[n]=d.apply(b,a),n++}function d(a){var c=[].slice.call(arguments,1);return function(){"function"==typeof a?a.apply(b,c):new Function(""+a)()}}function e(a){if(p)setTimeout(d(e,a),0);else{var b=o[a];if(b){p=!0;try{b()}finally{f(a),p=!1}}}}function f(a){delete o[a]}function g(){m=function(){var a=c(arguments);return process.nextTick(d(e,a)),a}}function h(){if(a.postMessage&&!a.importScripts){var b=!0,c=a.onmessage;return a.onmessage=function(){b=!1},a.postMessage("","*"),a.onmessage=c,b}}function i(){var b="setImmediate$"+Math.random()+"$",d=function(c){c.source===a&&"string"==typeof c.data&&0===c.data.indexOf(b)&&e(+c.data.slice(b.length))};a.addEventListener?a.addEventListener("message",d,!1):a.attachEvent("onmessage",d),m=function(){var d=c(arguments);return a.postMessage(b+d,"*"),d}}function j(){var a=new MessageChannel;a.port1.onmessage=function(a){var b=a.data;e(b)},m=function(){var b=c(arguments);return a.port2.postMessage(b),b}}function k(){var a=q.documentElement;m=function(){var b=c(arguments),d=q.createElement("script");return d.onreadystatechange=function(){e(b),d.onreadystatechange=null,a.removeChild(d),d=null},a.appendChild(d),b}}function l(){m=function(){var a=c(arguments);return setTimeout(d(e,a),0),a}}if(!a.setImmediate){var m,n=1,o={},p=!1,q=a.document,r=Object.getPrototypeOf&&Object.getPrototypeOf(a);r=r&&r.setTimeout?r:a,"[object process]"==={}.toString.call(a.process)?g():h()?i():a.MessageChannel?j():q&&"onreadystatechange"in q.createElement("script")?k():l(),r.setImmediate=m,r.clearImmediate=f}}(new Function("return this")()),u.USE_CACHE=!1,u.USE_ENUM_INDEX=!1,u.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",v.DEFAULT_RESOLVER=q,v.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",x.count=0,C.i64tmp=function(a){var b,c=new s(0,0);return b=c}(this),E.__toStr={}.toString,H.BYTES_PER_ELEMENT=1,N.queue=new k,R.memo=new w,T.TOLERANCE=1e-6,T.EPSILON=1e-10,T.VERSION="2.0.0",Ea.Tvalues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],Ea.Cvalues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],Ta.THREADS=1,Ta._init=!1,Ua.basePath="",Va.uuid=0,P.main()}("undefined"!=typeof console?console:{log:function(){}},a,"undefined"!=typeof c?c:"undefined"!=typeof b?b:"undefined"!=typeof self?self:this),a});