/*! verb 2021-02-21 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.verb=a()}}(function(){var a={},b=this,c=(new Function("try {return this===window;}catch(e){ return false;}"),new Function("try {return this===global;}catch(e){return false;}")),d=new Function("try {return typeof importScripts === 'function';}catch(e){return false;}");if(c()&&d(),c()||d()){var e=b;if(d()){var f=function(a,c){var d=b;return a.split(".").forEach(function(a){d&&(d=d[a])}),d?d[c]:null};onmessage=function(a){if(a.data.className&&a.data.methodName){var b=f(a.data.className,a.data.methodName);if(!b)return console.error("could not find "+a.data.className+"."+a.data.methodName);postMessage({result:b.apply(null,a.data.args),id:a.data.id})}}}}return function(a,b){"use strict";function c(a){return o[n]=d.apply(b,a),n++}function d(a){var c=[].slice.call(arguments,1);return function(){"function"==typeof a?a.apply(b,c):new Function(""+a)()}}function e(a){if(p)setTimeout(d(e,a),0);else{var b=o[a];if(b){p=!0;try{b()}finally{f(a),p=!1}}}}function f(a){delete o[a]}function g(){m=function(){var a=c(arguments);return process.nextTick(d(e,a)),a}}function h(){if(a.postMessage&&!a.importScripts){var b=!0,c=a.onmessage;return a.onmessage=function(){b=!1},a.postMessage("","*"),a.onmessage=c,b}}function i(){var b="setImmediate$"+Math.random()+"$",d=function(c){c.source===a&&"string"==typeof c.data&&0===c.data.indexOf(b)&&e(+c.data.slice(b.length))};a.addEventListener?a.addEventListener("message",d,!1):a.attachEvent("onmessage",d),m=function(){var d=c(arguments);return a.postMessage(b+d,"*"),d}}function j(){var a=new MessageChannel;a.port1.onmessage=function(a){e(a.data)},m=function(){var b=c(arguments);return a.port2.postMessage(b),b}}function k(){var a=q.documentElement;m=function(){var b=c(arguments),d=q.createElement("script");return d.onreadystatechange=function(){e(b),d.onreadystatechange=null,a.removeChild(d),d=null},a.appendChild(d),b}}function l(){m=function(){var a=c(arguments);return setTimeout(d(e,a),0),a}}if(!a.setImmediate){var m,n=1,o={},p=!1,q=a.document,r=Object.getPrototypeOf&&Object.getPrototypeOf(a);r=r&&r.setTimeout?r:a,"[object process]"==={}.toString.call(a.process)?g():h()?i():a.MessageChannel?j():q&&"onreadystatechange"in q.createElement("script")?k():l(),r.setImmediate=m,r.clearImmediate=f}}(new Function("return this")()),function(a,b){"use strict";function c(a,b){var c=Object.create(a);for(var d in b)c[d]=b[d];return b.toString!==Object.prototype.toString&&(c.toString=b.toString),c}function d(a){return a instanceof Array?new D(a):a.iterator()}function e(a,c){if(null==c)return null;null==c.__id__&&(c.__id__=b.$haxeUID++);var d;return null==a.hx__closures__?a.hx__closures__={}:d=a.hx__closures__[c.__id__],null==d&&(d=c.bind(a),a.hx__closures__[c.__id__]=d),d}a.promhx=a.promhx||{},a.eval=a.eval||{},a.core=a.core||{},a.exe=a.exe||{},a.geom=a.geom||{};var f,g={},h=function(){return E.__string_rec(this,"")},i=i||{},j=function(){};g.HxOverrides=j,j.__name__="HxOverrides",j.strDate=function(a){switch(a.length){case 8:var b=a.split(":"),c=new Date;return c.setTime(0),c.setUTCHours(b[0]),c.setUTCMinutes(b[1]),c.setUTCSeconds(b[2]),c;case 10:var b=a.split("-");return new Date(b[0],b[1]-1,b[2],0,0,0);case 19:var b=a.split(" "),d=b[0].split("-"),e=b[1].split(":");return new Date(d[0],d[1]-1,d[2],e[0],e[1],e[2]);default:throw r.thrown("Invalid date format : "+a)}},j.cca=function(a,b){var c=a.charCodeAt(b);if(c==c)return c},j.substr=function(a,b,c){if(null==c)c=a.length;else if(c<0){if(0!=b)return"";c=a.length+c}return a.substr(b,c)},j.now=function(){return Date.now()};var k=function(){};g.Lambda=k,k.__name__="Lambda",k.fold=function(a,b,c){for(var e=d(a);e.hasNext();){c=b(e.next(),c)}return c},Math.__name__="Math";var l=function(){};g.Reflect=l,l.__name__="Reflect",l.field=function(a,b){try{return a[b]}catch(c){return null}},l.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty;for(var d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b},l.isFunction=function(a){return"function"==typeof a&&!(a.__name__||a.__ename__)},l.deleteField=function(a,b){return!!Object.prototype.hasOwnProperty.call(a,b)&&(delete a[b],!0)};var m=function(){};g.Std=m,m.__name__="Std",m.string=function(a){return E.__string_rec(a,"")};var n=function(){this.b=""};g.StringBuf=n,n.__name__="StringBuf",n.prototype={__class__:n};var o=i.ValueType={__ename__:"ValueType",__constructs__:null,TNull:{_hx_name:"TNull",_hx_index:0,__enum__:"ValueType",toString:h},TInt:{_hx_name:"TInt",_hx_index:1,__enum__:"ValueType",toString:h},TFloat:{_hx_name:"TFloat",_hx_index:2,__enum__:"ValueType",toString:h},TBool:{_hx_name:"TBool",_hx_index:3,__enum__:"ValueType",toString:h},TObject:{_hx_name:"TObject",_hx_index:4,__enum__:"ValueType",toString:h},TFunction:{_hx_name:"TFunction",_hx_index:5,__enum__:"ValueType",toString:h},TClass:(f=function(a){return{_hx_index:6,c:a,__enum__:"ValueType",toString:h}},f._hx_name="TClass",f.__params__=["c"],f),TEnum:(f=function(a){return{_hx_index:7,e:a,__enum__:"ValueType",toString:h}},f._hx_name="TEnum",f.__params__=["e"],f),TUnknown:{_hx_name:"TUnknown",_hx_index:8,__enum__:"ValueType",toString:h}};o.__constructs__=[o.TNull,o.TInt,o.TFloat,o.TBool,o.TObject,o.TFunction,o.TClass,o.TEnum,o.TUnknown];var p=function(){};g.Type=p,p.__name__="Type",p.createEnum=function(a,b,c){var d=l.field(a,b);if(null==d)throw r.thrown("No such constructor "+b);if(l.isFunction(d)){if(null==c)throw r.thrown("Constructor "+b+" need parameters");return d.apply(a,c)}if(null!=c&&0!=c.length)throw r.thrown("Constructor "+b+" does not need parameters");return d},p.typeof=function(a){switch(typeof a){case"boolean":return o.TBool;case"function":return a.__name__||a.__ename__?o.TObject:o.TFunction;case"number":return Math.ceil(a)==a%2147483648?o.TInt:o.TFloat;case"object":if(null==a)return o.TNull;var b=a.__enum__;if(null!=b)return o.TEnum(i[b]);var c=E.getClass(a);return null!=c?o.TClass(c):o.TObject;case"string":return o.TClass(String);case"undefined":return o.TNull;default:return o.TUnknown}},p.enumParameters=function(a){var b=i[a.__enum__],c=b.__constructs__[a._hx_index].__params__;if(null!=c){for(var d=[],e=0;e<c.length;){var f=c[e];++e,d.push(a[f])}return d}return[]};var q=function(){};g["haxe.IMap"]=q,q.__name__="haxe.IMap",q.__isInterface__=!0;var r=function(a,b,c){Error.call(this,a),this.message=a,this.__previousException=b,this.__nativeException=null!=c?c:this};g["haxe.Exception"]=r,r.__name__="haxe.Exception",r.caught=function(a){return a instanceof r?a:a instanceof Error?new r(a.message,null,a):new v(a,null,a)},r.thrown=function(a){return a instanceof r?a.get_native():a instanceof Error?a:new v(a)},r.__super__=Error,r.prototype=c(Error.prototype,{unwrap:function(){return this.__nativeException},get_native:function(){return this.__nativeException},__class__:r});var s=function(){this.buf=new n,this.cache=[],this.useCache=s.USE_CACHE,this.useEnumIndex=s.USE_ENUM_INDEX,this.shash=new B,this.scount=0};g["haxe.Serializer"]=s,s.__name__="haxe.Serializer",s.prototype={toString:function(){return this.buf.b},serializeString:function(a){var b=this.shash.h[a];if(null!=b)return this.buf.b+="R",void(this.buf.b+=null==b?"null":""+b);this.shash.h[a]=this.scount++,this.buf.b+="y",a=encodeURIComponent(a),this.buf.b+=m.string(a.length),this.buf.b+=":",this.buf.b+=null==a?"null":""+a},serializeRef:function(a){for(var b=typeof a,c=0,d=this.cache.length;c<d;){var e=c++,f=this.cache[e];if(typeof f==b&&f==a)return this.buf.b+="r",this.buf.b+=null==e?"null":""+e,!0}return this.cache.push(a),!1},serializeFields:function(a){for(var b=0,c=l.fields(a);b<c.length;){var d=c[b];++b,this.serializeString(d),this.serialize(l.field(a,d))}this.buf.b+="g"},serialize:function(a){var b=p.typeof(a);switch(b._hx_index){case 0:this.buf.b+="n";break;case 1:var c=a;if(0==c)return void(this.buf.b+="z");this.buf.b+="i",this.buf.b+=null==c?"null":""+c;break;case 2:var c=a;isNaN(c)?this.buf.b+="k":isFinite(c)?(this.buf.b+="d",this.buf.b+=null==c?"null":""+c):this.buf.b+=c<0?"m":"p";break;case 3:this.buf.b+=a?"t":"f";break;case 4:if(E.__instanceof(a,jb)){var d=a.__name__;this.buf.b+="A",this.serializeString(d)}else if(E.__instanceof(a,kb))this.buf.b+="B",this.serializeString(a.__ename__);else{if(this.useCache&&this.serializeRef(a))return;this.buf.b+="o",this.serializeFields(a)}break;case 5:throw r.thrown("Cannot serialize function");case 6:var e=b.c;if(e==String)return void this.serializeString(a);if(this.useCache&&this.serializeRef(a))return;switch(e){case Array:var f=0;this.buf.b+="a";for(var g=a.length,h=0,k=g;h<k;){var n=h++;null==a[n]?++f:(f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==f?"null":""+f),f=0),this.serialize(a[n]))}f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==f?"null":""+f)),this.buf.b+="h";break;case Date:var o=a;this.buf.b+="v",this.buf.b+=m.string(o.getTime());break;case w:this.buf.b+="q";for(var c=a,q=c.keys();q.hasNext();){var t=q.next();this.buf.b+=":",this.buf.b+=null==t?"null":""+t,this.serialize(c.h[t])}this.buf.b+="h";break;case x:this.buf.b+="l";for(var c=a,u=c.h;null!=u;){var v=u.item;u=u.next;var n=v;this.serialize(n)}this.buf.b+="h";break;case z:this.buf.b+="M";for(var c=a,q=c.keys();q.hasNext();){var t=q.next(),y=l.field(t,"__id__");l.deleteField(t,"__id__"),this.serialize(t),t.__id__=y,this.serialize(c.h[t.__id__])}this.buf.b+="h";break;case B:this.buf.b+="b";for(var c=a,A=c.h,D=Object.keys(A),F=D.length,G=0;G<F;){var q=D[G++];this.serializeString(q),this.serialize(c.h[q])}this.buf.b+="h";break;case C:var c=a;this.buf.b+="s",this.buf.b+=m.string(Math.ceil(8*c.length/6)),this.buf.b+=":";var n=0,H=c.length-2,I=s.BASE64_CODES;if(null==I){I=new Array(s.BASE64.length);for(var h=0,k=s.BASE64.length;h<k;){var J=h++;I[J]=j.cca(s.BASE64,J)}s.BASE64_CODES=I}for(;n<H;){var K=c.b[n++],L=c.b[n++],M=c.b[n++];this.buf.b+=String.fromCodePoint(I[K>>2]),this.buf.b+=String.fromCodePoint(I[63&(K<<4|L>>4)]),this.buf.b+=String.fromCodePoint(I[63&(L<<2|M>>6)]),this.buf.b+=String.fromCodePoint(I[63&M])}if(n==H){var K=c.b[n++],L=c.b[n++];this.buf.b+=String.fromCodePoint(I[K>>2]),this.buf.b+=String.fromCodePoint(I[63&(K<<4|L>>4)]),this.buf.b+=String.fromCodePoint(I[L<<2&63])}else if(n==H+1){var K=c.b[n++];this.buf.b+=String.fromCodePoint(I[K>>2]),this.buf.b+=String.fromCodePoint(I[K<<4&63])}break;default:this.useCache&&this.cache.pop(),null!=a.hxSerialize?(this.buf.b+="C",this.serializeString(e.__name__),this.useCache&&this.cache.push(a),a.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(e.__name__),this.useCache&&this.cache.push(a),this.serializeFields(a))}break;case 7:var N=b.e;if(this.useCache){if(this.serializeRef(a))return;this.cache.pop()}if(this.buf.b+=m.string(this.useEnumIndex?"j":"w"),this.serializeString(N.__ename__),this.useEnumIndex)this.buf.b+=":",this.buf.b+=m.string(a._hx_index);else{var N=a;this.serializeString(i[N.__enum__].__constructs__[N._hx_index]._hx_name)}this.buf.b+=":";var O=p.enumParameters(a);this.buf.b+=m.string(O.length);for(var b=0;b<O.length;){var P=O[b];++b,this.serialize(P)}this.useCache&&this.cache.push(a);break;default:throw r.thrown("Cannot serialize "+m.string(a))}},__class__:s};var t=function(){};g["haxe._Unserializer.DefaultResolver"]=t,t.__name__="haxe._Unserializer.DefaultResolver",t.prototype={resolveClass:function(a){return g[a]},resolveEnum:function(a){return i[a]},__class__:t};var u=function(a){this.buf=a,this.length=this.buf.length,this.pos=0,this.scache=[],this.cache=[];var b=u.DEFAULT_RESOLVER;null==b&&(b=new t,u.DEFAULT_RESOLVER=b),this.resolver=b};g["haxe.Unserializer"]=u,u.__name__="haxe.Unserializer",u.initCodes=function(){for(var a=[],b=0,c=u.BASE64.length;b<c;){var d=b++;a[u.BASE64.charCodeAt(d)]=d}return a},u.prototype={readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45!=d){if(d<48||d>57)break;a=10*a+(d-48),this.pos++}else{if(this.pos!=c)break;b=!0,this.pos++}}return b&&(a*=-1),a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(b!=b)break;if(!(b>=43&&b<58||101==b||69==b))break;this.pos++}return parseFloat(j.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw r.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw r.thrown("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.buf.charCodeAt(this.pos++))throw r.thrown("Invalid enum format");var c=this.readDigits();if(0==c)return p.createEnum(a,b);for(var d=[];c-- >0;)d.push(this.unserialize());return p.createEnum(a,b,d)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw r.thrown("Class not found "+a);return b;case 66:var a=this.unserialize(),c=this.resolver.resolveEnum(a);if(null==c)throw r.thrown("Enum not found "+a);return c;case 67:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw r.thrown("Class not found "+a);var d=Object.create(b.prototype);if(this.cache.push(d),d.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw r.thrown("Invalid custom data");return d;case 77:var e=new z;this.cache.push(e);for(var f=this.buf;104!=this.buf.charCodeAt(this.pos);){var g=this.unserialize();e.set(g,this.unserialize())}return this.pos++,e;case 82:var h=this.readDigits();if(h<0||h>=this.scache.length)throw r.thrown("Invalid string reference");return this.scache[h];case 97:var f=this.buf,i=[];for(this.cache.push(i);;){var k=this.buf.charCodeAt(this.pos);if(104==k){this.pos++;break}if(117==k){this.pos++;var h=this.readDigits();i[i.length+h-1]=null}else i.push(this.unserialize())}return i;case 98:var e=new B;this.cache.push(e);for(var f=this.buf;104!=this.buf.charCodeAt(this.pos);){var g=this.unserialize(),l=this.unserialize();e.h[g]=l}return this.pos++,e;case 99:var a=this.unserialize(),b=this.resolver.resolveClass(a);if(null==b)throw r.thrown("Class not found "+a);var d=Object.create(b.prototype);return this.cache.push(d),this.unserializeObject(d),d;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var a=this.unserialize(),m=this.resolver.resolveEnum(a);if(null==m)throw r.thrown("Enum not found "+a);this.pos++;for(var n=this.readDigits(),o=m.__constructs__,p=new Array(o.length),q=0,s=o.length;q<s;){var t=q++;p[t]=o[t]._hx_name}var v=p[n];if(null==v)throw r.thrown("Unknown enum index "+a+"@"+n);var c=this.unserializeEnum(m,v);return this.cache.push(c),c;case 107:return NaN;case 108:var y=new x;this.cache.push(y);for(var f=this.buf;104!=this.buf.charCodeAt(this.pos);)y.add(this.unserialize());return this.pos++,y;case 109:return-1/0;case 110:return null;case 111:var d={};return this.cache.push(d),this.unserializeObject(d),d;case 112:return 1/0;case 113:var e=new w;this.cache.push(e);for(var f=this.buf,k=this.buf.charCodeAt(this.pos++);58==k;){var t=this.readDigits(),l=this.unserialize();e.h[t]=l,k=this.buf.charCodeAt(this.pos++)}if(104!=k)throw r.thrown("Invalid IntMap format");return e;case 114:var h=this.readDigits();if(h<0||h>=this.cache.length)throw r.thrown("Invalid reference");return this.cache[h];case 115:var A=this.readDigits(),f=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<A)throw r.thrown("Invalid bytes length");var D=u.CODES;null==D&&(D=u.initCodes(),u.CODES=D);for(var t=this.pos,E=3&A,F=3*(A>>2)+(E>=2?E-1:0),G=t+(A-E),H=new C(new ArrayBuffer(F)),I=0;t<G;){var J=D[f.charCodeAt(t++)],K=D[f.charCodeAt(t++)];H.b[I++]=J<<2|K>>4;var L=D[f.charCodeAt(t++)];H.b[I++]=K<<4|L>>2;var M=D[f.charCodeAt(t++)];H.b[I++]=L<<6|M}if(E>=2){var J=D[f.charCodeAt(t++)],K=D[f.charCodeAt(t++)];if(H.b[I++]=J<<2|K>>4,3==E){var L=D[f.charCodeAt(t++)];H.b[I++]=K<<4|L>>2}}return this.pos+=A,this.cache.push(H),H;case 116:return!0;case 118:var N;return this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(N=j.strDate(j.substr(this.buf,this.pos,19)),this.pos+=19):N=new Date(this.readFloat()),this.cache.push(N),N;case 119:var a=this.unserialize(),m=this.resolver.resolveEnum(a);if(null==m)throw r.thrown("Enum not found "+a);var c=this.unserializeEnum(m,this.unserialize());return this.cache.push(c),c;case 120:throw r.thrown(this.unserialize());case 121:var A=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<A)throw r.thrown("Invalid string length");var g=j.substr(this.buf,this.pos,A);return this.pos+=A,g=decodeURIComponent(g.split("+").join(" ")),this.scache.push(g),g;case 122:return 0}throw this.pos--,r.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:u};var v=function(a,b,c){r.call(this,String(a),b,c),this.value=a};g["haxe.ValueException"]=v,v.__name__="haxe.ValueException",v.__super__=r,v.prototype=c(r.prototype,{unwrap:function(){return this.value},__class__:v});var w=function(){this.h={}};g["haxe.ds.IntMap"]=w,w.__name__="haxe.ds.IntMap",w.__interfaces__=[q],w.prototype={remove:function(a){return!!this.h.hasOwnProperty(a)&&(delete this.h[a],!0)},keys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(0|b);return new D(a)},__class__:w};var x=function(){this.length=0};g["haxe.ds.List"]=x,x.__name__="haxe.ds.List",x.prototype={add:function(a){var b=new y(a,null);null==this.h?this.h=b:this.q.next=b,this.q=b,this.length++},pop:function(){if(null==this.h)return null;var a=this.h.item;return this.h=this.h.next,null==this.h&&(this.q=null),this.length--,a},isEmpty:function(){return null==this.h},__class__:x};var y=function(a,b){this.item=a,this.next=b};g["haxe.ds._List.ListNode"]=y,y.__name__="haxe.ds._List.ListNode",y.prototype={__class__:y};var z=function(){this.h={__keys__:{}}};g["haxe.ds.ObjectMap"]=z,z.__name__="haxe.ds.ObjectMap",z.__interfaces__=[q],z.prototype={set:function(a,c){var d=a.__id__;null==d&&(d=a.__id__=b.$haxeUID++),this.h[d]=c,this.h.__keys__[d]=a},keys:function(){var a=[];for(var b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return new D(a)},__class__:z};var A=i["haxe.ds.Option"]={__ename__:"haxe.ds.Option",__constructs__:null,Some:(f=function(a){return{_hx_index:0,v:a,__enum__:"haxe.ds.Option",toString:h}},f._hx_name="Some",f.__params__=["v"],f),None:{_hx_name:"None",_hx_index:1,__enum__:"haxe.ds.Option",toString:h}};A.__constructs__=[A.Some,A.None];var B=function(){this.h=Object.create(null)};g["haxe.ds.StringMap"]=B,B.__name__="haxe.ds.StringMap",B.__interfaces__=[q],B.prototype={__class__:B};var C=function(a){this.length=a.byteLength,this.b=new Uint8Array(a),this.b.bufferValue=a,a.hxBytes=this,a.bytes=this.b};g["haxe.io.Bytes"]=C,C.__name__="haxe.io.Bytes",C.prototype={__class__:C};var D=function(a){this.current=0,this.array=a};g["haxe.iterators.ArrayIterator"]=D,D.__name__="haxe.iterators.ArrayIterator",D.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:D};var E=function(){};g["js.Boot"]=E,E.__name__="js.Boot",E.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;var c=E.__nativeClassName(a);return null!=c?E.__resolveNativeClass(c):null},E.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"function":return"<function>";case"object":if(a.__enum__){var d=i[a.__enum__],e=d.__constructs__[a._hx_index],f=e._hx_name;return e.__params__?(b+="\t",f+"("+function(c){for(var d=[],f=0,g=e.__params__;;){if(!(f<g.length))break;var h=g[f];f+=1,d.push(E.__string_rec(a[h],b))}return d}().join(",")+")"):f}if(a instanceof Array){var g="[";b+="\t";for(var h=0,j=a.length;h<j;){var k=h++;g+=(k>0?",":"")+E.__string_rec(a[k],b)}return g+="]"}var l;try{l=a.toString}catch(h){return"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var m=a.toString();if("[object Object]"!=m)return m}var g="{\n";b+="\t";var n=null!=a.hasOwnProperty,o=null;for(o in a)n&&!a.hasOwnProperty(o)||"prototype"!=o&&"__class__"!=o&&"__super__"!=o&&"__interfaces__"!=o&&"__properties__"!=o&&(2!=g.length&&(g+=", \n"),g+=b+o+" : "+E.__string_rec(a[o],b));return b=b.substring(1),g+="\n"+b+"}";case"string":return a;default:return String(a)}},E.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,g=c[f];if(g==b||E.__interfLoop(g,b))return!0}return E.__interfLoop(a.__super__,b)},E.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array;case ib:return"boolean"==typeof a;case gb:return null!=a;case hb:return"number"==typeof a;case fb:return"number"==typeof a&&(0|a)===a;case String:return"string"==typeof a;default:if(null==a)return!1;if("function"==typeof b){if(E.__downcastCheck(a,b))return!0}else if("object"==typeof b&&E.__isNativeObj(b)&&a instanceof b)return!0;return b==jb&&null!=a.__name__||(b==kb&&null!=a.__ename__||null!=a.__enum__&&i[a.__enum__]==b)}},E.__downcastCheck=function(a,b){return a instanceof b||!!b.__isInterface__&&E.__interfLoop(E.getClass(a),b)},E.__nativeClassName=function(a){var b=E.__toStr.call(a).slice(8,-1);return"Object"==b||"Function"==b||"Math"==b||"JSON"==b?null:b},E.__isNativeObj=function(a){return null!=E.__nativeClassName(a)},E.__resolveNativeClass=function(a){return b[a]};var F=function(a){if(this._resolved=!1,this._pending=!1,this._errorPending=!1,this._fulfilled=!1,this._update=[],this._error=[],this._errored=!1,null!=a){var b=this,c=function(a){return a};a._update.push({async:b,linkf:function(a){b.handleResolve(c(a))}}),F.immediateLinkUpdate(a,b,c)}};g["promhx.base.AsyncBase"]=F,F.__name__="promhx.base.AsyncBase",F.link=function(a,b,c){a._update.push({async:b,linkf:function(a){b.handleResolve(c(a))}}),F.immediateLinkUpdate(a,b,c)},F.immediateLinkUpdate=function(a,b,c){if(a._errored&&!a._errorPending&&a._error.length<=0&&b.handleError(a._errorVal),a._resolved&&!a._pending)try{b.handleResolve(c(a._val))}catch(e){var d=r.caught(e).unwrap();b.handleError(d)}},F.linkAll=function(a,b){for(var c=function(c,e,f){if(0==c.length||F.allFulfilled(c)){for(var g=[],h=d(a);h.hasNext();){var i=h.next();g.push(i==e?f:i._val)}var j=g;b.handleResolve(j)}},e=d(a);e.hasNext();){for(var f=e.next(),g=f._update,h=b,i=[c],j=[],k=d(a);k.hasNext();){var l=k.next();l!=f&&j.push(l)}g.push({async:h,linkf:function(a,b,c){return function(d){a[0](c[0],b[0],d)}}(i,[f],[j])})}if(F.allFulfilled(a)){for(var h=b,j=[],e=d(a);e.hasNext();){var f=e.next();j.push(f._val)}h.handleResolve(j)}},F.pipeLink=function(a,b,c){var d=!1,f=function(a){if(!d){d=!0;var f=c(a);f._update.push({async:b,linkf:e(b,b.handleResolve)}),F.immediateLinkUpdate(f,b,function(a){return a})}};if(a._update.push({async:b,linkf:f}),a._resolved&&!a._pending)try{f(a._val)}catch(h){var g=r.caught(h).unwrap();b.handleError(g)}},F.allResolved=function(a){for(var b=d(a);b.hasNext();){if(!b.next()._resolved)return!1}return!0},F.allFulfilled=function(a){for(var b=d(a);b.hasNext();){if(!b.next()._fulfilled)return!1}return!0},F.prototype={catchError:function(a){return this._error.push(a),this},errorThen:function(a){return this._errorMap=a,this},isResolved:function(){return this._resolved},isErrored:function(){return this._errored},isErrorHandled:function(){return this._error.length>0},isErrorPending:function(){return this._errorPending},isFulfilled:function(){return this._fulfilled},isPending:function(){return this._pending},handleResolve:function(a){this._resolve(a)},_resolve:function(a){var b=this;if(this._pending){var c=e(this,this._resolve),d=a,f=function(){c(d)};K.queue.add(f),K.continueOnNextLoop()}else this._resolved=!0,this._pending=!0,K.queue.add(function(){b._val=a;for(var c=0,d=b._update;c<d.length;){var e=d[c];++c;try{e.linkf(a)}catch(g){var f=r.caught(g).unwrap();e.async.handleError(f)}}b._fulfilled=!0,b._pending=!1}),K.continueOnNextLoop()},handleError:function(a){this._handleError(a)},_handleError:function(a){var b=this,c=function(a){if(b._error.length>0)for(var c=0,d=b._error;c<d.length;){var e=d[c];++c,e(a)}else{if(!(b._update.length>0))throw r.thrown(a);for(var c=0,d=b._update;c<d.length;){var f=d[c];++c,f.async.handleError(a)}}b._errorPending=!1};this._errorPending||(this._errorPending=!0,this._errored=!0,this._errorVal=a,K.queue.add(function(){if(null!=b._errorMap)try{b._resolve(b._errorMap(a))}catch(e){var d=r.caught(e).unwrap();c(d)}else c(a)}),K.continueOnNextLoop())},then:function(a){var b=new F(null),c=b,d=a;return this._update.push({async:c,linkf:function(a){c.handleResolve(d(a))}}),F.immediateLinkUpdate(this,c,d),b},unlink:function(a){var b=this;K.queue.add(function(){for(var c=[],d=0,e=b._update;d<e.length;){var f=e[d];++d,f.async!=a&&c.push(f)}b._update=c}),K.continueOnNextLoop()},isLinked:function(a){for(var b=!1,c=0,d=this._update;c<d.length;){var e=d[c];if(++c,e.async==a)return!0}return b},__class__:F};var G=a.promhx.Deferred=function(){F.call(this)};g["promhx.Deferred"]=G,G.__name__="promhx.Deferred",G.__super__=F,G.prototype=c(F.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},promise:function(){return new H(this)},stream:function(){return new I(this)},publicStream:function(){return new J(this)},__class__:G});var H=a.promhx.Promise=function(a){F.call(this,a),this._rejected=!1};g["promhx.Promise"]=H,H.__name__="promhx.Promise",H.whenAll=function(a){for(var b=new H(null),c=a,e=b,f=function(a,b,f){if(0==a.length||F.allFulfilled(a)){for(var g=[],h=d(c);h.hasNext();){var i=h.next();g.push(i==b?f:i._val)}var j=g;e.handleResolve(j)}},g=d(c);g.hasNext();){for(var h=g.next(),i=h._update,j=e,k=[f],l=[],m=d(c);m.hasNext();){var n=m.next();n!=h&&l.push(n)}i.push({async:j,linkf:function(a,b,c){return function(d){c[0](b[0],a[0],d)}}([h],[l],k)})}if(F.allFulfilled(c)){for(var j=e,l=[],g=d(c);g.hasNext();){var h=g.next();l.push(h._val)}j.handleResolve(l)}return b},H.promise=function(a){var b=new H;return b.handleResolve(a),b},H.__super__=F,H.prototype=c(F.prototype,{isRejected:function(){return this._rejected},reject:function(a){this._rejected=!0,this.handleError(a)},handleResolve:function(a){if(this._resolved){throw r.thrown(L.AlreadyResolved("Promise has already been resolved"))}this._resolve(a)},then:function(a){var b=new H(null),c=b,d=a;return this._update.push({async:c,linkf:function(a){c.handleResolve(d(a))}}),F.immediateLinkUpdate(this,c,d),b},unlink:function(a){var b=this;K.queue.add(function(){if(b._fulfilled){for(var c=[],d=0,e=b._update;d<e.length;){var f=e[d];++d,f.async!=a&&c.push(f)}b._update=c}else{b.handleError(L.DownstreamNotFullfilled("Downstream Promise is not fullfilled"))}}),K.continueOnNextLoop()},handleError:function(a){this._rejected=!0,this._handleError(a)},pipe:function(a){var b=new H(null),c=b,d=a,f=!1,g=function(a){if(!f){f=!0;var b=d(a);b._update.push({async:c,linkf:e(c,c.handleResolve)}),F.immediateLinkUpdate(b,c,function(a){return a})}};if(this._update.push({async:c,linkf:g}),this._resolved&&!this._pending)try{g(this._val)}catch(i){var h=r.caught(i).unwrap();c.handleError(h)}return b},errorPipe:function(a){var b=new H;return this.catchError(function(c){a(c).then(e(b,b._resolve))}),this.then(e(b,b._resolve)),b},__class__:H});var I=a.promhx.Stream=function(a){F.call(this,a),this._end_promise=new H};g["promhx.Stream"]=I,I.__name__="promhx.Stream",I.foreach=function(a){for(var b=new I(null),c=d(a);c.hasNext();){var e=c.next();b.handleResolve(e)}return b.end(),b},I.wheneverAll=function(a){for(var b=new I(null),c=a,e=b,f=function(a,b,f){if(0==a.length||F.allFulfilled(a)){for(var g=[],h=d(c);h.hasNext();){var i=h.next();g.push(i==b?f:i._val)}var j=g;e.handleResolve(j)}},g=d(c);g.hasNext();){for(var h=g.next(),i=h._update,j=e,k=[f],l=[],m=d(c);m.hasNext();){var n=m.next();n!=h&&l.push(n)}i.push({async:j,linkf:function(a,b,c){return function(d){c[0](b[0],a[0],d)}}([h],[l],k)})}if(F.allFulfilled(c)){for(var j=e,l=[],g=d(c);g.hasNext();){var h=g.next();l.push(h._val)}j.handleResolve(l)}return b},I.concatAll=function(a){for(var b=new I(null),c=d(a);c.hasNext();){var e=c.next();b.concat(e)}return b},I.mergeAll=function(a){for(var b=new I(null),c=d(a);c.hasNext();){var e=c.next();b.merge(e)}return b},I.stream=function(a){var b=new I(null);return b.handleResolve(a),b},I.__super__=F,I.prototype=c(F.prototype,{then:function(a){var b=new I(null),c=b,d=a;return this._update.push({async:c,linkf:function(a){c.handleResolve(d(a))}}),F.immediateLinkUpdate(this,c,d),this._end_promise._update.push({async:b._end_promise,linkf:function(a){b.end()}}),b},detachStream:function(a){for(var b=[],c=!1,d=0,e=this._update;d<e.length;){var f=e[d];if(++d,f.async==a){for(var g=[],h=0,i=this._end_promise._update;h<i.length;){var j=i[h];++h,j.async!=a._end_promise&&g.push(j)}this._end_promise._update=g,c=!0}else b.push(f)}return this._update=b,c},first:function(){var a=new H(null);return this.then(function(b){a._resolved||a.handleResolve(b)}),a},handleResolve:function(a){this._end||this._pause||this._resolve(a)},pause:function(a){null==a&&(a=!this._pause),this._pause=a},pipe:function(a){var b=new I(null),c=b,d=a,f=!1,g=function(a){if(!f){f=!0;var b=d(a);b._update.push({async:c,linkf:e(c,c.handleResolve)}),F.immediateLinkUpdate(b,c,function(a){return a})}};if(this._update.push({async:c,linkf:g}),this._resolved&&!this._pending)try{g(this._val)}catch(i){var h=r.caught(i).unwrap();c.handleError(h)}return this._end_promise.then(function(a){b.end()}),b},errorPipe:function(a){var b=new I(null);return this.catchError(function(c){var d=a(c);d.then(e(b,b._resolve)),d._end_promise.then((f=b._end_promise,e(f,f._resolve)))}),this.then(e(b,b._resolve)),this._end_promise.then(function(a){b.end()}),b},handleEnd:function(){if(this._pending)K.queue.add(e(this,this.handleEnd)),K.continueOnNextLoop();else{if(this._end_promise._resolved)return;this._end=!0;var a=this._resolved?A.Some(this._val):A.None;this._end_promise.handleResolve(a),this._update=[],this._error=[]}},end:function(){return K.queue.add(e(this,this.handleEnd)),K.continueOnNextLoop(),this},endThen:function(a){return this._end_promise.then(a)},filter:function(a){var b=new I(null);return this._update.push({async:b,linkf:function(c){a(c)&&b.handleResolve(c)}}),F.immediateLinkUpdate(this,b,function(a){return a}),b},concat:function(a){var b=new I(null);return this._update.push({async:b,linkf:e(b,b.handleResolve)}),F.immediateLinkUpdate(this,b,function(a){return a}),this._end_promise.then(function(c){a.pipe(function(a){return b.handleResolve(a),b}),a._end_promise.then(function(a){b.end()})}),b},merge:function(a){var b=new I(null);return this._update.push({async:b,linkf:e(b,b.handleResolve)}),a._update.push({async:b,linkf:e(b,b.handleResolve)}),F.immediateLinkUpdate(this,b,function(a){return a}),F.immediateLinkUpdate(a,b,function(a){return a}),b},__class__:I});var J=a.promhx.PublicStream=function(a){I.call(this,a)};g["promhx.PublicStream"]=J,J.__name__="promhx.PublicStream",J.publicstream=function(a){var b=new J(null);return b.handleResolve(a),b},J.__super__=I,J.prototype=c(I.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},update:function(a){this.handleResolve(a)},__class__:J});var K=function(){};g["promhx.base.EventLoop"]=K,K.__name__="promhx.base.EventLoop",K.enqueue=function(a){K.queue.add(a),K.continueOnNextLoop()},K.set_nextLoop=function(a){
if(null!=K.nextLoop)throw r.thrown("nextLoop has already been set");return K.nextLoop=a,K.nextLoop},K.queueEmpty=function(){return K.queue.isEmpty()},K.finish=function(a){null==a&&(a=1e3);for(var b=null;;){var c;if(a-- >0?(b=K.queue.pop(),c=null!=b):c=!1,!c)break;b()}return K.queue.isEmpty()},K.clear=function(){K.queue=new x},K.f=function(){var a=K.queue.pop();null!=a&&a(),K.queue.isEmpty()||K.continueOnNextLoop()},K.continueOnNextLoop=function(){null!=K.nextLoop?K.nextLoop(K.f):setImmediate(K.f)};var L=i["promhx.error.PromiseError"]={__ename__:"promhx.error.PromiseError",__constructs__:null,AlreadyResolved:(f=function(a){return{_hx_index:0,message:a,__enum__:"promhx.error.PromiseError",toString:h}},f._hx_name="AlreadyResolved",f.__params__=["message"],f),DownstreamNotFullfilled:(f=function(a){return{_hx_index:1,message:a,__enum__:"promhx.error.PromiseError",toString:h}},f._hx_name="DownstreamNotFullfilled",f.__params__=["message"],f)};L.__constructs__=[L.AlreadyResolved,L.DownstreamNotFullfilled];var M=function(){};g["verb.Verb"]=M,M.__name__="verb.Verb",M.main=function(){console.log("src/verb/Verb.hx:45:","verb 2.1.0")};var N=function(){};g["verb.core.ArrayExtensions"]=N,N.__name__="verb.core.ArrayExtensions",N.alloc=function(a,b){if(!(b<0))for(;a.length<b;)a.push(null)},N.reversed=function(a){var b=a.slice();return b.reverse(),b},N.last=function(a){return a[a.length-1]},N.first=function(a){return a[0]},N.spliceAndInsert=function(a,b,c,d){a.splice(b,c),a.splice(b,0,d)},N.left=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(0,b)},N.right=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b)},N.rightWithPivot=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b-1)},N.unique=function(a,b){if(0==a.length)return[];for(var c=[a.pop()];a.length>0;){for(var d=a.pop(),e=!0,f=0;f<c.length;){var g=c[f];if(++f,b(d,g)){e=!1;break}}e&&c.push(d)}return c};var O=function(){};g["verb.core.Binomial"]=O,O.__name__="verb.core.Binomial",O.get=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;if(b>a-b&&(b=a-b),O.memo_exists(a,b))return O.get_memo(a,b);for(var c=1,d=a,e=1,f=b+1;e<f;){var g=e++;O.memo_exists(d,g)?(--a,c=O.get_memo(d,g)):(c*=a--,c/=g,O.memoize(d,g,c))}return c},O.get_no_memo=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;b>a-b&&(b=a-b);for(var c=1,d=1,e=b+1;d<e;){var f=d++;c*=a--,c/=f}return c},O.memo_exists=function(a,b){return!!O.memo.h.hasOwnProperty(a)&&O.memo.h[a].h.hasOwnProperty(b)},O.get_memo=function(a,b){return O.memo.h[a].h[b]},O.memoize=function(a,b,c){if(!O.memo.h.hasOwnProperty(a)){var d=O.memo,e=new w;d.h[a]=e}O.memo.h[a].h[b]=c};var P=a.core.BoundingBox=function(a){this.max=null,this.min=null,this.dim=3,this.initialized=!1,null!=a&&this.addRange(a)};g["verb.core.BoundingBox"]=P,P.__name__="verb.core.BoundingBox",P.intervalsOverlap=function(a,b,c,d,e){null==e&&(e=-1);var f=e<-.5?Q.TOLERANCE:e,g=Math.min(a,b)-f,h=Math.max(a,b)+f,i=Math.min(c,d)-f,j=Math.max(c,d)+f;return g>=i&&g<=j||h>=i&&h<=j||i>=g&&i<=h||j>=g&&j<=h},P.prototype={fromPoint:function(a){return new P([a])},add:function(a){if(!this.initialized)return this.dim=a.length,this.min=a.slice(0),this.max=a.slice(0),this.initialized=!0,this;for(var b=0,c=this.dim;b<c;){var d=b++;a[d]>this.max[d]&&(this.max[d]=a[d]),a[d]<this.min[d]&&(this.min[d]=a[d])}return this},addRange:function(a){for(var b=a.length,c=0,d=b;c<d;){var e=c++;this.add(a[e])}return this},contains:function(a,b){return null==b&&(b=-1),!!this.initialized&&this.intersects(new P([a]),b)},intersects:function(a,b){if(null==b&&(b=-1),!this.initialized||!a.initialized)return!1;for(var c=this.min,d=this.max,e=a.min,f=a.max,g=0,h=this.dim;g<h;){var i=g++;if(!P.intervalsOverlap(c[i],d[i],e[i],f[i],b))return!1}return!0},clear:function(){return this.initialized=!1,this},getLongestAxis:function(){for(var a=0,b=0,c=0,d=this.dim;c<d;){var e=c++,f=this.getAxisLength(e);f>a&&(a=f,b=e)}return b},getAxisLength:function(a){return a<0||a>this.dim-1?0:Math.abs(this.min[a]-this.max[a])},intersect:function(a,b){if(!this.initialized)return null;var c=this.min,d=this.max,e=a.min,f=a.max;if(!this.intersects(a,b))return null;for(var g=[],h=[],i=0,j=this.dim;i<j;){var k=i++;g.push(Math.min(d[k],f[k])),h.push(Math.max(c[k],e[k]))}return new P([h,g])},__class__:P};var Q=a.core.Constants=function(){};g["verb.core.Constants"]=Q,Q.__name__="verb.core.Constants";var R=a.core.SerializableBase=function(){};g["verb.core.SerializableBase"]=R,R.__name__="verb.core.SerializableBase",R.prototype={serialize:function(){var a=new s;return a.serialize(this),a.toString()},__class__:R};var S=a.core.Plane=function(a,b){this.origin=a,this.normal=b};g["verb.core.Plane"]=S,S.__name__="verb.core.Plane",S.__super__=R,S.prototype=c(R.prototype,{__class__:S});var T=a.core.Ray=function(a,b){this.origin=a,this.dir=b};g["verb.core.Ray"]=T,T.__name__="verb.core.Ray",T.__super__=R,T.prototype=c(R.prototype,{__class__:T});var U=a.core.NurbsCurveData=function(a,b,c){this.degree=a,this.controlPoints=c,this.knots=b};g["verb.core.NurbsCurveData"]=U,U.__name__="verb.core.NurbsCurveData",U.__super__=R,U.prototype=c(R.prototype,{__class__:U});var V=a.core.NurbsSurfaceData=function(a,b,c,d,e){this.degreeU=a,this.degreeV=b,this.knotsU=c,this.knotsV=d,this.controlPoints=e};g["verb.core.NurbsSurfaceData"]=V,V.__name__="verb.core.NurbsSurfaceData",V.__super__=R,V.prototype=c(R.prototype,{__class__:V});var W=a.core.MeshData=function(a,b,c,d){this.faces=a,this.points=b,this.normals=c,this.uvs=d};g["verb.core.MeshData"]=W,W.__name__="verb.core.MeshData",W.empty=function(){return new W([],[],[],[])},W.__super__=R,W.prototype=c(R.prototype,{__class__:W});var X=a.core.PolylineData=function(a,b){this.points=a,this.params=b};g["verb.core.PolylineData"]=X,X.__name__="verb.core.PolylineData",X.__super__=R,X.prototype=c(R.prototype,{__class__:X});var Y=a.core.VolumeData=function(a,b,c,d,e,f,g){this.degreeU=a,this.degreeV=b,this.degreeW=c,this.knotsU=d,this.knotsV=e,this.knotsW=f,this.controlPoints=g};g["verb.core.VolumeData"]=Y,Y.__name__="verb.core.VolumeData",Y.__super__=R,Y.prototype=c(R.prototype,{__class__:Y});var Z=a.core.Pair=function(a,b){this.item0=a,this.item1=b};g["verb.core.Pair"]=Z,Z.__name__="verb.core.Pair",Z.prototype={__class__:Z};var $=a.core.Interval=function(a,b){this.min=a,this.max=b};g["verb.core.Interval"]=$,$.__name__="verb.core.Interval",$.prototype={__class__:$};var _=a.core.CurveCurveIntersection=function(a,b,c,d){this.point0=a,this.point1=b,this.u0=c,this.u1=d};g["verb.core.CurveCurveIntersection"]=_,_.__name__="verb.core.CurveCurveIntersection",_.prototype={__class__:_};var aa=a.core.CurveSurfaceIntersection=function(a,b,c,d){this.u=a,this.uv=b,this.curvePoint=c,this.surfacePoint=d};g["verb.core.CurveSurfaceIntersection"]=aa,aa.__name__="verb.core.CurveSurfaceIntersection",aa.prototype={__class__:aa};var ba=a.core.MeshIntersectionPoint=function(a,b,c,d,e){this.visited=!1,this.adj=null,this.opp=null,this.uv0=a,this.uv1=b,this.point=c};g["verb.core.MeshIntersectionPoint"]=ba,ba.__name__="verb.core.MeshIntersectionPoint",ba.prototype={__class__:ba};var ca=a.core.PolylineMeshIntersection=function(a,b,c,d,e){this.point=a,this.u=b,this.uv=c,this.polylineIndex=d,this.faceIndex=e};g["verb.core.PolylineMeshIntersection"]=ca,ca.__name__="verb.core.PolylineMeshIntersection",ca.prototype={__class__:ca};var da=a.core.SurfaceSurfaceIntersectionPoint=function(a,b,c,d){this.uv0=a,this.uv1=b,this.point=c,this.dist=d};g["verb.core.SurfaceSurfaceIntersectionPoint"]=da,da.__name__="verb.core.SurfaceSurfaceIntersectionPoint",da.prototype={__class__:da};var ea=a.core.TriSegmentIntersection=function(a,b,c,d){this.point=a,this.s=b,this.t=c,this.p=d};g["verb.core.TriSegmentIntersection"]=ea,ea.__name__="verb.core.TriSegmentIntersection",ea.prototype={__class__:ea};var fa=a.core.CurveTriPoint=function(a,b,c){this.u=a,this.point=b,this.uv=c};g["verb.core.CurveTriPoint"]=fa,fa.__name__="verb.core.CurveTriPoint",fa.prototype={__class__:fa};var ga=a.core.SurfacePoint=function(a,b,c,d,e){null==e&&(e=!1),null==d&&(d=-1),this.uv=c,this.point=a,this.normal=b,this.id=d,this.degen=e};g["verb.core.SurfacePoint"]=ga,ga.__name__="verb.core.SurfacePoint",ga.fromUv=function(a,b){return new ga(null,null,[a,b])},ga.prototype={__class__:ga};var ha=a.core.CurvePoint=function(a,b){this.u=a,this.pt=b};g["verb.core.CurvePoint"]=ha,ha.__name__="verb.core.CurvePoint",ha.prototype={__class__:ha};var ia=a.core.KdTree=function(a,b){this.dim=3,this.points=a,this.distanceFunction=b,this.dim=a[0].point.length,this.root=this.buildTree(a,0,null)};g["verb.core.KdTree"]=ia,ia.__name__="verb.core.KdTree",ia.prototype={buildTree:function(a,b,c){var d=b%this.dim;if(0==a.length)return null;if(1==a.length)return new la(a[0],d,c);a.sort(function(a,b){var c=a.point[d]-b.point[d];return 0==c?0:c>0?1:-1});var e=Math.floor(a.length/2),f=new la(a[e],d,c);return f.left=this.buildTree(a.slice(0,e),b+1,f),f.right=this.buildTree(a.slice(e+1),b+1,f),f},nearest:function(a,b,c){var d=this,e=new ja(function(a){return-a.item1}),f=null;f=function(c){for(var g,h=c.dimension,i=d.distanceFunction(a,c.kdPoint.point),j=[],k=0,l=d.dim;k<l;){var m=k++;j.push(0)}for(var n,m,o=j,p=function(a,c){e.push(new Z(a,c)),e.size()>b&&e.pop()},j=0,k=d.dim;j<k;){var m=j++;m==c.dimension?o[m]=a[m]:o[m]=c.kdPoint.point[m]}var q=d.distanceFunction(o,c.kdPoint.point);if(null==c.right&&null==c.left)return void((e.size()<b||i<e.peek().item1)&&p(c,i));g=null==c.right?c.left:null==c.left?c.right:a[h]<c.kdPoint.point[h]?c.left:c.right,f(g),(e.size()<b||i<e.peek().item1)&&p(c,i),(e.size()<b||Math.abs(q)<e.peek().item1)&&null!=(n=g==c.left?c.right:c.left)&&f(n)};for(var g=0,h=b;g<h;){var i=g++;e.push(new Z(null,c))}f(this.root);for(var j=[],g=0,h=b;g<h;){var i=g++;null!=e.content[i].item0&&j.push(new Z(e.content[i].item0.kdPoint,e.content[i].item1))}return j},__class__:ia};var ja=function(a){this.content=[],this.scoreFunction=a};g["verb.core.BinaryHeap"]=ja,ja.__name__="verb.core.BinaryHeap",ja.prototype={push:function(a){this.content.push(a),this.bubbleUp(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();return this.content.length>0&&(this.content[0]=b,this.sinkDown(0)),a},peek:function(){return this.content[0]},remove:function(a){for(var b=this.content.length,c=0,d=b;c<d;){var e=c++;if(this.content[e]==a){var f=this.content.pop();return void(e!=b-1&&(this.content[e]=f,this.scoreFunction(f)<this.scoreFunction(a)?this.bubbleUp(e):this.sinkDown(e)))}}throw r.thrown("Node not found.")},size:function(){return this.content.length},bubbleUp:function(a){for(var b=this.content[a];a>0;){var c=Math.floor((a+1)/2)-1,d=this.content[c];if(!(this.scoreFunction(b)<this.scoreFunction(d)))break;this.content[c]=b,this.content[a]=d,a=c}},sinkDown:function(a){for(var b=this.content.length,c=this.content[a],d=this.scoreFunction(c);;){var e=2*(a+1),f=e-1,g=-1,h=0;if(f<b){var i=this.content[f];h=this.scoreFunction(i),h<d&&(g=f)}if(e<b){var j=this.content[e];this.scoreFunction(j)<(-1==g?d:h)&&(g=e)}if(-1==g)break;this.content[a]=this.content[g],this.content[g]=c,a=g}},__class__:ja};var ka=a.core.KdPoint=function(a,b){this.point=a,this.obj=b};g["verb.core.KdPoint"]=ka,ka.__name__="verb.core.KdPoint",ka.prototype={__class__:ka};var la=a.core.KdNode=function(a,b,c){this.kdPoint=a,this.left=null,this.right=null,this.parent=c,this.dimension=b};g["verb.core.KdNode"]=la,la.__name__="verb.core.KdNode",la.prototype={__class__:la};var ma=function(){};g["verb.eval.IBoundingBoxTree"]=ma,ma.__name__="verb.eval.IBoundingBoxTree",ma.__isInterface__=!0,ma.prototype={__class__:ma};var na=function(a,b){if(this._boundingBox=null,this._curve=a,null==b){var c=this._curve.knots;b=(N.last(c)-N.first(c))/64}this._knotTol=b};g["verb.core.LazyCurveBoundingBoxTree"]=na,na.__name__="verb.core.LazyCurveBoundingBoxTree",na.__interfaces__=[ma],na.prototype={split:function(){var a=N.first(this._curve.knots),b=N.last(this._curve.knots),c=b-a,d=Ea.curveSplit(this._curve,(b+a)/2+.1*c*Math.random());return new Z(new na(d[0],this._knotTol),new na(d[1],this._knotTol))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new P(Ga.dehomogenize1d(this._curve.controlPoints))),this._boundingBox},yield:function(){return this._curve},indivisible:function(a){var b=this._curve.knots;return N.last(b)-N.first(b)<this._knotTol},empty:function(){return!1},__class__:na};var oa=function(a,b){if(this._boundingBox=null,this._mesh=a,null==b){for(var c=[],d=0,e=a.faces.length;d<e;){var f=d++;c.push(f)}b=c}this._faceIndices=b};g["verb.core.LazyMeshBoundingBoxTree"]=oa,oa.__name__="verb.core.LazyMeshBoundingBoxTree",oa.__interfaces__=[ma],oa.prototype={split:function(){var a=ta.sortTrianglesOnLongestAxis(this.boundingBox(),this._mesh,this._faceIndices),b=N.left(a),c=N.right(a);return new Z(new oa(this._mesh,b),new oa(this._mesh,c))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=ta.makeMeshAabb(this._mesh,this._faceIndices)),this._boundingBox},yield:function(){return this._faceIndices[0]},indivisible:function(a){return 1==this._faceIndices.length},empty:function(){return 0==this._faceIndices.length},__class__:oa};var pa=function(a,b){this._boundingBox=null,this._polyline=a,null==b&&(b=new $(0,0!=a.points.length?a.points.length-1:0)),this._interval=b};g["verb.core.LazyPolylineBoundingBoxTree"]=pa,pa.__name__="verb.core.LazyPolylineBoundingBoxTree",pa.__interfaces__=[ma],pa.prototype={split:function(){var a=this._interval.min,b=this._interval.max,c=a+Math.ceil((b-a)/2),d=new $(a,c),e=new $(c,b);return new Z(new pa(this._polyline,d),new pa(this._polyline,e))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new P(this._polyline.points)),this._boundingBox},yield:function(){return this._interval.min},indivisible:function(a){return this._interval.max-this._interval.min==1},empty:function(){return this._interval.max-this._interval.min==0},__class__:pa};var qa=function(a,b,c,d){if(null==b&&(b=!1),this._boundingBox=null,this._surface=a,this._splitV=b,null==c){var e=a.knotsU;c=(N.last(e)-N.first(e))/16}if(null==d){var e=a.knotsV;d=(N.last(e)-N.first(e))/16}this._knotTolU=c,this._knotTolV=d};g["verb.core.LazySurfaceBoundingBoxTree"]=qa,qa.__name__="verb.core.LazySurfaceBoundingBoxTree",qa.__interfaces__=[ma],qa.prototype={split:function(){var a,b;this._splitV?(a=N.first(this._surface.knotsV),b=N.last(this._surface.knotsV)):(a=N.first(this._surface.knotsU),b=N.last(this._surface.knotsU));var c=(a+b)/2,d=Ea.surfaceSplit(this._surface,c,this._splitV);return new Z(new qa(d[0],!this._splitV,this._knotTolU,this._knotTolV),new qa(d[1],!this._splitV,this._knotTolU,this._knotTolV))},boundingBox:function(){if(null==this._boundingBox){this._boundingBox=new P;for(var a=0,b=this._surface.controlPoints;a<b.length;){var c=b[a];++a,this._boundingBox.addRange(Ga.dehomogenize1d(c))}}return this._boundingBox},yield:function(){return this._surface},indivisible:function(a){var b=this._surface.knotsV;if(N.last(b)-N.first(b)<this._knotTolV){var b=this._surface.knotsU;return N.last(b)-N.first(b)<this._knotTolU}return!1},empty:function(){return!1},__class__:qa};var ra=a.core.Mat=function(){};g["verb.core.Mat"]=ra,ra.__name__="verb.core.Mat",ra.mul=function(a,b){for(var c=[],d=0,e=b.length;d<e;){var f=d++;c.push(Aa.mul(a,b[f]))}return c},ra.mult=function(a,b){for(var c,d,e,f,g=a.length,h=b.length,i=b[0].length,j=[],k=g-1,l=0,m=0;k>=0;){for(c=[],d=a[k],m=i-1;m>=0;){for(e=d[h-1]*b[h-1][m],l=h-2;l>=1;)f=l-1,e+=d[l]*b[l][m]+d[f]*b[f][m],l-=2;0==l&&(e+=d[0]*b[0][m]),c[m]=e,--m}j[k]=c,--k}return j},ra.add=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Aa.add(a[f],b[f]))}return c},ra.div=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Aa.div(a[f],b))}return c},ra.sub=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Aa.sub(a[f],b[f]))}return c},ra.dot=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Aa.dot(a[f],b))}return c},ra.identity=function(a){for(var b=Aa.zeros2d(a,a),c=0,d=a;c<d;){var e=c++;b[e][e]=1}return b},ra.transpose=function(a){if(0==a.length)return[];for(var b=[],c=0,d=a[0].length;c<d;){for(var e=c++,f=[],g=0,h=a.length;g<h;){var i=g++;f.push(a[i][e])}b.push(f)}return b},ra.solve=function(a,b){return ra.LUsolve(ra.LU(a),b)},ra.LUsolve=function(a,b){for(var c,d,e,f,g=a.LU,h=g.length,i=b.slice(),j=a.P,k=h-1;-1!=k;)i[k]=b[k],--k;for(k=0;k<h;){for(d=j[k],j[k]!=k&&(f=i[k],i[k]=i[d],i[d]=f),e=g[k],c=0;c<k;)i[k]-=i[c]*e[c],++c;++k}for(k=h-1;k>=0;){for(e=g[k],c=k+1;c<h;)i[k]-=i[c]*e[c],++c;i[k]/=e[k],--k}return i},ra.LU=function(a){for(var b,c,d,e,f,g,h,i,j=(Math.abs,[]),k=0,l=a.length;k<l;){var m=k++;j.push(a[m].slice())}a=j;for(var n=a.length,o=n-1,p=[],q=0;q<n;){for(g=q,f=a[q],i=Math.abs(f[q]),c=q+1;c<n;)d=Math.abs(a[c][q]),i<d&&(i=d,g=c),++c;for(p[q]=g,g!=q&&(a[q]=a[g],a[g]=f,f=a[q]),e=f[q],b=q+1;b<n;)a[b][q]/=e,++b;for(b=q+1;b<n;){for(h=a[b],c=q+1;c<o;)h[c]-=h[q]*f[c],++c,h[c]-=h[q]*f[c],++c;c==o&&(h[c]-=h[q]*f[c]),++b}++q}return new sa(a,p)};var sa=function(a,b){this.LU=a,this.P=b};g["verb.core._Mat.LUDecomp"]=sa,sa.__name__="verb.core._Mat.LUDecomp",sa.prototype={__class__:sa};var ta=a.core.Mesh=function(){};g["verb.core.Mesh"]=ta,ta.__name__="verb.core.Mesh",ta.getTriangleNorm=function(a,b){var c=a[b[0]],d=a[b[1]],e=a[b[2]],f=Aa.sub(d,c),g=Aa.sub(e,c),h=Aa.cross(f,g);return Aa.mul(1/Aa.norm(h),h)},ta.makeMeshAabb=function(a,b){for(var c=new P,d=0;d<b.length;){var e=b[d];++d,c.add(a.points[a.faces[e][0]]),c.add(a.points[a.faces[e][1]]),c.add(a.points[a.faces[e][2]])}return c},ta.sortTrianglesOnLongestAxis=function(a,b,c){for(var d=a.getLongestAxis(),e=[],f=0;f<c.length;){var g=c[f];++f;var h=ta.getMinCoordOnAxis(b.points,b.faces[g],d);e.push(new Z(h,g))}e.sort(function(a,b){var c=a.item0,d=b.item0;return c==d?0:c>d?1:-1});for(var i=[],f=0,j=e.length;f<j;){var k=f++;i.push(e[k].item1)}return i},ta.getMinCoordOnAxis=function(a,b,c){var d=1/0,e=a[b[0]][c];e<d&&(d=e);var e=a[b[1]][c];e<d&&(d=e);var e=a[b[2]][c];return e<d&&(d=e),d},ta.getTriangleCentroid=function(a,b){var c=[0,0,0];return c[0]+=a[b[0]][0],c[1]+=a[b[0]][1],c[2]+=a[b[0]][2],c[0]+=a[b[1]][0],c[1]+=a[b[1]][1],c[2]+=a[b[1]][2],c[0]+=a[b[2]][0],c[1]+=a[b[2]][1],c[2]+=a[b[2]][2],c[0]/=3,c[1]/=3,c[2]/=3,c},ta.triangleUVFromPoint=function(a,b,c){var d=a.faces[b],e=a.points[d[0]],f=a.points[d[1]],g=a.points[d[2]],h=a.uvs[d[0]],i=a.uvs[d[1]],j=a.uvs[d[2]],k=Aa.sub(e,c),l=Aa.sub(f,c),m=Aa.sub(g,c),n=Aa.norm(Aa.cross(Aa.sub(e,f),Aa.sub(e,g))),o=Aa.norm(Aa.cross(l,m))/n,p=Aa.norm(Aa.cross(m,k))/n,q=Aa.norm(Aa.cross(k,l))/n;return Aa.add(Aa.mul(o,h),Aa.add(Aa.mul(p,i),Aa.mul(q,j)))};var ua=function(a,b){if(this._empty=!1,this._face=-1,null==b){for(var c=[],d=0,e=a.faces.length;d<e;){var f=d++;c.push(f)}b=c}if(this._boundingBox=ta.makeMeshAabb(a,b),b.length<1)return void(this._empty=!0);if(b.length<2)return void(this._face=b[0]);var g=ta.sortTrianglesOnLongestAxis(this._boundingBox,a,b),h=N.left(g),i=N.right(g);this._children=new Z(new ua(a,h),new ua(a,i))};g["verb.core.MeshBoundingBoxTree"]=ua,ua.__name__="verb.core.MeshBoundingBoxTree",ua.__interfaces__=[ma],ua.prototype={split:function(){return this._children},boundingBox:function(){return this._boundingBox},yield:function(){return this._face},indivisible:function(a){return null==this._children},empty:function(){return this._empty},__class__:ua};var va=a.core.Minimizer=function(){};g["verb.core.Minimizer"]=va,va.__name__="verb.core.Minimizer",va.uncmin=function(a,b,c,d,e){null==c&&(c=1e-8),null==d&&(d=function(b){return va.numericalGradient(a,b)}),null==e&&(e=1e3),b=b.slice(0);var f,g=b.length,h=a(b),i=h;if(isNaN(h))throw r.thrown("uncmin: f(x0) is a NaN!");c=Math.max(c,Q.EPSILON);for(var j,k,l,m,n,o,p,q,s=ra.identity(g),t=0,u=[],v="",w=d(b);t<e;){if(!Aa.all(Aa.finite(w))){v="Gradient has Infinity or NaN";break}if(j=Aa.neg(ra.dot(s,w)),!Aa.all(Aa.finite(j))){v="Search direction has Infinity or NaN";break}if((q=Aa.norm(j))<c){v="Newton step smaller than tol";break}for(p=1,f=Aa.dot(w,j),l=b;t<e&&!(p*q<c)&&(u=Aa.mul(p,j),l=Aa.add(b,u),(i=a(l))-h>=.1*p*f||isNaN(i));)p*=.5,++t;if(p*q<c){v="Line search step size smaller than tol";break}if(t==e){v="maxit reached during line search";break}k=d(l),m=Aa.sub(k,w),o=Aa.dot(m,u),n=ra.dot(s,m),s=ra.sub(ra.add(s,ra.mul((o+Aa.dot(m,n))/(o*o),va.tensor(u,u))),ra.div(ra.add(va.tensor(n,u),va.tensor(u,n)),o)),b=l,h=i,w=k,++t}return new wa(b,h,w,s,t,v)},va.numericalGradient=function(a,b){var c=b.length,d=a(b);if(NaN==d)throw r.thrown("gradient: f(x) is a NaN!");for(var e,f,g,h,i,j,k,l,m,n=b.slice(0),o=[],p=.001,q=0,s=0,t=c;s<t;)for(var e=s++,u=Math.max(1e-6*d,1e-8);;){if(++q>20)throw r.thrown("Numerical gradient fails");if(n[e]=b[e]+u,f=a(n),n[e]=b[e]-u,g=a(n),n[e]=b[e],isNaN(f)||isNaN(g))u/=16;else{if(o[e]=(f-g)/(2*u),h=b[e]-u,i=b[e],j=b[e]+u,k=(f-d)/u,l=(d-g)/u,m=Aa.max([Math.abs(o[e]),Math.abs(d),Math.abs(f),Math.abs(g),Math.abs(h),Math.abs(i),Math.abs(j),1e-8]),!(Math.min(Aa.max([Math.abs(k-o[e]),Math.abs(l-o[e]),Math.abs(k-l)])/m,u/m)>p))break;u/=16}}return o},va.tensor=function(a,b){for(var c,d,e=a.length,f=b.length,g=[],h=e-1;h>=0;){c=[],d=a[h];for(var i=f-1;i>=3;)c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i;for(;i>=0;)c[i]=d*b[i],--i;g[h]=c,--h}return g};var wa=function(a,b,c,d,e,f){this.solution=a,this.value=b,this.gradient=c,this.invHessian=d,this.iterations=e,this.message=f};g["verb.core.MinimizationResult"]=wa,wa.__name__="verb.core.MinimizationResult",wa.prototype={__class__:wa};var xa=function(){};g["verb.core.ISerializable"]=xa,xa.__name__="verb.core.ISerializable",xa.__isInterface__=!0,xa.prototype={__class__:xa};var ya=a.core.Deserializer=function(){};g["verb.core.Deserializer"]=ya,ya.__name__="verb.core.Deserializer",ya.deserialize=function(a){return new u(a).unserialize()};var za=a.core.Trig=function(){};g["verb.core.Trig"]=za,za.__name__="verb.core.Trig",za.isPointInPlane=function(a,b,c){return Math.abs(Aa.dot(Aa.sub(a,b.origin),b.normal))<c},za.distToSegment=function(a,b,c){var d=za.segmentClosestPoint(b,a,c,0,1);return Aa.dist(b,d.pt)},za.rayClosestPoint=function(a,b,c){var d=Aa.sub(a,b),e=Aa.dot(d,c);return Aa.add(b,Aa.mul(e,c))},za.distToRay=function(a,b,c){var d=za.rayClosestPoint(a,b,c),e=Aa.sub(d,a);return Aa.norm(e)},za.threePointsAreFlat=function(a,b,c,d){var e=Aa.sub(b,a),f=Aa.sub(c,a),g=Aa.cross(e,f);return Aa.dot(g,g)<d},za.segmentClosestPoint=function(a,b,c,d,e){var f=Aa.sub(c,b),g=Aa.norm(f);if(g<Q.EPSILON)return{u:d,pt:b};var h=b,i=Aa.mul(1/g,f),j=Aa.sub(a,h),k=Aa.dot(j,i);return k<0?{u:d,pt:b}:k>g?{u:e,pt:c}:{u:d+(e-d)*k/g,pt:Aa.add(h,Aa.mul(k,i))}};var Aa=a.core.Vec=function(){};g["verb.core.Vec"]=Aa,Aa.__name__="verb.core.Vec",Aa.angleBetween=function(a,b){return Math.acos(Aa.dot(a,b)/(Aa.norm(a)*Aa.norm(b)))},Aa.positiveAngleBetween=function(a,b,c){var d=Aa.cross(a,b),e=Aa.norm(a),f=Aa.norm(b),g=e*f,h=Aa.dot(a,b),i=Aa.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Aa.dot(c,d);return Math.abs(l)<Q.EPSILON?k:l>0?k:-k},Aa.signedAngleBetween=function(a,b,c){var d=Aa.cross(a,b),e=Aa.norm(a),f=Aa.norm(b),g=e*f,h=Aa.dot(a,b),i=Aa.norm(d)/g,j=h/g,k=Math.atan2(i,j);return Aa.dot(c,d)>0?k:2*Math.PI-k},Aa.angleBetweenNormalized2d=function(a,b){var c=a[0]*b[1]-a[1]*b[0];return Math.atan2(c,Aa.dot(a,b))},Aa.domain=function(a){return N.last(a)-N.first(a)},Aa.range=function(a){for(var b=[],c=0,d=0,e=a;d<e;){d++;b.push(c),c+=1}return b},Aa.span=function(a,b,c){if(null==c)return[];if(c<Q.EPSILON)return[];if(a>b&&c>0)return[];if(b>a&&c<0)return[];for(var d=[],e=a;e<=b;)d.push(e),e+=c;return d},Aa.neg=function(a){for(var b=new Array(a.length),c=0,d=a.length;c<d;){var e=c++;b[e]=-a[e]}return b},Aa.min=function(a){return k.fold(a,function(a,b){return Math.min(a,b)},1/0)},Aa.max=function(a){return k.fold(a,function(a,b){return Math.max(a,b)},-1/0)},Aa.all=function(a){return k.fold(a,function(a,b){return!!b&&a},!0)},Aa.finite=function(a){for(var b=new Array(a.length),c=0,d=a.length;c<d;){var e=c++;b[e]=isFinite(a[e])}return b},Aa.onRay=function(a,b,c){return Aa.add(a,Aa.mul(c,b))},Aa.lerp=function(a,b,c){return Aa.add(Aa.mul(a,b),Aa.mul(1-a,c))},Aa.normalized=function(a){return Aa.div(a,Aa.norm(a))},Aa.cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},Aa.dist=function(a,b){return Aa.norm(Aa.sub(a,b))},Aa.distSquared=function(a,b){return Aa.normSquared(Aa.sub(a,b))},Aa.sum=function(a){return k.fold(a,function(a,b){return b+a},0)},Aa.addAll=function(a){var b=d(a);if(!b.hasNext())return null;var c=b.next().length;return k.fold(a,function(a,b){return Aa.add(b,a)},Aa.rep(c,0))},Aa.addAllMutate=function(a){for(var b=a[0],c=1,d=a.length;c<d;){var e=c++;Aa.addMutate(b,a[e])}},Aa.addMulMutate=function(a,b,c){for(var d=0,e=a.length;d<e;){var f=d++;a[f]+=b*c[f]}},Aa.subMulMutate=function(a,b,c){for(var d=0,e=a.length;d<e;){var f=d++;a[f]-=b*c[f]}},Aa.addMutate=function(a,b){for(var c=0,d=a.length;c<d;){var e=c++;a[e]+=b[e]}},Aa.subMutate=function(a,b){for(var c=0,d=a.length;c<d;){var e=c++;a[e]-=b[e]}},Aa.mulMutate=function(a,b){for(var c=0,d=b.length;c<d;){b[c++]*=a}},Aa.norm=function(a){var b=Aa.normSquared(a);return 0!=b?Math.sqrt(b):b},Aa.normSquared=function(a){return k.fold(a,function(a,b){return b+a*a},0)},Aa.rep=function(a,b){for(var c=[],d=0,e=a;d<e;){d++;c.push(b)}return c},Aa.zeros1d=function(a){for(var b=[],c=0,d=a;c<d;){c++;b.push(0)}return b},Aa.zeros2d=function(a,b){for(var c=[],d=0,e=a;d<e;){d++;c.push(Aa.zeros1d(b))}return c},Aa.zeros3d=function(a,b,c){for(var d=[],e=0,f=a;e<f;){e++;d.push(Aa.zeros2d(b,c))}return d},Aa.dot=function(a,b){for(var c=0,d=0,e=a.length;d<e;){var f=d++;c+=a[f]*b[f]}return c},Aa.add=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]+b[f])}return c},Aa.mul=function(a,b){for(var c=[],d=0,e=b.length;d<e;){var f=d++;c.push(a*b[f])}return c},Aa.div=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]/b)}return c},Aa.sub=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]-b[f])}return c},Aa.isZero=function(a){for(var b=0,c=a.length;b<c;){var d=b++;if(Math.abs(a[d])>Q.TOLERANCE)return!1}return!0},Aa.sortedSetUnion=function(a,b){for(var c=[],d=0,e=0;d<a.length||e<b.length;)if(d>=a.length)c.push(b[e]),++e;else if(e>=b.length)c.push(a[d]),++d;else{var f=a[d]-b[e];Math.abs(f)<Q.EPSILON?(c.push(a[d]),++d,++e):f>0?(c.push(b[e]),++e):(c.push(a[d]),++d)}return c},Aa.sortedSetSub=function(a,b){for(var c=[],d=0,e=0;d<a.length;)e>=b.length?(c.push(a[d]),++d):Math.abs(a[d]-b[e])<Q.EPSILON?(++d,++e):(c.push(a[d]),++d);return c};var Ba=a.eval.Analyze=function(){};g["verb.eval.Analyze"]=Ba,Ba.__name__="verb.eval.Analyze",Ba.knotMultiplicities=function(a){for(var b=[new Ca(a[0],0)],c=b[0],d=0;d<a.length;){var e=a[d];++d,Math.abs(e-c.knot)>Q.EPSILON&&(c=new Ca(e,0),b.push(c)),c.inc()}return b},Ba.isRationalSurfaceClosed=function(a,b){null==b&&(b=!0);for(var c=b?a.controlPoints:ra.transpose(a.controlPoints),d=0,e=c[0].length;d<e;){var f=d++;if(!(Aa.dist(N.first(c)[f],N.last(c)[f])<Q.EPSILON))return!1}return!0},Ba.rationalSurfaceClosestPoint=function(a,b){var c=Ba.rationalSurfaceClosestParam(a,b);return Ga.rationalSurfacePoint(a,c[0],c[1])},Ba.rationalSurfaceClosestParam=function(a,b){for(var c,d,e,f=5,g=0,h=1e-4,i=5e-4,j=a.knotsU[0],k=N.last(a.knotsU),l=a.knotsV[0],m=N.last(a.knotsV),n=Ba.isRationalSurfaceClosed(a),o=Ba.isRationalSurfaceClosed(a,!1),p=Ka.rationalSurfaceAdaptive(a,new La),q=1/0,r=0,s=p.points.length;r<s;){var t=r++,u=p.points[t],v=Aa.normSquared(Aa.sub(b,u));v<q&&(q=v,e=p.uvs[t])}for(var w=function(b){return Ga.rationalSurfaceDerivatives(a,b[0],b[1],2)},x=function(a,b,c){var d=b[1][0],e=b[0][1],f=b[2][0],g=b[0][2],h=b[1][1],i=b[1][1],j=Aa.dot(d,c),k=Aa.dot(e,c),l=[-j,-k],m=Aa.dot(d,d)+Aa.dot(f,c),n=Aa.dot(d,e)+Aa.dot(h,c),o=Aa.dot(d,e)+Aa.dot(i,c),p=Aa.dot(e,e)+Aa.dot(g,c),q=[[m,n],[o,p]],r=ra.solve(q,l);return Aa.add(r,a)};g<f;){c=w(e),d=Aa.sub(c[0][0],b);var y=Aa.norm(d),z=Aa.dot(c[1][0],d),A=Aa.norm(c[1][0])*y,B=Aa.dot(c[0][1],d),C=Aa.norm(c[0][1])*y,D=z/A,E=B/C,F=y<h,G=D<i,H=E<i;if(F&&G&&H)return e;var I=x(e,c,d);I[0]<j?I=n?[k-(I[0]-j),I[1]]:[j+Q.EPSILON,I[1]]:I[0]>k&&(I=n?[j+(I[0]-k),I[1]]:[k-Q.EPSILON,I[1]]),I[1]<l?I=o?[I[0],m-(I[1]-l)]:[I[0],l+Q.EPSILON]:I[1]>m&&(I=o?[I[0],l+(I[0]-m)]:[I[0],m-Q.EPSILON]);if(Aa.norm(Aa.mul(I[0]-e[0],c[1][0]))+Aa.norm(Aa.mul(I[1]-e[1],c[0][1]))<h)return e;e=I,++g}return e},Ba.rationalCurveClosestPoint=function(a,b){return Ga.rationalCurvePoint(a,Ba.rationalCurveClosestParam(a,b))},Ba.rationalCurveClosestParam=function(a,b){for(var c=1/0,d=0,e=Ka.rationalCurveRegularSample(a,a.controlPoints.length*a.degree,!0),f=0,g=e.length-1;f<g;){var h=f++,i=e[h][0],j=e[h+1][0],k=e[h].slice(1),l=e[h+1].slice(1),m=za.segmentClosestPoint(b,k,l,i,j),n=Aa.norm(Aa.sub(b,m.pt));n<c&&(c=n,d=m.u)}for(var o,p,q=5,h=0,r=1e-4,s=5e-4,t=a.knots[0],u=N.last(a.knots),v=Aa.normSquared(Aa.sub(a.controlPoints[0],N.last(a.controlPoints)))<Q.EPSILON,w=d,x=function(b){return Ga.rationalCurveDerivatives(a,b,2)},y=function(a,b,c){return a-Aa.dot(b[1],c)/(Aa.dot(b[2],c)+Aa.dot(b[1],b[1]))};h<q;){o=x(w),p=Aa.sub(o[0],b);var z=Aa.norm(p),A=Aa.dot(o[1],p),B=Aa.norm(o[1])*z,C=A/B,D=z<r,E=Math.abs(C)<s;if(D&&E)return w;var F=y(w,o,p);F<t?F=v?u-(F-t):t:F>u&&(F=v?t+(F-u):u);if(Aa.norm(Aa.mul(F-w,o[1]))<r)return w;w=F,++h}return w},Ba.rationalCurveParamAtArcLength=function(a,b,c,d,e){if(null==c&&(c=.001),b<Q.EPSILON)return a.knots[0];for(var f=null!=d?d:Ja.decomposeCurveIntoBeziers(a),g=0,h=(f[g],-Q.EPSILON),i=null!=e?e:[];h<b&&g<f.length;){if(i[g]=g<i.length?i[g]:Ba.rationalBezierCurveArcLength(a),h+=i[g],b<h+Q.EPSILON)return Ba.rationalBezierCurveParamAtArcLength(a,b,c,i[g]);++g}return-1},Ba.rationalBezierCurveParamAtArcLength=function(a,b,c,d){if(b<0)return a.knots[0];var e=null!=d?d:Ba.rationalBezierCurveArcLength(a);if(b>e)return N.last(a.knots);for(var f=a.knots[0],g=0,h=N.last(a.knots),i=e,j=0,k=0,l=null!=c?c:2*Q.TOLERANCE;i-g>l;)j=(f+h)/2,k=Ba.rationalBezierCurveArcLength(a,j),k>b?(h=j,i=k):(f=j,g=k);return(f+h)/2},Ba.rationalCurveArcLength=function(a,b,c){null==c&&(c=16),null==b&&(b=N.last(a.knots));for(var d=Ja.decomposeCurveIntoBeziers(a),e=0,f=d[0],g=0;e<d.length&&f.knots[0]+Q.EPSILON<b;){var h=Math.min(N.last(f.knots),b);g+=Ba.rationalBezierCurveArcLength(f,h,c),f=d[++e]}return g},Ba.rationalBezierCurveArcLength=function(a,b,c){null==c&&(c=16);for(var d,e,f=null==b?N.last(a.knots):b,g=(f-a.knots[0])/2,h=0,i=a.degree+c,j=0,k=i;j<k;){var l=j++;d=g*Ba.Tvalues[i][l]+g+a.knots[0],e=Ga.rationalCurveDerivatives(a,d,1),h+=Ba.Cvalues[i][l]*Aa.norm(e[1])}return g*h};var Ca=a.eval.KnotMultiplicity=function(a,b){this.knot=a,this.mult=b};g["verb.eval.KnotMultiplicity"]=Ca,Ca.__name__="verb.eval.KnotMultiplicity",Ca.prototype={inc:function(){this.mult++},__class__:Ca};var Da=a.eval.Check=function(){};g["verb.eval.Check"]=Da,Da.__name__="verb.eval.Check",Da.isValidKnotVector=function(a,b){if(0==a.length)return!1;if(a.length<2*(b+1))return!1;for(var c=N.first(a),d=0,e=b+1;d<e;){var f=d++;if(Math.abs(a[f]-c)>Q.EPSILON)return!1}c=N.last(a);for(var d=a.length-b-1,e=a.length;d<e;){var f=d++;if(Math.abs(a[f]-c)>Q.EPSILON)return!1}return Da.isNonDecreasing(a)},Da.isNonDecreasing=function(a){for(var b=N.first(a),c=0,d=a.length;c<d;){var e=c++;if(a[e]<b-Q.EPSILON)return!1;b=a[e]}return!0},Da.isValidNurbsCurveData=function(a){if(null==a.controlPoints)throw r.thrown("Control points array cannot be null!");if(null==a.degree)throw r.thrown("Degree cannot be null!");if(a.degree<1)throw r.thrown("Degree must be greater than 1!");if(null==a.knots)throw r.thrown("Knots cannot be null!");if(a.knots.length!=a.controlPoints.length+a.degree+1)throw r.thrown("controlPoints.length + degree + 1 must equal knots.length!");if(!Da.isValidKnotVector(a.knots,a.degree))throw r.thrown("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a},Da.isValidNurbsSurfaceData=function(a){
if(null==a.controlPoints)throw r.thrown("Control points array cannot be null!");if(null==a.degreeU)throw r.thrown("DegreeU cannot be null!");if(null==a.degreeV)throw r.thrown("DegreeV cannot be null!");if(a.degreeU<1)throw r.thrown("DegreeU must be greater than 1!");if(a.degreeV<1)throw r.thrown("DegreeV must be greater than 1!");if(null==a.knotsU)throw r.thrown("KnotsU cannot be null!");if(null==a.knotsV)throw r.thrown("KnotsV cannot be null!");if(a.knotsU.length!=a.controlPoints.length+a.degreeU+1)throw r.thrown("controlPointsU.length + degreeU + 1 must equal knotsU.length!");if(a.knotsV.length!=a.controlPoints[0].length+a.degreeV+1)throw r.thrown("controlPointsV.length + degreeV + 1 must equal knotsV.length!");if(!Da.isValidKnotVector(a.knotsU,a.degreeU)||!Da.isValidKnotVector(a.knotsV,a.degreeV))throw r.thrown("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a};var Ea=a.eval.Divide=function(){};g["verb.eval.Divide"]=Ea,Ea.__name__="verb.eval.Divide",Ea.surfaceSplit=function(a,b,c){null==c&&(c=!1);var d,e,f;c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ra.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var g=[],h=0,i=e+1;h<i;){h++;g.push(b)}for(var j=g,k=[],l=[],m=Ga.knotSpan(e,b,d),n=null,g=0;g<f.length;){var o=f[g];++g,n=Ja.curveKnotRefine(new U(e,d,o),j),k.push(n.controlPoints.slice(0,m+1)),l.push(n.controlPoints.slice(m+1))}var p=n.knots.slice(0,m+e+2),q=n.knots.slice(m+1);return c?[new V(a.degreeU,e,a.knotsU.slice(),p,k),new V(a.degreeU,e,a.knotsU.slice(),q,l)]:(k=ra.transpose(k),l=ra.transpose(l),[new V(e,a.degreeV,p,a.knotsV.slice(),k),new V(e,a.degreeV,q,a.knotsV.slice(),l)])},Ea.curveSplit=function(a,b){for(var c=a.degree,d=(a.controlPoints,a.knots),e=[],f=0,g=c+1;f<g;){f++;e.push(b)}var h=e,i=Ja.curveKnotRefine(a,h),j=Ga.knotSpan(c,b,d),k=i.knots.slice(0,j+c+2),l=i.knots.slice(j+1),m=i.controlPoints.slice(0,j+1),n=i.controlPoints.slice(j+1);return[new U(c,k,m),new U(c,l,n)]},Ea.rationalCurveByEqualArcLength=function(a,b){var c=Ba.rationalCurveArcLength(a),d=c/b;return Ea.rationalCurveByArcLength(a,d)},Ea.rationalCurveByArcLength=function(a,b){for(var c=Ja.decomposeCurveIntoBeziers(a),d=new Array(c.length),e=0,f=c.length;e<f;){var g=e++;d[g]=Ba.rationalBezierCurveArcLength(c[g])}var h=d,i=Aa.sum(h),j=[new Fa(a.knots[0],0)];if(b>i)return j;for(var k,l=b,g=0,m=l,n=0,o=0;g<c.length;){for(n+=h[g];m<n+Q.EPSILON;)k=Ba.rationalBezierCurveParamAtArcLength(c[g],m-o,Q.TOLERANCE,h[g]),j.push(new Fa(k,m)),m+=l;o+=h[g],++g}return j};var Fa=a.eval.CurveLengthSample=function(a,b){this.u=a,this.len=b};g["verb.eval.CurveLengthSample"]=Fa,Fa.__name__="verb.eval.CurveLengthSample",Fa.prototype={__class__:Fa};var Ga=a.eval.Eval=function(){};g["verb.eval.Eval"]=Ga,Ga.__name__="verb.eval.Eval",Ga.rationalCurveTangent=function(a,b){return Ga.rationalCurveDerivatives(a,b,1)[1]},Ga.rationalSurfaceNormal=function(a,b,c){var d=Ga.rationalSurfaceDerivatives(a,b,c,1);return Aa.cross(d[1][0],d[0][1])},Ga.rationalSurfaceDerivatives=function(a,b,c,d){null==d&&(d=1);for(var e=Ga.surfaceDerivatives(a,b,c,d),f=Ga.rational2d(e),g=Ga.weight2d(e),h=[],i=f[0][0].length,j=0,k=d+1;j<k;){var l=j++;h.push([]);for(var m=0,n=d-l+1;m<n;){for(var o=m++,c=f[l][o],p=1,q=o+1;p<q;){var r=p++;Aa.subMulMutate(c,O.get(o,r)*g[0][r],h[l][o-r])}for(var s=1,t=l+1;s<t;){var u=s++;Aa.subMulMutate(c,O.get(l,u)*g[u][0],h[l-u][o]);for(var v=Aa.zeros1d(i),w=1,x=o+1;w<x;){var y=w++;Aa.addMulMutate(v,O.get(o,y)*g[u][y],h[l-u][o-y])}Aa.subMulMutate(c,O.get(l,u),v)}Aa.mulMutate(1/g[0][0],c),h[l].push(c)}}return h},Ga.rationalSurfacePoint=function(a,b,c){return Ga.dehomogenize(Ga.surfacePoint(a,b,c))},Ga.rationalCurveDerivatives=function(a,b,c){null==c&&(c=1);for(var d=Ga.curveDerivatives(a,b,c),e=Ga.rational1d(d),f=Ga.weight1d(d),g=0,h=0,i=[],j=0,k=c+1;j<k;){for(var g=j++,l=e[g],m=1,n=g+1;m<n;){var h=m++;Aa.subMulMutate(l,O.get(g,h)*f[h],i[g-h])}Aa.mulMutate(1/f[0],l),i.push(l)}return i},Ga.rationalCurvePoint=function(a,b){return Ga.dehomogenize(Ga.curvePoint(a,b))},Ga.surfaceDerivatives=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2;return Ga.surfaceDerivativesGivenNM(e,f,a,b,c,d)},Ga.surfaceDerivativesGivenNM=function(a,b,c,d,e,f){var g=c.degreeU,h=c.degreeV,i=c.controlPoints,j=c.knotsU,k=c.knotsV;if(!Ga.areValidRelations(g,i.length,j.length)||!Ga.areValidRelations(h,i[0].length,k.length))throw r.thrown("Invalid relations between control points, knot vector, and n");for(var l=i[0][0].length,m=f<g?f:g,n=f<h?f:h,o=Aa.zeros3d(f+1,f+1,l),p=Ga.knotSpanGivenN(a,g,d,j),q=Ga.knotSpanGivenN(b,h,e,k),s=Ga.derivativeBasisFunctionsGivenNI(p,d,g,a,j),t=Ga.derivativeBasisFunctionsGivenNI(q,e,h,b,k),u=Aa.zeros2d(h+1,l),v=0,w=0,x=m+1;w<x;){for(var y=w++,z=0,A=h+1;z<A;){var B=z++;u[B]=Aa.zeros1d(l);for(var C=0,D=g+1;C<D;){var E=C++;Aa.addMulMutate(u[B],s[y][E],i[p-g+E][q-h+B])}}var F=f-y;v=F<n?F:n;for(var G=0,H=v+1;G<H;){var I=G++;o[y][I]=Aa.zeros1d(l);for(var J=0,K=h+1;J<K;){var L=J++;Aa.addMulMutate(o[y][I],t[I][L],u[L])}}}return o},Ga.surfacePoint=function(a,b,c){var d=a.knotsU.length-a.degreeU-2,e=a.knotsV.length-a.degreeV-2;return Ga.surfacePointGivenNM(d,e,a,b,c)},Ga.surfacePointGivenNM=function(a,b,c,d,e){var f=c.degreeU,g=c.degreeV,h=c.controlPoints,i=c.knotsU,j=c.knotsV;if(!Ga.areValidRelations(f,h.length,i.length)||!Ga.areValidRelations(g,h[0].length,j.length))throw r.thrown("Invalid relations between control points, knot vector, and n");for(var k=h[0][0].length,l=Ga.knotSpanGivenN(a,f,d,i),m=Ga.knotSpanGivenN(b,g,e,j),n=Ga.basisFunctionsGivenKnotSpanIndex(l,d,f,i),o=Ga.basisFunctionsGivenKnotSpanIndex(m,e,g,j),p=l-f,q=m,s=Aa.zeros1d(k),t=Aa.zeros1d(k),u=0,v=g+1;u<v;){var w=u++;t=Aa.zeros1d(k),q=m-g+w;for(var x=0,y=f+1;x<y;){var z=x++;Aa.addMulMutate(t,n[z],h[p+z][q])}Aa.addMulMutate(s,o[w],t)}return s},Ga.curveRegularSamplePoints=function(a,b){for(var c=Ga.curveDerivatives(a,a.knots[0],a.degree),d=1/b,e=d*d,f=c[0],g=Aa.mul(d,c[1]),h=Aa.mul(.5*e,c[2]),i=Aa.mul(e*d*.5,c[3]),j=Aa.add(h,h),k=Aa.add(i,i),l=Aa.mul(.3333333333333333,i),m=[],n=0,o=b+1;n<o;){n++;m.push(Ga.dehomogenize(f)),Aa.addAllMutate([f,g,h,l]),Aa.addAllMutate([g,j,i]),Aa.addAllMutate([j,k]),Aa.addAllMutate([h,i])}return m},Ga.curveRegularSamplePoints2=function(a,b){for(var c=Ga.curveDerivatives(a,a.knots[0],a.degree),d=1/b,e=d*d,f=c[0],g=Aa.mul(d,c[1]),h=Aa.mul(.5*e,c[2]),i=Aa.mul(e*d*.5,c[3]),j=Aa.add(h,h),k=Aa.add(i,i),l=Aa.mul(.3333333333333333,i),m=[],n=0,o=b+1;n<o;){n++;m.push(Ga.dehomogenize(f)),Aa.addAllMutate([f,g,h,l]),Aa.addAllMutate([g,j,i]),Aa.addAllMutate([j,k]),Aa.addAllMutate([h,i])}return m},Ga.rationalSurfaceRegularSampleDerivatives=function(a,b,c,d){for(var e=Ga.surfaceRegularSampleDerivatives(a,b,c,d),f=[],g=b+1,h=c+1,i=d+1,j=0,k=g;j<k;){var l=j++,m=[];f.push(m);for(var n=0,o=h;n<o;){for(var p=n++,q=e[l][p],r=Ga.rational2d(q),s=Ga.weight2d(q),t=[],u=r[0][0].length,v=0,w=i;v<w;){var x=v++;t.push([]);for(var y=0,z=i-x;y<z;){for(var A=y++,B=r[x][A],C=1,D=A+1;C<D;){var E=C++;Aa.subMulMutate(B,O.get(A,E)*s[0][E],t[x][A-E])}for(var F=1,G=x+1;F<G;){var H=F++;Aa.subMulMutate(B,O.get(x,H)*s[H][0],t[x-H][A]);for(var I=Aa.zeros1d(u),J=1,K=A+1;J<K;){var L=J++;Aa.addMulMutate(I,O.get(A,L)*s[H][L],t[x-H][A-L])}Aa.subMulMutate(B,O.get(x,H),I)}Aa.mulMutate(1/s[0][0],B),t[x].push(B)}}m.push(t)}}return f},Ga.surfaceRegularSampleDerivatives=function(a,b,c,d){for(var e=a.degreeU,f=a.degreeV,g=a.controlPoints,h=a.knotsU,i=a.knotsV,j=g[0][0].length,k=(N.last(h),h[0],N.last(i),i[0],Ga.regularlySpacedDerivativeBasisFunctions(e,h,b)),l=k.item0,m=k.item1,n=Ga.regularlySpacedDerivativeBasisFunctions(f,i,c),o=n.item0,p=n.item1,q=[],r=b+1,s=c+1,t=0,u=r;t<u;){var v=t++,w=[];q.push(w);for(var x=0,y=s;x<y;){var z=x++;w.push(Ga.surfaceDerivativesGivenBasesKnotSpans(e,f,g,l[v],o[z],m[v],p[z],j,d))}}return q},Ga.rationalSurfaceRegularSamplePoints=function(a,b,c){return Ga.dehomogenize2d(Ga.surfaceRegularSamplePoints(a,b,c))},Ga.surfaceRegularSamplePoints=function(a,b,c){for(var d=a.degreeU,e=a.degreeV,f=a.controlPoints,g=a.knotsU,h=a.knotsV,i=f[0][0].length,j=(N.last(g),g[0],N.last(h),h[0],Ga.regularlySpacedBasisFunctions(d,g,b)),k=j.item0,l=j.item1,m=Ga.regularlySpacedBasisFunctions(e,h,c),n=m.item0,o=m.item1,p=[],q=b+1,r=c+1,s=0,t=q;s<t;){var u=s++,v=[];p.push(v);for(var w=0,x=r;w<x;){var y=w++;v.push(Ga.surfacePointGivenBasesKnotSpans(d,e,f,k[u],n[y],l[u],o[y],i))}}return p},Ga.regularlySpacedBasisFunctions=function(a,b,c){for(var d=b.length-a-2,e=(N.last(b)-b[0])/c,f=[],g=[],h=b[0],i=Ga.knotSpanGivenN(d,a,h,b),j=c+1,k=0,l=j;k<l;){for(k++;h>=b[i+1];)++i;g.push(i),f.push(Ga.basisFunctionsGivenKnotSpanIndex(i,h,a,b)),h+=e}return new Z(g,f)},Ga.regularlySpacedDerivativeBasisFunctions=function(a,b,c){for(var d=b.length-a-2,e=(N.last(b)-b[0])/c,f=[],g=[],h=b[0],i=Ga.knotSpanGivenN(d,a,h,b),j=c+1,k=0,l=j;k<l;){for(k++;h>=b[i+1];)++i;g.push(i),f.push(Ga.derivativeBasisFunctionsGivenNI(i,h,a,d,b)),h+=e}return new Z(g,f)},Ga.surfacePointGivenBasesKnotSpans=function(a,b,c,d,e,f,g,h){for(var i,j=Aa.zeros1d(h),k=d-a,l=e-b,m=0,n=b+1;m<n;){var o=m++;i=Aa.zeros1d(h);for(var p=0,q=a+1;p<q;){var r=p++;Aa.addMulMutate(i,f[r],c[k+r][l])}++l,Aa.addMulMutate(j,g[o],i)}return j},Ga.surfaceDerivativesGivenBasesKnotSpans=function(a,b,c,d,e,f,g,h,i){for(var h=c[0][0].length,j=i<a?i:a,k=i<b?i:b,l=Aa.zeros3d(j+1,k+1,h),m=Aa.zeros2d(b+1,h),n=0,o=0,p=j+1;o<p;){for(var q=o++,r=0,s=b+1;r<s;){var t=r++;m[t]=Aa.zeros1d(h);for(var u=0,v=a+1;u<v;){var w=u++;Aa.addMulMutate(m[t],f[q][w],c[d-a+w][e-b+t])}}var x=i-q;n=x<k?x:k;for(var y=0,z=n+1;y<z;){var A=y++;l[q][A]=Aa.zeros1d(h);for(var B=0,C=b+1;B<C;){var D=B++;Aa.addMulMutate(l[q][A],g[A][D],m[D])}}}return l},Ga.curveDerivatives=function(a,b,c){var d=a.knots.length-a.degree-2;return Ga.curveDerivativesGivenN(d,a,b,c)},Ga.curveDerivativesGivenN=function(a,b,c,d){var e=b.degree,f=b.controlPoints,g=b.knots;if(!Ga.areValidRelations(e,f.length,g.length))throw r.thrown("Invalid relations between control points, knot vector, and n");for(var h=f[0].length,i=d<e?d:e,j=Aa.zeros2d(d+1,h),k=Ga.knotSpanGivenN(a,e,c,g),l=Ga.derivativeBasisFunctionsGivenNI(k,c,e,i,g),m=0,n=0,o=0,p=i+1;o<p;)for(var m=o++,q=0,s=e+1;q<s;){var n=q++;Aa.addMulMutate(j[m],l[m][n],f[k-e+n])}return j},Ga.curvePoint=function(a,b){var c=a.knots.length-a.degree-2;return Ga.curvePointGivenN(c,a,b)},Ga.areValidRelations=function(a,b,c){return b+a+1-c==0},Ga.curvePointGivenN=function(a,b,c){var d=b.degree,e=b.controlPoints,f=b.knots;if(!Ga.areValidRelations(d,e.length,f.length))throw r.thrown("Invalid relations between control points, knot Array, and n");for(var g=Ga.knotSpanGivenN(a,d,c,f),h=Ga.basisFunctionsGivenKnotSpanIndex(g,c,d,f),i=Aa.zeros1d(e[0].length),j=0,k=d+1;j<k;){var l=j++;Aa.addMulMutate(i,h[l],e[g-d+l])}return i},Ga.volumePoint=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2,g=a.knotsW.length-a.degreeW-2;return Ga.volumePointGivenNML(a,e,f,g,b,c,d)},Ga.volumePointGivenNML=function(a,b,c,d,e,f,g){if(!Ga.areValidRelations(a.degreeU,a.controlPoints.length,a.knotsU.length)||!Ga.areValidRelations(a.degreeV,a.controlPoints[0].length,a.knotsV.length)||!Ga.areValidRelations(a.degreeW,a.controlPoints[0][0].length,a.knotsW.length))throw r.thrown("Invalid relations between control points and knot vector");for(var h=a.controlPoints,i=a.degreeU,j=a.degreeV,k=a.degreeW,l=a.knotsU,m=a.knotsV,n=a.knotsW,o=h[0][0][0].length,p=Ga.knotSpanGivenN(b,i,e,l),q=Ga.knotSpanGivenN(c,j,f,m),s=Ga.knotSpanGivenN(d,k,g,n),t=Ga.basisFunctionsGivenKnotSpanIndex(p,e,i,l),u=Ga.basisFunctionsGivenKnotSpanIndex(q,f,j,m),v=Ga.basisFunctionsGivenKnotSpanIndex(s,g,k,n),w=p-i,x=Aa.zeros1d(o),y=Aa.zeros1d(o),z=Aa.zeros1d(o),A=0,B=k+1;A<B;){var C=A++;z=Aa.zeros1d(o);for(var D=s-k+C,E=0,F=j+1;E<F;){var G=E++;y=Aa.zeros1d(o);for(var H=q-j+G,I=0,J=i+1;I<J;){var K=I++;Aa.addMulMutate(y,t[K],h[w+K][H][D])}Aa.addMulMutate(z,u[G],y)}Aa.addMulMutate(x,v[C],z)}return x},Ga.derivativeBasisFunctions=function(a,b,c){var d=Ga.knotSpan(b,a,c),e=c.length-1,f=e-b-1;return Ga.derivativeBasisFunctionsGivenNI(d,a,b,f,c)},Ga.derivativeBasisFunctionsGivenNI=function(a,b,c,d,e){var f=Aa.zeros2d(c+1,c+1),g=Aa.zeros1d(c+1),h=Aa.zeros1d(c+1),i=0,j=0;f[0][0]=1;for(var k=1,l=c+1;k<l;){var m=k++;g[m]=b-e[a+1-m],h[m]=e[a+m]-b,i=0;for(var n=0,o=m;n<o;){var p=n++;f[m][p]=h[p+1]+g[m-p],j=f[p][m-1]/f[m][p],f[p][m]=i+h[p+1]*j,i=g[m-p]*j}f[m][m]=i}for(var q=Aa.zeros2d(d+1,c+1),r=Aa.zeros2d(2,c+1),s=0,t=1,u=0,v=0,w=0,x=0,y=0,k=0,l=c+1;k<l;){var m=k++;q[0][m]=f[m][c]}for(var k=0,l=c+1;k<l;){var p=k++;s=0,t=1,r[0][0]=1;for(var n=1,o=d+1;n<o;){var z=n++;u=0,v=p-z,w=c-z,p>=z&&(r[t][0]=r[s][0]/f[w+1][v],u=r[t][0]*f[v][w]),x=v>=-1?1:-v,y=p-1<=w?z-1:c-p;for(var A=x,B=y+1;A<B;){var m=A++;r[t][m]=(r[s][m]-r[s][m-1])/f[w+1][v+m],u+=r[t][m]*f[v+m][w]}p<=w&&(r[t][z]=-r[s][z-1]/f[w+1][p],u+=r[t][z]*f[p][w]),q[z][p]=u;var j=s;s=t,t=j}}for(var C=c,k=1,l=d+1;k<l;){for(var z=k++,n=0,o=c+1;n<o;){var m=n++;q[z][m]*=C}C*=c-z}return q},Ga.basisFunctions=function(a,b,c){var d=Ga.knotSpan(b,a,c);return Ga.basisFunctionsGivenKnotSpanIndex(d,a,b,c)},Ga.basisFunctionsGivenKnotSpanIndex=function(a,b,c,d){var e=Aa.zeros1d(c+1),f=Aa.zeros1d(c+1),g=Aa.zeros1d(c+1),h=0,i=0;e[0]=1;for(var j=1,k=c+1;j<k;){var l=j++;f[l]=b-d[a+1-l],g[l]=d[a+l]-b,h=0;for(var m=0,n=l;m<n;){var o=m++;i=e[o]/(g[o+1]+f[l-o]),e[o]=h+g[o+1]*i,h=f[l-o]*i}e[l]=h}return e},Ga.knotSpan=function(a,b,c){return Ga.knotSpanGivenN(c.length-a-2,a,b,c)},Ga.knotSpanGivenN=function(a,b,c,d){if(c>d[a+1]-Q.EPSILON)return a;if(c<d[b]+Q.EPSILON)return b;for(var e=b,f=a+1,g=Math.floor((e+f)/2);c<d[g]||c>=d[g+1];)c<d[g]?f=g:e=g,g=Math.floor((e+f)/2);return g},Ga.dehomogenize=function(a){for(var b=a.length,c=[],d=a[b-1],e=a.length-1,f=0,g=e;f<g;){var h=f++;c.push(a[h]/d)}return c},Ga.rational1d=function(a){for(var b=a[0].length-1,c=new Array(a.length),d=0,e=a.length;d<e;){var f=d++;c[f]=a[f].slice(0,b)}return c},Ga.rational2d=function(a){for(var b=Ga.rational1d,c=new Array(a.length),d=0,e=a.length;d<e;){var f=d++;c[f]=b(a[f])}return c},Ga.weight1d=function(a){for(var b=a[0].length-1,c=new Array(a.length),d=0,e=a.length;d<e;){var f=d++;c[f]=a[f][b]}return c},Ga.weight2d=function(a){for(var b=Ga.weight1d,c=new Array(a.length),d=0,e=a.length;d<e;){var f=d++;c[f]=b(a[f])}return c},Ga.dehomogenize1d=function(a){for(var b=Ga.dehomogenize,c=new Array(a.length),d=0,e=a.length;d<e;){var f=d++;c[f]=b(a[f])}return c},Ga.dehomogenize2d=function(a){for(var b=Ga.dehomogenize1d,c=new Array(a.length),d=0,e=a.length;d<e;){var f=d++;c[f]=b(a[f])}return c},Ga.homogenize1d=function(a,b){for(var c=a.length,d=a[0].length,e=[],f=0,g=[],h=null!=b?b:Aa.rep(a.length,1),i=0,j=c;i<j;){var k=i++,l=[];g=a[k],f=h[k];for(var m=0,n=d;m<n;){var o=m++;l.push(g[o]*f)}l.push(f),e.push(l)}return e},Ga.homogenize2d=function(a,b){var c,d=a.length,e=[];if(null!=b)c=b;else{for(var f=[],g=0,h=d;g<h;){var i=g++;f.push(Aa.rep(a[0].length,1))}c=f}for(var f=0,g=d;f<g;){var i=f++;e.push(Ga.homogenize1d(a[i],c[i]))}return e};var Ha=a.eval.Intersect=function(){};g["verb.eval.Intersect"]=Ha,Ha.__name__="verb.eval.Intersect",Ha.surfaces=function(a,b,c){for(var d=Ka.rationalSurfaceAdaptive(a),e=Ka.rationalSurfaceAdaptive(b),f=Ha.meshes(d,e),g=new Array(f.length),h=0,i=f.length;h<i;){for(var j=h++,k=f[j],l=new Array(k.length),m=0,n=k.length;m<n;){var o=m++,p=k[o];l[o]=Ha.surfacesAtPointWithEstimate(a,b,p.uv0,p.uv1,c)}g[j]=l}for(var q=g,g=new Array(q.length),h=0,i=q.length;h<i;){for(var j=h++,r=q[j],l=new Array(r.length),m=0,n=r.length;m<n;){var o=m++;l[o]=r[o].point}g[j]=Ia.rationalInterpCurve(l,3)}return g},Ha.surfacesAtPointWithEstimate=function(a,b,c,d,e){for(var f,g,h,i,j,k,l,m,n,o,p,q,s,t=5,u=0;;){if(f=Ga.rationalSurfaceDerivatives(a,c[0],c[1],1),g=f[0][0],i=f[1][0],j=f[0][1],h=Aa.normalized(Aa.cross(i,j)),k=Aa.dot(h,g),l=Ga.rationalSurfaceDerivatives(b,d[0],d[1],1),m=l[0][0],o=l[1][0],p=l[0][1],n=Aa.normalized(Aa.cross(o,p)),q=Aa.dot(n,m),(s=Aa.distSquared(g,m))<e*e)break;var v=Aa.normalized(Aa.cross(h,n)),w=Aa.dot(v,g),x=Ha.threePlanes(h,k,n,q,v,w);if(null==x)throw r.thrown("panic!");var y=Aa.sub(x,g),z=Aa.sub(x,m),A=Aa.cross(i,h),B=Aa.cross(j,h),C=Aa.cross(o,n),D=Aa.cross(p,n),E=Aa.dot(B,y)/Aa.dot(B,i),F=Aa.dot(A,y)/Aa.dot(A,j),G=Aa.dot(D,z)/Aa.dot(D,o),H=Aa.dot(C,z)/Aa.dot(C,p);if(c=Aa.add([E,F],c),d=Aa.add([G,H],d),!(++u<t))break}return new da(c,d,g,s)},Ha.meshes=function(a,b,c,d){null==c&&(c=new oa(a)),null==d&&(d=new oa(b));for(var e=Ha.boundingBoxTrees(c,d,0),f=new Array(e.length),g=0,h=e.length;g<h;){var i=g++,j=e[i];f[i]=Ha.triangles(a,j.item0,b,j.item1)}for(var g=[],h=0,k=f;h<k.length;){var l=k[h];++h,null!=l&&g.push(l)}for(var h=[],k=0,m=g;k<m.length;){var l=m[k];++k,Aa.distSquared(l.min.point,l.max.point)>Q.EPSILON&&h.push(l)}var n=N.unique(h,function(a,b){var c=Aa.sub(a.min.uv0,b.min.uv0),d=Aa.dot(c,c),e=Aa.sub(a.max.uv0,b.max.uv0),f=Aa.dot(e,e),g=Aa.sub(a.min.uv0,b.max.uv0),h=Aa.dot(g,g),i=Aa.sub(a.max.uv0,b.min.uv0),j=Aa.dot(i,i);return d<Q.EPSILON&&f<Q.EPSILON||h<Q.EPSILON&&j<Q.EPSILON});return Ha.makeMeshIntersectionPolylines(n)},Ha.meshSlices=function(a,b,c,d){for(var e=new ua(a),f=e.boundingBox(),g=f.min[0],h=f.min[1],i=f.max[0],j=f.max[1],k=Aa.span(b,c,d),l=[],m=0;m<k.length;){var n=k[m];++m;var o=[[g,h,n],[i,h,n],[i,j,n],[g,j,n]],p=[[0,0],[1,0],[1,1],[0,1]],q=[[0,1,2],[0,2,3]],r=new W(q,o,null,p);l.push(Ha.meshes(a,r,e))}return l},Ha.makeMeshIntersectionPolylines=function(a){if(0==a.length)return[];for(var b=0;b<a.length;){var c=a[b];++b,c.max.opp=c.min,c.min.opp=c.max}for(var d=Ha.kdTreeFromSegments(a),e=[],b=0;b<a.length;){var f=a[b];++b,e.push(f.min),e.push(f.max)}for(var b=0;b<e.length;){var g=e[b];if(++b,null==g.adj){var h=Ha.lookupAdjacentSegment(g,d,a.length);null!=h&&null==h.adj&&(g.adj=h,h.adj=g)}}for(var b=[],i=0,j=e;i<j.length;){var k=j[i];++i,null==k.adj&&b.push(k)}var l=b;0==l.length&&(l=e);for(var m=[],n=0,o=!1;0!=l.length;){var p=l.pop();if(!p.visited){for(var q=[],r=p;null!=r&&!r.visited&&(r.visited=!0,r.opp.visited=!0,q.push(r),n+=2,(r=r.opp.adj)!=p););q.length>0&&(q.push(q[q.length-1].opp),m.push(q))}if(0==l.length&&e.length>0&&(o||n<e.length)){o=!0;var s=e.pop();l.push(s)}}return m},Ha.kdTreeFromSegments=function(a){for(var b=[],c=0;c<a.length;){var d=a[c];++c,b.push(new ka(d.min.point,d.min)),b.push(new ka(d.max.point,d.max))}return new ia(b,Aa.distSquared)},Ha.lookupAdjacentSegment=function(a,b,c){for(var d=[],e=0,f=b.nearest(a.point,c,Q.EPSILON);e<f.length;){var g=f[e];++e,a!=g.item0.obj&&d.push(g)}for(var h=d,i=new Array(h.length),d=0,e=h.length;d<e;){var j=d++;i[j]=h[j].item0.obj}var k=i;return 1==k.length?k[0]:null},Ha.curveAndSurface=function(a,b,c,d,e){null==c&&(c=.001),null==d&&(d=new na(a)),null==e&&(e=new qa(b));for(var f=Ha.boundingBoxTrees(d,e,c),g=new Array(f.length),h=0,i=f.length;h<i;){var j=h++,k=f[j],l=k.item0,m=k.item1,n=N.first(l.knots),o=N.last(l.knots),p=(n+o)/2,q=N.first(m.knotsU),r=N.last(m.knotsU),s=N.first(m.knotsV),t=N.last(m.knotsV),u=[(q+r)/2,(s+t)/2];g[j]=Ha.curveAndSurfaceWithEstimate(l,m,[p].concat(u),c)}for(var h=[],i=0,v=g;i<v.length;){var w=v[i];++i,Aa.distSquared(w.curvePoint,w.surfacePoint)<c*c&&h.push(w)}return N.unique(h,function(a,b){return Math.abs(a.u-b.u)<.5*c})},Ha.curveAndSurfaceWithEstimate=function(a,b,c,d){null==d&&(d=.001);var e=function(c){var d=Ga.rationalCurvePoint(a,c[0]),e=Ga.rationalSurfacePoint(b,c[1],c[2]),f=Aa.sub(d,e);return Aa.dot(f,f)},f=function(c){var d=Ga.rationalCurveDerivatives(a,c[0],1),e=Ga.rationalSurfaceDerivatives(b,c[1],c[2],1),f=Aa.sub(e[0][0],d[0]),g=Aa.mul(-1,d[1]),h=e[1][0],i=e[0][1];return[2*Aa.dot(g,f),2*Aa.dot(h,f),2*Aa.dot(i,f)]},g=va.uncmin(e,c,d*d,f),h=g.solution;return new aa(h[0],[h[1],h[2]],Ga.rationalCurvePoint(a,h[0]),Ga.rationalSurfacePoint(b,h[1],h[2]))},Ha.polylineAndMesh=function(a,b,c){for(var d=Ha.boundingBoxTrees(new pa(a),new oa(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ha.segmentWithTriangle(a.points[h],a.points[h+1],b.points,b.faces[i]);if(null!=j){var k=j.point,l=Aa.lerp(j.p,[a.params[h]],[a.params[h+1]])[0],m=ta.triangleUVFromPoint(b,i,k);e.push(new ca(k,l,m,h,i))}}return e},Ha.boundingBoxTrees=function(a,b,c){null==c&&(c=1e-9);var d=[],e=[];d.push(a),e.push(b);for(var f=[];d.length>0;){var g=d.pop(),h=e.pop();if(!g.empty()&&!h.empty()&&g.boundingBox().intersects(h.boundingBox(),c)){var a=g.indivisible(c),b=h.indivisible(c);if(a&&b)f.push(new Z(g.yield(),h.yield()));else if(!a||b)if(a||!b){var i=g.split(),j=h.split();d.push(i.item1),e.push(j.item1),d.push(i.item1),e.push(j.item0),d.push(i.item0),e.push(j.item1),d.push(i.item0),e.push(j.item0)}else{var k=g.split();d.push(k.item1),e.push(h),d.push(k.item0),e.push(h)}else{var l=h.split();d.push(g),e.push(l.item1),d.push(g),e.push(l.item0)}}}return f},Ha.curves=function(a,b,c){for(var d=Ha.boundingBoxTrees(new na(a),new na(b),0),e=new Array(d.length),f=0,g=d.length;f<g;){var h=f++,i=d[h];e[h]=Ha.curvesWithEstimate(a,b,N.first(i.item0.knots),N.first(i.item1.knots),c)}for(var f=[],g=0,j=e;g<j.length;){var k=j[g];++g,Aa.distSquared(k.point0,k.point1)<c&&f.push(k)}return N.unique(f,function(a,b){return Math.abs(a.u0-b.u0)<5*c})},Ha.curvesWithEstimate=function(a,b,c,d,e){var f=function(c){var d=Ga.rationalCurvePoint(a,c[0]),e=Ga.rationalCurvePoint(b,c[1]),f=Aa.sub(d,e);return Aa.dot(f,f)},g=function(c){var d=Ga.rationalCurveDerivatives(a,c[0],1),e=Ga.rationalCurveDerivatives(b,c[1],1),f=Aa.sub(d[0],e[0]),g=d[1],h=Aa.mul(-1,e[1]);return[2*Aa.dot(g,f),2*Aa.dot(h,f)]},h=va.uncmin(f,[c,d],e*e,g),d=h.solution[0],i=h.solution[1],j=Ga.rationalCurvePoint(a,d),k=Ga.rationalCurvePoint(b,i);return new _(j,k,d,i)},Ha.triangles=function(a,b,c,d){var e=a.faces[b],f=c.faces[d],g=ta.getTriangleNorm(a.points,e),h=ta.getTriangleNorm(c.points,f),i=a.points[e[0]],j=c.points[f[0]],k=Ha.planes(i,g,j,h);if(null==k)return null;var l=Ha.clipRayInCoplanarTriangle(k,a,b);if(null==l)return null;var m=Ha.clipRayInCoplanarTriangle(k,c,d);if(null==m)return null;var n=Ha.mergeTriangleClipIntervals(l,m,a,b,c,d);return null==n?null:new $(new ba(n.min.uv0,n.min.uv1,n.min.point,b,d),new ba(n.max.uv0,n.max.uv1,n.max.point,b,d))},Ha.clipRayInCoplanarTriangle=function(a,b,c){for(var d=b.faces[c],e=[b.points[d[0]],b.points[d[1]],b.points[d[2]]],f=[b.uvs[d[0]],b.uvs[d[1]],b.uvs[d[2]]],g=[Aa.sub(f[1],f[0]),Aa.sub(f[2],f[1]),Aa.sub(f[0],f[2])],h=[Aa.sub(e[1],e[0]),Aa.sub(e[2],e[1]),Aa.sub(e[0],e[2])],i=Aa.normalized,j=new Array(h.length),k=0,l=h.length;k<l;){var m=k++;j[m]=i(h[m])}for(var n=j,i=Aa.norm,j=new Array(h.length),k=0,l=h.length;k<l;){var m=k++;j[m]=i(h[m])}for(var o=j,p=null,q=null,k=0;k<3;){var m=k++,r=e[m],s=n[m],t=Ha.rays(r,s,a.origin,a.dir);if(null!=t){var u=t.u0,v=t.u1;u<-Q.EPSILON||u>o[m]+Q.EPSILON||((null==p||v<p.u)&&(p=new fa(v,Aa.onRay(a.origin,a.dir,v),Aa.onRay(f[m],g[m],u/o[m]))),(null==q||v>q.u)&&(q=new fa(v,Aa.onRay(a.origin,a.dir,v),Aa.onRay(f[m],g[m],u/o[m]))))}}return null==q||null==p?null:new $(p,q)},Ha.mergeTriangleClipIntervals=function(a,b,c,d,e,f){if(b.min.u>a.max.u+Q.EPSILON||a.min.u>b.max.u+Q.EPSILON)return null;var g=a.min.u>b.min.u?new Z(a.min,0):new Z(b.min,1),h=a.max.u<b.max.u?new Z(a.max,0):new Z(b.max,1),i=new $(new ba(null,null,g.item0.point,d,f),new ba(null,null,h.item0.point,d,f));return 0==g.item1?(i.min.uv0=g.item0.uv,i.min.uv1=ta.triangleUVFromPoint(e,f,g.item0.point)):(i.min.uv0=ta.triangleUVFromPoint(c,d,g.item0.point),i.min.uv1=g.item0.uv),0==h.item1?(i.max.uv0=h.item0.uv,i.max.uv1=ta.triangleUVFromPoint(e,f,h.item0.point)):(i.max.uv0=ta.triangleUVFromPoint(c,d,h.item0.point),i.max.uv1=h.item0.uv),i},Ha.planes=function(a,b,c,d){var e=Aa.cross(b,d);if(Aa.dot(e,e)<Q.EPSILON)return null;var f=0,g=Math.abs(e[0]),h=Math.abs(e[1]),i=Math.abs(e[2]);h>g&&(f=1,g=h),i>g&&(f=2,g=i);var j,k,l,m;0==f?(j=b[1],k=b[2],l=d[1],m=d[2]):1==f?(j=b[0],k=b[2],l=d[0],m=d[2]):(j=b[0],k=b[1],l=d[0],m=d[1]);var n,o=-Aa.dot(a,b),p=-Aa.dot(c,d),q=j*m-k*l,r=(k*p-o*m)/q,s=(o*l-j*p)/q;return n=0==f?[0,r,s]:1==f?[r,0,s]:[r,s,0],new T(n,Aa.normalized(e))},Ha.threePlanes=function(a,b,c,d,e,f){var g=Aa.cross(c,e),h=Aa.dot(a,g);if(Math.abs(h)<Q.EPSILON)return null;var i=Aa.sub(Aa.mul(f,c),Aa.mul(d,e)),j=Aa.add(Aa.mul(b,g),Aa.cross(a,i));return Aa.mul(1/h,j)},Ha.polylines=function(a,b,c){for(var d=Ha.boundingBoxTrees(new pa(a),new pa(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ha.segments(a.points[h],a.points[h+1],b.points[i],b.points[i+1],c);null!=j&&(j.u0=Aa.lerp(j.u0,[a.params[h]],[a.params[h+1]])[0],j.u1=Aa.lerp(j.u1,[b.params[i]],[b.params[i+1]])[0],e.push(j))}return e},Ha.segments=function(a,b,c,d,e){var f=Aa.sub(b,a),g=Math.sqrt(Aa.dot(f,f)),h=Aa.mul(1/g,f),i=Aa.sub(d,c),j=Math.sqrt(Aa.dot(i,i)),k=Aa.mul(1/j,i),l=Ha.rays(a,h,c,k);if(null!=l){var m=Math.min(Math.max(0,l.u0/g),1),n=Math.min(Math.max(0,l.u1/j),1),o=Aa.onRay(a,f,m),p=Aa.onRay(c,i,n);if(Aa.distSquared(o,p)<e*e)return new _(o,p,m,n)}return null},Ha.rays=function(a,b,c,d){var e=Aa.dot(b,d),f=Aa.dot(b,c),g=Aa.dot(b,a),h=Aa.dot(d,c),i=Aa.dot(d,a),j=Aa.dot(b,b),k=Aa.dot(d,d),l=j*k-e*e;if(Math.abs(l)<Q.EPSILON)return null;var m=e*(f-g)-j*(h-i),n=m/l,o=(f-g+n*e)/j,p=Aa.onRay(a,b,o),q=Aa.onRay(c,d,n);return new _(p,q,o,n)},Ha.segmentWithTriangle=function(a,b,c,d){var e=c[d[0]],f=c[d[1]],g=c[d[2]],h=Aa.sub(f,e),i=Aa.sub(g,e),j=Aa.cross(h,i),k=Aa.sub(b,a),l=Aa.sub(a,e),m=-Aa.dot(j,l),n=Aa.dot(j,k);if(Math.abs(n)<Q.EPSILON)return null;var o=m/n;if(o<0||o>1)return null;var p=Aa.add(a,Aa.mul(o,k)),q=Aa.dot(h,i),r=Aa.dot(h,h),s=Aa.dot(i,i),t=Aa.sub(p,e),u=Aa.dot(t,h),v=Aa.dot(t,i),w=q*q-r*s;if(Math.abs(w)<Q.EPSILON)return null;var x=(q*v-s*u)/w,y=(q*u-r*v)/w;return x>1+Q.EPSILON||y>1+Q.EPSILON||y<-Q.EPSILON||x<-Q.EPSILON||x+y>1+Q.EPSILON?null:new ea(p,x,y,o)},Ha.segmentAndPlane=function(a,b,c,d){var e=Aa.dot(d,Aa.sub(b,a));if(Math.abs(e)<Q.EPSILON)return null;var f=Aa.dot(d,Aa.sub(c,a)),g=f/e;return g>1+Q.EPSILON||g<-Q.EPSILON?null:{p:g}};var Ia=a.eval.Make=function(){};g["verb.eval.Make"]=Ia,Ia.__name__="verb.eval.Make",Ia.rationalTranslationalSurface=function(a,b){for(var c=Ga.rationalCurvePoint(b,N.first(b.knots)),d=N.first(b.knots),e=N.last(b.knots),f=2*b.controlPoints.length,g=(e-d)/(f-1),h=[],i=0,j=f;i<j;){var k=i++,l=Aa.sub(Ga.rationalCurvePoint(b,d+k*g),c),m=Ja.rationalCurveTransform(a,[[1,0,0,l[0]],[0,1,0,l[1]],[0,0,1,l[2]],[0,0,0,1]]);h.push(m)}return Ia.loftedSurface(h)},Ia.surfaceBoundaryCurves=function(a){return[Ia.surfaceIsocurve(a,N.first(a.knotsU),!1),Ia.surfaceIsocurve(a,N.last(a.knotsU),!1),Ia.surfaceIsocurve(a,N.first(a.knotsV),!0),Ia.surfaceIsocurve(a,N.last(a.knotsV),!0)]},Ia.surfaceIsocurve=function(a,b,c){null==c&&(c=!1);for(var d=c?a.knotsV:a.knotsU,e=c?a.degreeV:a.degreeU,f=Ba.knotMultiplicities(d),g=-1,h=0,i=f.length;h<i;){var j=h++;if(Math.abs(b-f[j].knot)<Q.EPSILON){g=j;break}}var k=e+1;g>=0&&(k-=f[g].mult);var l=k>0?Ja.surfaceKnotRefine(a,Aa.rep(k,b),c):a,m=Ga.knotSpan(e,b,d);if(Math.abs(b-N.first(d))<Q.EPSILON?m=0:Math.abs(b-N.last(d))<Q.EPSILON&&(m=(c?l.controlPoints[0].length:l.controlPoints.length)-1),c){for(var n=l.degreeU,o=l.knotsU,h=[],i=0,p=l.controlPoints;i<p.length;){var q=p[i];++i,h.push(q[m])}return new U(n,o,h)}return new U(l.degreeV,l.knotsV,l.controlPoints[m])},Ia.loftedSurface=function(a,b){a=Ja.unifyCurveKnotVectors(a);var c=a[0].degree;null==b&&(b=3),b>a.length-1&&(b=a.length-1);for(var d=a[0].knots,e=[],f=[],g=0,h=a[0].controlPoints.length;g<h;){for(var i=g++,j=new Array(a.length),k=0,l=a.length;k<l;){var m=k++;j[m]=a[m].controlPoints[i]}var n=j,o=Ia.rationalInterpCurve(n,b,!0);f.push(o.controlPoints),e=o.knots}return new V(c,b,d,e,f)},Ia.clonedCurve=function(a){for(var b=a.degree,c=a.knots.slice(),d=a.controlPoints,e=new Array(d.length),f=0,g=d.length;f<g;){var h=f++;e[h]=d[h].slice()}return new U(b,c,e)},Ia.rationalBezierCurve=function(a,b){for(var c=a.length-1,d=[],e=0,f=c+1;e<f;){e++;d.push(0)}for(var e=0,f=c+1;e<f;){e++;d.push(1)}return null==b&&(b=Aa.rep(a.length,1)),new U(c,d,Ga.homogenize1d(a,b))},Ia.fourPointSurface=function(a,b,c,d,e){null==e&&(e=3);for(var f=e,g=[],h=0,i=e+1;h<i;){for(var j=h++,k=[],l=0,m=e+1;l<m;){var n=l++,o=1-j/f,p=Aa.lerp(o,a,b),q=Aa.lerp(o,d,c),r=Aa.lerp(1-n/f,p,q);r.push(1),k.push(r)}g.push(k)}var s=Aa.rep(e+1,0),t=Aa.rep(e+1,1);return new V(e,e,s.concat(t),s.concat(t),g)},Ia.ellipseArc=function(a,b,c,d,e){var f=Aa.norm(b),g=Aa.norm(c);b=Aa.normalized(b),c=Aa.normalized(c),e<d&&(e=2*Math.PI+d);var h=e-d,i=0;i=h<=Math.PI/2?1:h<=Math.PI?2:h<=3*Math.PI/2?3:4;var j=h/i,k=Math.cos(j/2),l=Aa.add(a,Aa.add(Aa.mul(f*Math.cos(d),b),Aa.mul(g*Math.sin(d),c))),m=Aa.sub(Aa.mul(Math.cos(d),c),Aa.mul(Math.sin(d),b)),n=[],o=Aa.zeros1d(2*i+3),p=0,q=d,r=Aa.zeros1d(2*i);n[0]=l,r[0]=1;for(var s=1,t=i+1;s<t;){var u=s++;q+=j;var v=Aa.add(a,Aa.add(Aa.mul(f*Math.cos(q),b),Aa.mul(g*Math.sin(q),c)));r[p+2]=1,n[p+2]=v;var w=Aa.sub(Aa.mul(Math.cos(q),c),Aa.mul(Math.sin(q),b)),x=Ha.rays(l,Aa.mul(1/Aa.norm(m),m),v,Aa.mul(1/Aa.norm(w),w)),y=Aa.add(l,Aa.mul(x.u0,m));r[p+1]=k,n[p+1]=y,p+=2,u<i&&(l=v,m=w)}var z=2*i+1;switch(o[0]=0,o[z]=1,o[1]=0,o[1+z]=1,o[2]=0,o[2+z]=1,i){case 2:o[3]=o[4]=.5;break;case 3:o[3]=o[4]=.3333333333333333,o[5]=o[6]=.6666666666666666;break;case 4:o[3]=o[4]=.25,o[5]=o[6]=.5,o[7]=o[8]=.75}return new U(2,o,Ga.homogenize1d(n,r))},Ia.arc=function(a,b,c,d,e,f){return Ia.ellipseArc(a,Aa.mul(d,Aa.normalized(b)),Aa.mul(d,Aa.normalized(c)),e,f)},Ia.polyline=function(a){for(var b=[0,0],c=0,d=0,e=a.length-1;d<e;){var f=d++;c+=Aa.dist(a[f],a[f+1]),b.push(c)}b.push(c),b=Aa.mul(1/c,b);for(var d=[],e=0,g=a.length;e<g;){var f=e++;d.push(1)}var h=d;return new U(1,b,Ga.homogenize1d(a.slice(0),h))},Ia.extrudedSurface=function(a,b,c){for(var d=[[],[],[]],e=[[],[],[]],f=Ga.dehomogenize1d(c.controlPoints),g=Ga.weight1d(c.controlPoints),h=Aa.mul(b,a),i=Aa.mul(.5*b,a),j=0,k=f.length;j<k;){var l=j++;d[2][l]=f[l],d[1][l]=Aa.add(i,f[l]),d[0][l]=Aa.add(h,f[l]),e[0][l]=g[l],e[1][l]=g[l],e[2][l]=g[l]}return new V(2,c.degree,[0,0,0,1,1,1],c.knots,Ga.homogenize2d(d,e))},Ia.cylindricalSurface=function(a,b,c,d,e){var f=Aa.cross(a,b),g=(Math.PI,Ia.arc(c,b,f,e,0,2*Math.PI));return Ia.extrudedSurface(a,d,g)},Ia.revolvedSurface=function(a,b,c,d){var e,f,g,h,i=Ga.dehomogenize1d(a.controlPoints),j=Ga.weight1d(a.controlPoints);d<=Math.PI/2?(e=1,f=Aa.zeros1d(6+2*(e-1))):d<=Math.PI?(e=2,f=Aa.zeros1d(6+2*(e-1)),f[3]=f[4]=.5):d<=3*Math.PI/2?(e=3,f=Aa.zeros1d(6+2*(e-1)),f[3]=f[4]=.3333333333333333,f[5]=f[6]=.6666666666666666):(e=4,f=Aa.zeros1d(6+2*(e-1)),f[3]=f[4]=.25,f[5]=f[6]=.5,f[7]=f[8]=.75);var k=d/e,l=3+2*(e-1);f[0]=0,f[l]=1,f[1]=0,f[l+1]=1,f[2]=0,f[l+2]=1;for(var m=Math.cos(k/2),n=0,o=Aa.zeros1d(e+1),p=Aa.zeros1d(e+1),g=Aa.zeros3d(2*e+1,i.length,3),h=Aa.zeros2d(2*e+1,i.length),q=1,r=e+1;q<r;){var s=q++;n+=k,p[s]=Math.cos(n),o[s]=Math.sin(n)}for(var q=0,r=i.length;q<r;){var l=q++,t=za.rayClosestPoint(i[l],b,c),u=Aa.sub(i[l],t),v=Aa.norm(u),w=Aa.cross(c,u);v>Q.EPSILON&&(u=Aa.mul(1/v,u),w=Aa.mul(1/v,w)),g[0][l]=i[l];var x=i[l];h[0][l]=j[l];for(var y=w,z=0,n=0,A=1,B=e+1;A<B;){var s=A++,C=0==v?t:Aa.add(t,Aa.add(Aa.mul(v*p[s],u),Aa.mul(v*o[s],w)));g[z+2][l]=C,h[z+2][l]=j[l];var D=Aa.sub(Aa.mul(p[s],w),Aa.mul(o[s],u));if(0==v)g[z+1][l]=t;else{var E=Ha.rays(x,Aa.mul(1/Aa.norm(y),y),C,Aa.mul(1/Aa.norm(D),D)),F=Aa.add(x,Aa.mul(E.u0,y));g[z+1][l]=F}h[z+1][l]=m*j[l],z+=2,s<e&&(x=C,y=D)}}return new V(2,a.degree,f,a.knots,Ga.homogenize2d(g,h))},Ia.sphericalSurface=function(a,b,c,d){var e=Ia.arc(a,Aa.mul(-1,b),c,d,0,Math.PI);return Ia.revolvedSurface(e,a,b,2*Math.PI)},Ia.conicalSurface=function(a,b,c,d,e){var f=2*Math.PI,g=1,h=[Aa.add(c,Aa.mul(d,a)),Aa.add(c,Aa.mul(e,b))],i=[0,0,1,1],j=[1,1],k=new U(g,i,Ga.homogenize1d(h,j));return Ia.revolvedSurface(k,c,a,f)},Ia.rationalInterpCurve=function(a,b,c,d,e){if(null==c&&(c=!1),null==b&&(b=3),a.length<b+1)throw r.thrown("You need to supply at least degree + 1 points! You only supplied "+a.length+" points.");for(var f=[0],g=1,h=a.length;g<h;){var i=g++,j=Aa.norm(Aa.sub(a[i],a[i-1])),k=f[f.length-1];f.push(k+j)}
for(var l=f[f.length-1],g=0,h=f.length;g<h;){var i=g++;f[i]/=l}for(var m=Aa.rep(b+1,0),n=null!=d&&null!=e,o=n?0:1,p=n?f.length-b+1:f.length-b,g=o,h=p;g<h;){for(var i=g++,q=0,s=0,t=b;s<t;){var u=s++;q+=f[i+u]}m.push(1/b*q)}for(var v=m.concat(Aa.rep(b+1,1)),w=[],x=n?a.length+1:a.length-1,y=n?a.length-(b-1):a.length-(b+1),g=0;g<f.length;){var z=f[g];++g;var A=Ga.knotSpanGivenN(x,b,z,v),B=Ga.basisFunctionsGivenKnotSpanIndex(A,z,b,v),C=A-b,D=Aa.zeros1d(C),E=Aa.zeros1d(y-C);w.push(D.concat(B).concat(E))}if(n){var F=w[0].length-2,G=[-1,1].concat(Aa.zeros1d(F)),H=Aa.zeros1d(F).concat([-1,1]);N.spliceAndInsert(w,1,0,G),N.spliceAndInsert(w,w.length-1,0,H)}for(var I=a[0].length,J=[],K=(1-v[v.length-b-2])/b,L=v[b+1]/b,g=0,h=I;g<h;){var M,i=g++;if(n){M=[a[0][i]],M.push(L*d[i]);for(var O=1,P=a.length-1;O<P;){var u=O++;M.push(a[u][i])}M.push(K*e[i]),M.push(N.last(a)[i])}else{for(var Q=new Array(a.length),s=0,t=a.length;s<t;){var R=s++;Q[R]=a[R][i]}M=Q}var S=ra.solve(w,M);J.push(S)}var T=ra.transpose(J);if(!c){var V=Aa.rep(T.length,1);T=Ga.homogenize1d(T,V)}return new U(b,v,T)};var Ja=a.eval.Modify=function(){};g["verb.eval.Modify"]=Ja,Ja.__name__="verb.eval.Modify",Ja.curveReverse=function(a){return new U(a.degree,Ja.knotsReverse(a.knots),N.reversed(a.controlPoints))},Ja.surfaceReverse=function(a,b){if(null==b&&(b=!1),b){for(var c=a.degreeU,d=a.degreeV,e=a.knotsU,f=Ja.knotsReverse(a.knotsV),g=[],h=0,i=a.controlPoints;h<i.length;){var j=i[h];++h,g.push(N.reversed(j))}return new V(c,d,e,f,g)}return new V(a.degreeU,a.degreeV,Ja.knotsReverse(a.knotsU),a.knotsV,N.reversed(a.controlPoints))},Ja.knotsReverse=function(a){for(var b=N.first(a),c=(N.last(a),[b]),d=a.length,e=1,f=d;e<f;){var g=e++;c.push(c[g-1]+(a[d-g]-a[d-g-1]))}return c},Ja.unifyCurveKnotVectors=function(a){for(var b=Ia.clonedCurve,c=new Array(a.length),d=0,e=a.length;d<e;){var f=d++;c[f]=b(a[f])}a=c;for(var g=k.fold(a,function(a,b){return Ja.imax(a.degree,b)},0),d=0,e=a.length;d<e;){var f=d++;a[f].degree<g&&(a[f]=Ja.curveElevateDegree(a[f],g))}for(var d=[],e=0;e<a.length;){var h=a[e];++e,d.push(new $(N.first(h.knots),N.last(h.knots)))}for(var i=d,d=0,e=a.length;d<e;){for(var f=d++,j=i[f].min,l=a[f].knots,c=new Array(l.length),m=0,n=l.length;m<n;){var o=m++;c[o]=l[o]-j}a[f].knots=c}for(var c=new Array(i.length),d=0,e=i.length;d<e;){var f=d++,p=i[f];c[f]=p.max-p.min}for(var q=c,r=k.fold(q,function(a,b){return Math.max(a,b)},0),d=0,e=a.length;d<e;){for(var f=d++,s=r/q[f],l=a[f].knots,c=new Array(l.length),m=0,n=l.length;m<n;){var o=m++;c[o]=l[o]*s}a[f].knots=c}for(var t=k.fold(a,function(a,b){return Aa.sortedSetUnion(a.knots,b)},[]),d=0,e=a.length;d<e;){var f=d++,u=Aa.sortedSetSub(t,a[f].knots);0==u.length&&(a[f]=a[f]),a[f]=Ja.curveKnotRefine(a[f],u)}return a},Ja.imin=function(a,b){return a<b?a:b},Ja.imax=function(a,b){return a>b?a:b},Ja.curveElevateDegree=function(a,b){if(b<=a.degree)return a;var c=a.knots.length-a.degree-2,d=a.degree,e=a.knots,f=a.controlPoints,g=b-a.degree,h=a.controlPoints[0].length,i=Aa.zeros2d(d+g+1,d+1),j=[],k=[],l=[],m=c+d+1,n=b,o=Math.floor(n/2),p=[],q=[];i[0][0]=1,i[n][d]=1;for(var r=1,s=o+1;r<s;)for(var t=r++,u=1/O.get(n,t),v=Ja.imin(d,t),w=Ja.imax(0,t-g),x=v+1;w<x;){var y=w++;i[t][y]=u*O.get(d,y)*O.get(g,t-y)}for(var r=o+1,s=n;r<s;)for(var t=r++,v=Ja.imin(d,t),w=Ja.imax(0,t-g),x=v+1;w<x;){var y=w++;i[t][y]=i[n-t][d-y]}var z=n+1,A=-1,B=d,C=d+1,D=1,E=e[0];p[0]=f[0];for(var r=0,s=n+1;r<s;){var t=r++;q[t]=E}for(var r=0,s=d+1;r<s;){var t=r++;j[t]=f[t]}for(;C<m;){for(var t=C;C<m&&e[C]==e[C+1];)++C;var F=C-t+1,G=e[C],H=A;A=d-F;var I=H>0?Math.floor((H+2)/2):1,J=A>0?Math.floor(n-(A+1)/2):n;if(A>0){for(var K=G-E,L=[],M=d;M>F;)L[M-F-1]=K/(e[B+M]-E),--M;for(var r=1,s=A+1;r<s;){for(var y=r++,N=A-y,P=F+y,Q=d;Q>=P;)j[Q]=Aa.add(Aa.mul(L[Q-P],j[Q]),Aa.mul(1-L[Q-P],j[Q-1])),--Q;l[N]=j[d]}}for(var w=I,x=n+1;w<x;){var R=w++;k[R]=Aa.zeros1d(h);for(var v=Ja.imin(d,R),S=Ja.imax(0,R-g),T=v+1;S<T;){var V=S++;k[R]=Aa.add(k[R],Aa.mul(i[R][V],j[V]))}}if(H>1)for(var W=z-2,X=z,Y=G-E,Z=(G-q[z-1])/Y,$=1,_=H;$<_;){for(var aa=$++,ba=W,ca=X,da=ca-z+1;ca-ba>aa;){if(ba<D){var ea=(G-q[ba])/(E-q[ba]);p[ba]=Aa.lerp(ea,p[ba],p[ba-1])}if(ca>=I){if(ca-aa<=z-n+H){var fa=(G-q[ca-aa])/Y;k[da]=Aa.lerp(fa,k[da],k[da+1])}}else k[da]=Aa.lerp(Z,k[da],k[da+1]);++ba,--ca,--da}--W,++X}if(B!=d)for(var ga=0,ha=n-H;ga<ha;){ga++;q[z]=E,++z}for(var ia=I,ja=J+1;ia<ja;){var ka=ia++;p[D]=k[ka],++D}if(C<m){for(var la=0,ma=A;la<ma;){var na=la++;j[na]=l[na]}for(var oa=A,pa=d+1;oa<pa;){var qa=oa++;j[qa]=f[C-d+qa]}B=C,++C,E=G}else for(var ra=0,sa=n+1;ra<sa;){var ta=ra++;q[z+ta]=G}}return new U(b,q,p)},Ja.rationalSurfaceTransform=function(a,b){for(var c=Ga.dehomogenize2d(a.controlPoints),d=0,e=c.length;d<e;)for(var f=d++,g=0,h=c[f].length;g<h;){var i=g++,j=c[f][i];j.push(1),c[f][i]=ra.dot(b,j).slice(0,j.length-1)}return new V(a.degreeU,a.degreeV,a.knotsU.slice(),a.knotsV.slice(),Ga.homogenize2d(c,Ga.weight2d(a.controlPoints)))},Ja.rationalCurveTransform=function(a,b){for(var c=Ga.dehomogenize1d(a.controlPoints),d=0,e=c.length;d<e;){var f=d++,g=c[f];g.push(1),c[f]=ra.dot(b,g).slice(0,g.length-1)}return new U(a.degree,a.knots.slice(),Ga.homogenize1d(c,Ga.weight1d(a.controlPoints)))},Ja.surfaceKnotRefine=function(a,b,c){var d,e,f,g=[];c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ra.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var h=null,i=0;i<f.length;){var j=f[i];++i,h=Ja.curveKnotRefine(new U(e,d,j),b),g.push(h.controlPoints)}var k=h.knots;return c?new V(a.degreeU,a.degreeV,a.knotsU.slice(),k,g):(g=ra.transpose(g),new V(a.degreeU,a.degreeV,k,a.knotsV.slice(),g))},Ja.decomposeCurveIntoBeziers=function(a){for(var b=a.degree,c=a.controlPoints,d=a.knots,e=Ba.knotMultiplicities(d),f=b+1,g=0;g<e.length;){var h=e[g];if(++g,h.mult<f){var i=Aa.rep(f-h.mult,h.knot),j=Ja.curveKnotRefine(new U(b,d,c),i);d=j.knots,c=j.controlPoints}}for(var k=(d.length,2*f),l=[],m=0;m<c.length;){var n=d.slice(m,m+k),o=c.slice(m,m+f);l.push(new U(b,n,o)),m+=f}return l},Ja.curveKnotRefine=function(a,b){if(0==b.length)return Ia.clonedCurve(a);for(var c=a.degree,d=a.controlPoints,e=a.knots,f=d.length-1,g=f+c+1,h=b.length-1,i=Ga.knotSpan(c,b[0],e),j=Ga.knotSpan(c,b[h],e),k=[],l=[],m=0,n=i-c+1;m<n;){var o=m++;k[o]=d[o]}for(var m=j-1,n=f+1;m<n;){var o=m++;k[o+h+1]=d[o]}for(var m=0,n=i+1;m<n;){var o=m++;l[o]=e[o]}for(var m=j+c,n=g+1;m<n;){var o=m++;l[o+h+1]=e[o]}for(var o=j+c-1,p=j+c+h,q=h;q>=0;){for(;b[q]<=e[o]&&o>i;)k[p-c-1]=d[o-c-1],l[p]=e[o],--p,--o;k[p-c-1]=k[p-c];for(var m=1,n=c+1;m<n;){var r=m++,s=p-c+r,t=l[p+r]-b[q];Math.abs(t)<Q.EPSILON?k[s-1]=k[s]:(t/=l[p+r]-e[o-c+r],k[s-1]=Aa.add(Aa.mul(t,k[s-1]),Aa.mul(1-t,k[s])))}l[p]=b[q],--p,--q}return new U(c,l,k)},Ja.curveKnotInsert=function(a,b,c){for(var d=a.degree,e=a.controlPoints,f=a.knots,g=0,h=e.length,i=Ga.knotSpan(d,b,f),j=[],k=[],l=[],m=0,n=1,o=i+1;n<o;){var m=n++;k[m]=f[m]}for(var n=1,o=c+1;n<o;){var m=n++;k[i+m]=b}for(var n=i+1,o=f.length;n<o;){var m=n++;k[m+c]=f[m]}for(var n=0,o=i-d+1;n<o;){var m=n++;l[m]=e[m]}for(var n=i-g,o=h;n<o;){var m=n++;l[m+c]=e[m]}for(var n=0,o=d-g+1;n<o;){var m=n++;j[m]=e[i-d+m]}for(var p=0,q=0,n=1,o=c+1;n<o;){var r=n++;p=i-d+r;for(var s=0,t=d-r-g+1;s<t;){var m=s++;q=(b-f[p+m])/(f[m+i+1]-f[p+m]),j[m]=Aa.add(Aa.mul(q,j[m+1]),Aa.mul(1-q,j[m]))}l[p]=j[0],l[i+c-r-g]=j[d-r-g]}for(var n=p+1,o=i-g;n<o;){var m=n++;l[m]=j[m-p]}return new U(d,k,l)};var Ka=a.eval.Tess=function(){};g["verb.eval.Tess"]=Ka,Ka.__name__="verb.eval.Tess",Ka.rationalCurveRegularSample=function(a,b,c){return Ka.rationalCurveRegularSampleRange(a,a.knots[0],N.last(a.knots),b,c)},Ka.rationalCurveRegularSampleRange=function(a,b,c,d,e){d<1&&(d=2);for(var f=[],g=(c-b)/(d-1),h=0,i=0,j=d;i<j;){h=b+g*i++,e?f.push([h].concat(Ga.rationalCurvePoint(a,h))):f.push(Ga.rationalCurvePoint(a,h))}return f},Ka.rationalCurveAdaptiveSample=function(a,b,c){if(null==c&&(c=!1),null==b&&(b=1e-6),1==a.degree){if(c){for(var d=[],e=0,f=a.controlPoints.length;e<f;){var g=e++;d.push([a.knots[g+1]].concat(Ga.dehomogenize(a.controlPoints[g])))}return d}for(var h=a.controlPoints,i=Ga.dehomogenize,j=new Array(h.length),d=0,e=h.length;d<e;){var g=d++;j[g]=i(h[g])}return j}return Ka.rationalCurveAdaptiveSampleRange(a,a.knots[0],N.last(a.knots),b,c)},Ka.rationalCurveAdaptiveSampleRange=function(a,b,c,d,e){var f=Ga.rationalCurvePoint(a,b),g=Ga.rationalCurvePoint(a,c),h=.5+.2*Math.random(),i=b+(c-b)*h,j=Ga.rationalCurvePoint(a,i),k=Aa.sub(f,g),l=Aa.sub(f,j);if(Aa.dot(k,k)<d&&Aa.dot(l,l)>d||!za.threePointsAreFlat(f,j,g,d)){var m=b+.5*(c-b),n=Ka.rationalCurveAdaptiveSampleRange(a,b,m,d,e),o=Ka.rationalCurveAdaptiveSampleRange(a,m,c,d,e);return n.slice(0,-1).concat(o)}return e?[[b].concat(f),[c].concat(g)]:[f,g]},Ka.rationalSurfaceNaive=function(a,b,c){b<1&&(b=1),c<1&&(c=1);for(var d=(a.degreeU,a.degreeV,a.controlPoints,a.knotsU),e=a.knotsV,f=N.last(d)-d[0],g=N.last(e)-e[0],h=f/b,i=g/c,j=[],k=[],l=[],m=0,n=b+1;m<n;)for(var o=m++,p=0,q=c+1;p<q;){var r=p++,s=o*h,t=r*i;k.push([s,t]);var u=Ga.rationalSurfaceDerivatives(a,s,t,1),v=u[0][0];j.push(v);var w=Aa.normalized(Aa.cross(u[1][0],u[0][1]));l.push(w)}for(var x=[],m=0,n=b;m<n;)for(var o=m++,p=0,q=c;p<q;){var r=p++,y=o*(c+1)+r,z=(o+1)*(c+1)+r,A=z+1,B=y+1,C=[y,z,A],D=[y,A,B];x.push(C),x.push(D)}return new W(x,j,l,k)},Ka.divideRationalSurfaceAdaptive=function(a,b){null==b&&(b=new La),b.minDivsU=null!=b.minDivsU?b.minDivsU:1,b.minDivsU=null!=b.minDivsV?b.minDivsV:1,b.refine=null==b.refine||b.refine;for(var c=2*(a.controlPoints.length-1),d=2*(a.controlPoints[0].length-1),e=b.minDivsU=b.minDivsU>c?b.minDivsU:c,f=b.minDivsV=b.minDivsV>d?b.minDivsV:d,g=N.last(a.knotsU),h=a.knotsU[0],i=N.last(a.knotsV),j=a.knotsV[0],k=(g-h)/e,l=(i-j)/f,m=[],n=[],o=0,p=f+1;o<p;){for(var q=o++,r=[],s=0,t=e+1;s<t;){var u=s++,v=h+k*u,w=j+l*q,x=Ga.rationalSurfaceDerivatives(a,v,w,1),y=Aa.normalized(Aa.cross(x[0][1],x[1][0]));r.push(new ga(x[0][0],y,[v,w],-1,Aa.isZero(y)))}n.push(r)}for(var o=0,p=f;o<p;)for(var q=o++,s=0,t=e;s<t;){var u=s++,z=[n[f-q-1][u],n[f-q-1][u+1],n[f-q][u+1],n[f-q][u]];m.push(new Ma(a,z))}if(!b.refine)return m;for(var o=0,p=f;o<p;)for(var q=o++,s=0,t=e;s<t;){var u=s++,A=q*e+u,B=Ka.north(A,q,u,e,f,m),C=Ka.east(A,q,u,e,f,m),D=Ka.south(A,q,u,e,f,m),E=Ka.west(A,q,u,e,f,m);m[A].neighbors=[D,C,B,E],m[A].divide(b)}return m},Ka.north=function(a,b,c,d,e,f){return 0==b?null:f[a-d]},Ka.south=function(a,b,c,d,e,f){return b==e-1?null:f[a+d]},Ka.east=function(a,b,c,d,e,f){return c==d-1?null:f[a+1]},Ka.west=function(a,b,c,d,e,f){return 0==c?null:f[a-1]},Ka.triangulateAdaptiveRefinementNodeTree=function(a){for(var b=W.empty(),c=0;c<a.length;){var d=a[c];++c,d.triangulate(b)}return b},Ka.rationalSurfaceAdaptive=function(a,b){null==b&&(b=new La);var c=Ka.divideRationalSurfaceAdaptive(a,b);return Ka.triangulateAdaptiveRefinementNodeTree(c)};var La=a.core.AdaptiveRefinementOptions=function(){this.minDivsV=1,this.minDivsU=1,this.refine=!0,this.maxDepth=10,this.minDepth=0,this.normTol=.025};g["verb.eval.AdaptiveRefinementOptions"]=La,La.__name__="verb.eval.AdaptiveRefinementOptions",La.prototype={__class__:La};var Ma=a.core.AdaptiveRefinementNode=function(a,b,c){if(this.srf=a,this.neighbors=null==c?[null,null,null,null]:c,this.corners=b,null==this.corners){var d=a.knotsU[0],e=N.last(a.knotsU),f=a.knotsV[0],g=N.last(a.knotsV);this.corners=[ga.fromUv(d,f),ga.fromUv(e,f),ga.fromUv(e,g),ga.fromUv(d,g)]}};g["verb.eval.AdaptiveRefinementNode"]=Ma,Ma.__name__="verb.eval.AdaptiveRefinementNode",Ma.prototype={isLeaf:function(){return null==this.children},center:function(){return null!=this.centerPoint?this.centerPoint:this.evalSrf(this.u05,this.v05)},evalCorners:function(){if(this.u05=(this.corners[0].uv[0]+this.corners[2].uv[0])/2,this.v05=(this.corners[0].uv[1]+this.corners[2].uv[1])/2,null==this.corners[0].point){var a=this.corners[0];this.evalSrf(a.uv[0],a.uv[1],a)}if(null==this.corners[1].point){var a=this.corners[1];this.evalSrf(a.uv[0],a.uv[1],a)}if(null==this.corners[2].point){var a=this.corners[2];this.evalSrf(a.uv[0],a.uv[1],a)}if(null==this.corners[3].point){var a=this.corners[3];this.evalSrf(a.uv[0],a.uv[1],a)}},evalSrf:function(a,b,c){var d=Ga.rationalSurfaceDerivatives(this.srf,a,b,1),e=d[0][0],f=Aa.cross(d[0][1],d[1][0]),g=Aa.isZero(f);return g||(f=Aa.normalized(f)),null!=c?(c.degen=g,c.point=e,c.normal=f,c):new ga(e,f,[a,b],-1,g)},getEdgeCorners:function(a){if(this.isLeaf())return[this.corners[a]];if(this.horizontal)switch(a){case 0:return this.children[0].getEdgeCorners(0);case 1:return this.children[0].getEdgeCorners(1).concat(this.children[1].getEdgeCorners(1));case 2:return this.children[1].getEdgeCorners(2);case 3:return this.children[1].getEdgeCorners(3).concat(this.children[0].getEdgeCorners(3))}switch(a){case 0:return this.children[0].getEdgeCorners(0).concat(this.children[1].getEdgeCorners(0));case 1:return this.children[1].getEdgeCorners(1);case 2:return this.children[1].getEdgeCorners(2).concat(this.children[0].getEdgeCorners(2));case 3:return this.children[0].getEdgeCorners(3)}return null},getAllCorners:function(a){var b=[this.corners[a]];if(null==this.neighbors[a])return b;for(var c=this.neighbors[a].getEdgeCorners((a+2)%4),d=a%2,e=Q.EPSILON,f=this,g=[function(a){return a.uv[0]>f.corners[0].uv[0]+e&&a.uv[0]<f.corners[2].uv[0]-e},function(a){return a.uv[1]>f.corners[0].uv[1]+e&&a.uv[1]<f.corners[2].uv[1]-e}],h=g[d],i=[],j=0,k=c;j<k.length;){var l=k[j];++j,h(l)&&i.push(l)}var m=i;return m.reverse(),b.concat(m)},midpoint:function(a){if(null==this.midPoints&&(this.midPoints=[null,null,null,null]),null!=this.midPoints[a])return this.midPoints[a];switch(a){case 0:this.midPoints[0]=this.evalSrf(this.u05,this.corners[0].uv[1]);break;case 1:this.midPoints[1]=this.evalSrf(this.corners[1].uv[0],this.v05);break;case 2:this.midPoints[2]=this.evalSrf(this.u05,this.corners[2].uv[1]);break;case 3:this.midPoints[3]=this.evalSrf(this.corners[0].uv[0],this.v05)}return this.midPoints[a]},hasBadNormals:function(){return!!(this.corners[0].degen||this.corners[1].degen||this.corners[2].degen)||this.corners[3].degen},fixNormals:function(){for(var a=this.corners.length,b=0,c=a;b<c;){var d=b++;this.corners[d];if(this.corners[d].degen){var e=this.corners[(d+1)%a],f=this.corners[(d+3)%a];this.corners[d].normal=e.degen?f.normal:e.normal}}},shouldDivide:function(a,b){if(b<a.minDepth)return!0;if(b>=a.maxDepth)return!1;if(this.hasBadNormals())return this.fixNormals(),!1;if(this.splitVert=Aa.normSquared(Aa.sub(this.corners[0].normal,this.corners[1].normal))>a.normTol||Aa.normSquared(Aa.sub(this.corners[2].normal,this.corners[3].normal))>a.normTol,this.splitHoriz=Aa.normSquared(Aa.sub(this.corners[1].normal,this.corners[2].normal))>a.normTol||Aa.normSquared(Aa.sub(this.corners[3].normal,this.corners[0].normal))>a.normTol,this.splitVert||this.splitHoriz)return!0;var c=this.center();return Aa.normSquared(Aa.sub(c.normal,this.corners[0].normal))>a.normTol||Aa.normSquared(Aa.sub(c.normal,this.corners[1].normal))>a.normTol||Aa.normSquared(Aa.sub(c.normal,this.corners[2].normal))>a.normTol||Aa.normSquared(Aa.sub(c.normal,this.corners[3].normal))>a.normTol},divide:function(a){null==a&&(a=new La),null==a.normTol&&(a.normTol=.085),null==a.minDepth&&(a.minDepth=0),null==a.maxDepth&&(a.maxDepth=10),this._divide(a,0,!0)},_divide:function(a,b,c){if(this.evalCorners(),this.shouldDivide(a,b)){if(++b,this.splitVert&&!this.splitHoriz?c=!1:!this.splitVert&&this.splitHoriz&&(c=!0),this.horizontal=c,this.horizontal){var d=[this.corners[0],this.corners[1],this.midpoint(1),this.midpoint(3)],e=[this.midpoint(3),this.midpoint(1),this.corners[2],this.corners[3]];this.children=[new Ma(this.srf,d),new Ma(this.srf,e)],this.children[0].neighbors=[this.neighbors[0],this.neighbors[1],this.children[1],this.neighbors[3]],this.children[1].neighbors=[this.children[0],this.neighbors[1],this.neighbors[2],this.neighbors[3]]}else{var f=[this.corners[0],this.midpoint(0),this.midpoint(2),this.corners[3]],g=[this.midpoint(0),this.corners[1],this.corners[2],this.midpoint(2)];this.children=[new Ma(this.srf,f),new Ma(this.srf,g)],this.children[0].neighbors=[this.neighbors[0],this.children[1],this.neighbors[2],this.neighbors[3]],this.children[1].neighbors=[this.neighbors[0],this.neighbors[1],this.neighbors[2],this.children[0]]}for(var h=0,i=this.children;h<i.length;){var j=i[h];++h,j._divide(a,b,!c)}}},triangulate:function(a){if(null==a&&(a=W.empty()),this.isLeaf())return this.triangulateLeaf(a);for(var b=0,c=this.children;b<c.length;){var d=c[b];if(++b,null==d)break;d.triangulate(a)}return a},triangulateLeaf:function(a){var b=a.points.length,c=[],d=[],e=0,f=this.getAllCorners(0);2==f.length&&(e=1);for(var g=0,h=f.length;g<h;){var i=g++;c.push(f[i])}var f=this.getAllCorners(1);2==f.length&&(e=2);for(var g=0,h=f.length;g<h;){var i=g++;c.push(f[i])}var f=this.getAllCorners(2);2==f.length&&(e=3);for(var g=0,h=f.length;g<h;){var i=g++;c.push(f[i])}var f=this.getAllCorners(3);2==f.length&&(e=4);for(var g=0,h=f.length;g<h;){var i=g++;c.push(f[i])}for(var g=0;g<c.length;){var j=c[g];++g,-1==j.id?(a.uvs.push(j.uv),a.points.push(j.point),a.normals.push(j.normal),j.id=b,d.push(b),++b):d.push(j.id)}if(4==c.length)return a.faces.push([d[0],d[3],d[1]]),a.faces.push([d[3],d[2],d[1]]),a;if(5==c.length){var k=d.length;return a.faces.push([d[e],d[(e+2)%k],d[(e+1)%k]]),a.faces.push([d[(e+4)%k],d[(e+3)%k],d[e]]),a.faces.push([d[e],d[(e+3)%k],d[(e+2)%k]]),a}var l=this.center();a.uvs.push(l.uv),a.points.push(l.point),a.normals.push(l.normal);for(var m=a.points.length-1,n=0,i=c.length-1;n<c.length;)a.faces.push([m,d[n],d[i]]),++n,i=n-1;return a},__class__:Ma};var Na=a.exe.Dispatcher=function(){};g["verb.exe.Dispatcher"]=Na,Na.__name__="verb.exe.Dispatcher",Na.init=function(){Na._init||(Na._workerPool=new Oa(Na.THREADS),Na._init=!0)},Na.dispatchMethod=function(a,b,c){Na.init();var d=new G,e=function(a){d.resolve(a)};return Na._workerPool.addWork(a.__name__,b,c,e),new H(d)};var Oa=a.exe.WorkerPool=function(a,b){null==b&&(b="verb.js"),null==a&&(a=1),this._callbacks=new w,this._working=new w,this._pool=[],this._queue=[];for(var c=0,d=a;c<d;){var e;c++;try{e=new Worker(Oa.basePath+b)}catch(f){e=new Worker(Oa.basePath+b.substring(0,-3)+".min.js")}this._pool.push(e)}};g["verb.exe.WorkerPool"]=Oa,Oa.__name__="verb.exe.WorkerPool",Oa.prototype={addWork:function(a,b,c,d){var e=new Pa(a,b,c);this._callbacks.h[e.id]=d,this._queue.push(e),this.processQueue()},processQueue:function(){for(var a=this;this._queue.length>0&&this._pool.length>0;){var b=this._queue.shift(),c=[b.id],d=[this._pool.shift()];this._working.h[c[0]]=d[0],d[0].onmessage=function(b,c){return function(d){a._working.remove(c[0]),a._pool.push(b[0]);try{a._callbacks.h.hasOwnProperty(c[0])&&(a._callbacks.h[c[0]](d.data.result),a._callbacks.remove(c[0]))}catch(f){var e=r.caught(f).unwrap();console.log("src/verb/exe/WorkerPool.hx:82:",e)}a.processQueue()}}(d,c),d[0].postMessage(b)}},__class__:Oa};var Pa=function(a,b,c){this.className=a,this.methodName=b,this.args=c,this.id=Pa.uuid++};g["verb.exe._WorkerPool.Work"]=Pa,Pa.__name__="verb.exe._WorkerPool.Work",Pa.prototype={__class__:Pa};var Qa=function(){};g["verb.geom.ICurve"]=Qa,Qa.__name__="verb.geom.ICurve",Qa.__isInterface__=!0,Qa.__interfaces__=[xa],Qa.prototype={__class__:Qa};var Ra=a.geom.NurbsCurve=function(a){this._data=Da.isValidNurbsCurveData(a)};g["verb.geom.NurbsCurve"]=Ra,Ra.__name__="verb.geom.NurbsCurve",Ra.__interfaces__=[Qa],Ra.byKnotsControlPointsWeights=function(a,b,c,d){return new Ra(new U(a,b.slice(),Ga.homogenize1d(c,d)))},Ra.byPoints=function(a,b){return null==b&&(b=3),new Ra(Ia.rationalInterpCurve(a,b))},Ra.__super__=R,Ra.prototype=c(R.prototype,{degree:function(){return this._data.degree},knots:function(){return this._data.knots.slice(0)},controlPoints:function(){return Ga.dehomogenize1d(this._data.controlPoints)},weights:function(){return Ga.weight1d(this._data.controlPoints)},asNurbs:function(){return new U(this.degree(),this.knots(),Ga.homogenize1d(this.controlPoints(),this.weights()))},clone:function(){return new Ra(this._data)},domain:function(){return new $(N.first(this._data.knots),N.last(this._data.knots))},transform:function(a){return new Ra(Ja.rationalCurveTransform(this._data,a))},transformAsync:function(a){return Na.dispatchMethod(Ja,"rationalCurveTransform",[this._data,a]).then(function(a){return new Ra(a)})},point:function(a){return Ga.rationalCurvePoint(this._data,a)},pointAsync:function(a){return Na.dispatchMethod(Ga,"rationalCurvePoint",[this._data,a])},tangent:function(a){return Ga.rationalCurveTangent(this._data,a)},tangentAsync:function(a){return Na.dispatchMethod(Ga,"rationalCurveTangent",[this._data,a])},derivatives:function(a,b){return null==b&&(b=1),Ga.rationalCurveDerivatives(this._data,a,b)},derivativesAsync:function(a,b){return null==b&&(b=1),Na.dispatchMethod(Ga,"rationalCurveDerivatives",[this._data,a,b])},closestPoint:function(a){return Ba.rationalCurveClosestPoint(this._data,a)},closestPointAsync:function(a){return Na.dispatchMethod(Ba,"rationalCurveClosestPoint",[this._data,a])},closestParam:function(a){return Ba.rationalCurveClosestParam(this._data,a)},closestParamAsync:function(a){return Na.dispatchMethod(Ba,"rationalCurveClosestParam",[this._data,a])},length:function(){return Ba.rationalCurveArcLength(this._data)},lengthAsync:function(){return Na.dispatchMethod(Ba,"rationalCurveArcLength",[this._data])},lengthAtParam:function(a){return Ba.rationalCurveArcLength(this._data,a)},lengthAtParamAsync:function(){return Na.dispatchMethod(Ba,"rationalCurveArcLength",[this._data])},paramAtLength:function(a,b){return Ba.rationalCurveParamAtArcLength(this._data,a,b)},paramAtLengthAsync:function(a,b){return Na.dispatchMethod(Ba,"rationalCurveParamAtArcLength",[this._data,a,b])},divideByEqualArcLength:function(a){return Ea.rationalCurveByEqualArcLength(this._data,a)},divideByEqualArcLengthAsync:function(a){return Na.dispatchMethod(Ea,"rationalCurveByEqualArcLength",[this._data,a])},divideByArcLength:function(a){return Ea.rationalCurveByArcLength(this._data,a)},divideByArcLengthAsync:function(a){return Na.dispatchMethod(Ea,"rationalCurveByArcLength",[this._data,a])},split:function(a){for(var b=Ea.curveSplit(this._data,a),c=new Array(b.length),d=0,e=b.length;d<e;){var f=d++;c[f]=new Ra(b[f])}return c},splitAsync:function(a){return Na.dispatchMethod(Ea,"curveSplit",[this._data,a]).then(function(a){for(var b=new Array(a.length),c=0,d=a.length;c<d;){var e=c++;b[e]=new Ra(a[e])}return b})},reverse:function(){return new Ra(Ja.curveReverse(this._data))},reverseAsync:function(){return Na.dispatchMethod(Ja,"curveReverse",[this._data]).then(function(a){return new Ra(a)})},tessellate:function(a){return Ka.rationalCurveAdaptiveSample(this._data,a,!1)},tessellateAsync:function(a){return Na.dispatchMethod(Ka,"rationalCurveAdaptiveSample",[this._data,a,!1])},__class__:Ra});var Sa=a.geom.Arc=function(a,b,c,d,e,f){Ra.call(this,Ia.arc(a,b,c,d,e,f)),this._center=a,this._xaxis=b,this._yaxis=c,this._radius=d,this._minAngle=e,this._maxAngle=f};g["verb.geom.Arc"]=Sa,Sa.__name__="verb.geom.Arc",Sa.__super__=Ra,Sa.prototype=c(Ra.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},radius:function(){return this._radius},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:Sa});var Ta=a.geom.BezierCurve=function(a,b){Ra.call(this,Ia.rationalBezierCurve(a,b))};g["verb.geom.BezierCurve"]=Ta,Ta.__name__="verb.geom.BezierCurve",Ta.__super__=Ra,Ta.prototype=c(Ra.prototype,{__class__:Ta});var Ua=a.geom.Circle=function(a,b,c,d){Sa.call(this,a,b,c,d,0,2*Math.PI)};g["verb.geom.Circle"]=Ua,Ua.__name__="verb.geom.Circle",Ua.__super__=Sa,Ua.prototype=c(Sa.prototype,{__class__:Ua});var Va=function(){};g["verb.geom.ISurface"]=Va,Va.__name__="verb.geom.ISurface",Va.__isInterface__=!0,Va.__interfaces__=[xa],Va.prototype={__class__:Va};var Wa=a.geom.NurbsSurface=function(a){this._data=Da.isValidNurbsSurfaceData(a)};g["verb.geom.NurbsSurface"]=Wa,Wa.__name__="verb.geom.NurbsSurface",Wa.__interfaces__=[Va],Wa.byKnotsControlPointsWeights=function(a,b,c,d,e,f){return new Wa(new V(a,b,c,d,Ga.homogenize2d(e,f)))},Wa.byCorners=function(a,b,c,d){return new Wa(Ia.fourPointSurface(a,b,c,d))},Wa.byLoftingCurves=function(a,b){for(var c=[],d=0;d<a.length;){var e=a[d];++d,c.push(e.asNurbs())}return new Wa(Ia.loftedSurface(c,b))},Wa.__super__=R,Wa.prototype=c(R.prototype,{degreeU:function(){return this._data.degreeU},degreeV:function(){return this._data.degreeV},knotsU:function(){return this._data.knotsU.slice(0)},knotsV:function(){return this._data.knotsV.slice(0)},controlPoints:function(){return Ga.dehomogenize2d(this._data.controlPoints)},weights:function(){return Ga.weight2d(this._data.controlPoints)},asNurbs:function(){return new V(this.degreeU(),this.degreeV(),this.knotsU(),this.knotsV(),Ga.homogenize2d(this.controlPoints(),this.weights()))},clone:function(){return new Wa(this.asNurbs())},domainU:function(){return new $(N.first(this._data.knotsU),N.last(this._data.knotsU))},domainV:function(){return new $(N.first(this._data.knotsV),N.last(this._data.knotsV))},point:function(a,b){return Ga.rationalSurfacePoint(this._data,a,b)},pointAsync:function(a,b){return Na.dispatchMethod(Ga,"rationalSurfacePoint",[this._data,a,b])},normal:function(a,b){return Ga.rationalSurfaceNormal(this._data,a,b)},normalAsync:function(a,b){return Na.dispatchMethod(Ga,"rationalSurfaceNormal",[this._data,a,b])},derivatives:function(a,b,c){return null==c&&(c=1),Ga.rationalSurfaceDerivatives(this._data,a,b,c)},derivativesAsync:function(a,b,c){return null==c&&(c=1),Na.dispatchMethod(Ga,"rationalSurfaceDerivatives",[this._data,a,b,c])},closestParam:function(a){return Ba.rationalSurfaceClosestParam(this._data,a)},closestParamAsync:function(a){return Na.dispatchMethod(Ba,"rationalSurfaceClosestParam",[this._data,a])},closestPoint:function(a){return Ba.rationalSurfaceClosestPoint(this._data,a)},closestPointAsync:function(a){return Na.dispatchMethod(Ba,"rationalSurfaceClosestPoint",[this._data,a])},split:function(a,b){null==b&&(b=!1);for(var c=Ea.surfaceSplit(this._data,a,b),d=new Array(c.length),e=0,f=c.length;e<f;){var g=e++;d[g]=new Wa(c[g])}return d},splitAsync:function(a,b){return null==b&&(b=!1),Na.dispatchMethod(Ea,"surfaceSplit",[this._data,a,b]).then(function(a){return a.map(function(a){return new Wa(a)})})},reverse:function(a){return null==a&&(a=!1),new Wa(Ja.surfaceReverse(this._data,a))},reverseAsync:function(a){return null==a&&(a=!1),Na.dispatchMethod(Ja,"surfaceReverse",[this._data,a]).then(function(a){return new Wa(a)})},isocurve:function(a,b){return null==b&&(b=!1),new Ra(Ia.surfaceIsocurve(this._data,a,b))},isocurveAsync:function(a,b){return null==b&&(b=!1),Na.dispatchMethod(Ia,"surfaceIsocurve",[this._data,a,b]).then(function(a){return new Ra(a)})},boundaries:function(a){for(var b=Ia.surfaceBoundaryCurves(this._data),c=new Array(b.length),d=0,e=b.length;d<e;){var f=d++;c[f]=new Ra(b[f])}return c},boundariesAsync:function(a){return Na.dispatchMethod(Ia,"surfaceBoundaryCurves",[this._data]).then(function(a){for(var b=new Array(a.length),c=0,d=a.length;c<d;){var e=c++;b[e]=new Ra(a[e])}return b})},tessellate:function(a){return Ka.rationalSurfaceAdaptive(this._data,a)},tessellateAsync:function(a){return Na.dispatchMethod(Ka,"rationalSurfaceAdaptive",[this._data,a])},transform:function(a){return new Wa(Ja.rationalSurfaceTransform(this._data,a))},transformAsync:function(a){return Na.dispatchMethod(Ja,"rationalSurfaceTransform",[this._data,a]).then(function(a){return new Wa(a)})},__class__:Wa});var Xa=a.geom.ConicalSurface=function(a,b,c,d,e){Wa.call(this,Ia.conicalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.ConicalSurface"]=Xa,Xa.__name__="verb.geom.ConicalSurface",Xa.__super__=Wa,Xa.prototype=c(Wa.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:Xa});var Ya=a.geom.CylindricalSurface=function(a,b,c,d,e){Wa.call(this,Ia.cylindricalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.CylindricalSurface"]=Ya,Ya.__name__="verb.geom.CylindricalSurface",Ya.__super__=Wa,Ya.prototype=c(Wa.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:Ya});var Za=a.geom.EllipseArc=function(a,b,c,d,e){Ra.call(this,Ia.ellipseArc(a,b,c,d,e)),this._center=a,this._xaxis=b,this._yaxis=c,this._minAngle=d,this._maxAngle=e};g["verb.geom.EllipseArc"]=Za,Za.__name__="verb.geom.EllipseArc",Za.__super__=Ra,Za.prototype=c(Ra.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:Za});var $a=a.geom.Ellipse=function(a,b,c){Za.call(this,a,b,c,0,2*Math.PI)};g["verb.geom.Ellipse"]=$a,$a.__name__="verb.geom.Ellipse",$a.__super__=Za,$a.prototype=c(Za.prototype,{__class__:$a});var _a=a.geom.ExtrudedSurface=function(a,b){Wa.call(this,Ia.extrudedSurface(Aa.normalized(b),Aa.norm(b),a.asNurbs())),this._profile=a,this._direction=b};g["verb.geom.ExtrudedSurface"]=_a,_a.__name__="verb.geom.ExtrudedSurface",_a.__super__=Wa,_a.prototype=c(Wa.prototype,{profile:function(){return this._profile},direction:function(){return this._direction},__class__:_a});var ab=a.geom.Intersect=function(){};g["verb.geom.Intersect"]=ab,ab.__name__="verb.geom.Intersect",ab.curves=function(a,b,c){return null==c&&(c=.001),Ha.curves(a.asNurbs(),b.asNurbs(),c)},ab.curvesAsync=function(a,b,c){return null==c&&(c=.001),Na.dispatchMethod(Ha,"curves",[a.asNurbs(),b.asNurbs(),c])},ab.curveAndSurface=function(a,b,c){return null==c&&(c=.001),Ha.curveAndSurface(a.asNurbs(),b.asNurbs(),c)},ab.curveAndSurfaceAsync=function(a,b,c){return null==c&&(c=.001),Na.dispatchMethod(Ha,"curveAndSurface",[a.asNurbs(),b.asNurbs(),c])},ab.surfaces=function(a,b,c){null==c&&(c=.001);for(var d=Ha.surfaces(a.asNurbs(),b.asNurbs(),c),e=new Array(d.length),f=0,g=d.length;f<g;){var h=f++;e[h]=new Ra(d[h])}return e},ab.surfacesAsync=function(a,b,c){return null==c&&(c=.001),Na.dispatchMethod(Ha,"surfaces",[a.asNurbs(),b.asNurbs(),c]).then(function(a){return a.map(function(a){return new Ra(a)})})};var bb=a.geom.Line=function(a,b){Ra.call(this,Ia.polyline([a,b])),this._start=a,this._end=b};g["verb.geom.Line"]=bb,bb.__name__="verb.geom.Line",bb.__super__=Ra,bb.prototype=c(Ra.prototype,{start:function(){return this._start},end:function(){return this._end},__class__:bb});var cb=a.geom.RevolvedSurface=function(a,b,c,d){Wa.call(this,Ia.revolvedSurface(a.asNurbs(),b,c,d)),this._profile=a,this._center=b,this._axis=c,this._angle=d};g["verb.geom.RevolvedSurface"]=cb,cb.__name__="verb.geom.RevolvedSurface",cb.__super__=Wa,cb.prototype=c(Wa.prototype,{profile:function(){return this._profile},center:function(){return this._center},axis:function(){return this._center},angle:function(){return this._angle},__class__:cb});var db=a.geom.SphericalSurface=function(a,b){Wa.call(this,Ia.sphericalSurface(a,[0,0,1],[1,0,0],b)),this._center=a,this._radius=b};g["verb.geom.SphericalSurface"]=db,db.__name__="verb.geom.SphericalSurface",db.__super__=Wa,db.prototype=c(Wa.prototype,{center:function(){return this._center},radius:function(){return this._radius},__class__:db});var eb=a.geom.SweptSurface=function(a,b){Wa.call(this,Ia.rationalTranslationalSurface(a.asNurbs(),b.asNurbs())),this._profile=a,this._rail=b};g["verb.geom.SweptSurface"]=eb,eb.__name__="verb.geom.SweptSurface",eb.__super__=Wa,eb.prototype=c(Wa.prototype,{profile:function(){return this._profile},rail:function(){return this._rail},__class__:eb}),b.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(j.now=performance.now.bind(performance)),
g.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(a){return a<65536?String.fromCharCode(a):String.fromCharCode(55232+(a>>10))+String.fromCharCode(56320+(1023&a))}),String.prototype.__class__=g.String=String,String.__name__="String",g.Array=Array,Array.__name__="Array",Date.prototype.__class__=g.Date=Date,Date.__name__="Date";var fb={},gb={},hb=Number,ib=Boolean,jb={},kb={};z.count=0,E.__toStr={}.toString;s.USE_CACHE=!1,s.USE_ENUM_INDEX=!1,s.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",u.DEFAULT_RESOLVER=new t,u.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",K.queue=new x,O.memo=new w,a.TOLERANCE=Q.TOLERANCE=1e-6,a.EPSILON=Q.EPSILON=1e-10,a.VERSION=Q.VERSION="2.0.0",Ba.Tvalues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],Ba.Cvalues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],Na.THREADS=1,Na._init=!1,Oa.basePath="",Pa.uuid=0,M.main()}("undefined"!=typeof exports?exports:void 0!==e?e:"undefined"!=typeof self?self:this,void 0!==e?e:void 0!==b?b:"undefined"!=typeof self?self:this),a});